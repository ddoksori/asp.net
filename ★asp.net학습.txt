★★★★ visualstudio2019 싸이트 https://visualstudio.microsoft.com/ko/thank-you-downloading-visual-studio/?sku=Community&rel=16
(https://offbyone.tistory.com/66)


■ vs2010 sp1설치 및 시그널R 설치 싸이트(https://cooldragon.tistory.com/136)


■ [ASP.NET]SignalR 을 이용한 실시간 채팅 구현
[출처] [ASP.NET]SignalR 을 이용한 실시간 채팅 구현|작성자 골드러쉬

https://blog.naver.com/goldrushing/220716982023


------ 딜리버리에서 메뉴싸이즈 옵션 클릭할때 안먹는 에러 -----

        '20190824 포장 배달 가격이 없거나 0원이면 원래가격으로 표시해줌-----------
        If LblPojangPrice.Text = "" Or LblPojangPrice.Text = 0 Then
            LblPojangPrice.Text = LblAcnt.Text
        End If
        If LblBeadalPrice.Text = "" Or LblBeadalPrice.Text = 0 Then
            LblBeadalPrice.Text = LblAcnt.Text
        End If
        '-------------------------------------------------------------------------
		 위에서 0 을 "0" 으로 바꾸면
		 옵션리스트 안먹는 에러발생한다


■WebSoket https://niceman.tistory.com/109?category=1009825


■문자열에서 숫자만추출 (https://niceman.tistory.com/32)

///RegularExpressions 네임 스페이스 선언
using System.Text.RegularExpressions;

string targetStr = "7,873,330원(문자열 추출 테스트!)"; 
string tempStr = Regex.Replace(targetStr, @"\D", "");  ///Regex.Replace(targetStr, @"\d", ""); 가능


Regex.Replace(strFilterResult, @"\D", ""); -> 숫자만추출

Regex.Replace(strFilterResult, @"\d", ""); -> 문자만 추출이네요




///정수형 변환 (문자 --> 숫자)
int rstInt = int.Parse(tempStr); -> c#
Dim rstInt As Integer = Integer.Parse(tempStr) -> vb.net

■명령버튼 라인바꾸기 (https://stackoverflow.com/questions/5268354/wrap-text-within-a-aspbutton)
   <style type="text/css">
    .wrap { white-space: normal; width: 100px; }
   </style>
   <asp:Button ID="btn" runat="server" Text="some really breally long text that I want to wrap" CssClass="wrap" />

■http://jsfiddle.net/64fZa/5/ (유용한예제)

■DateTime 여러가지사용(https://asp-net-example.blogspot.com/2009/01/aspnet-date-time-example-how-to-get.html)
더 많은 C # 예제
DateTime에 시간을 추가하는 방법
DateTime에 월을 추가하는 방법
DateTime에 연도를 추가하는 방법
DateTime에 밀리 초를 추가하는 방법
두 DateTime 사이에 시간을 얻는 방법
DateTime 객체에서 AM PM 값을 얻는 방법
DateTime이 주어진 두 날짜 사이에 있는지 확인하는 방법
주어진 날짜를 사용하여 마지막 날을 얻는 방법
월 번호에서 월 이름을 얻는 방법
밀리 초 단위로 두 개의 DateTime 객체 차이를 얻는 방법

■C# DataTable Column 존재 유무 체크(http://www.oncode.co.kr/onbr/brd/board/?pgk=/tip/board/view/2/268)
   데이터 테이블 컬럼 존재 유무 체크
	DataTable Column 컬럼 존재 유무

	if (row.Table.Columns.Contains("brd_id"))
	{

	}

■[ASP.NET] URL 존재 여부 체크(https://m.blog.naver.com/PostView.nhn?blogId=wishkjh&logNo=80198693038&proxyReferer=https%3A%2F%2Fwww.google.com%2F)
   원격 페이지 또는 이미지 URL의 존재 여부를 체크할 때 사용하면 유용한 코드이다.

추가로 Response의 Status값을 받아서 상세한 처리가 가능하다.

 

 

코드



 try 

 { 

 Uri Url = new Uri("http://test.com/test.jpg");

 

           HttpWebRequest request = WebRequest.Create(Url) as HttpWebRequest;

           request.Timeout = 1000;

           request.Method = "HEAD";

           HttpWebResponse response = request.GetResponse() as HttpWebResponse;

           if (response.StatusCode == HttpStatusCode.OK) { }

 

 return true;

 }

 catch (Exception) 

 { 

 return false;

 }

 

 

주의사항

 

URL 경로를 URI로 변환하지 않으면 프로그램에서 경로 인식에 문제가 발생한다.

Timeout 속성을 주지 않으면, 서버 상황에 따라 예외 처리가 느려질 수 있다.

 
■홈페이지 오른쪽 마우스 무반응 http://bunseok.net/web/board_Dlgf22/9322
        내 홈페이지의 컨텐츠를 보호하고 싶을 때 필요한 기능이 바로 '우클릭금지' 입니다.

		최근 홈페이지 빌더나 블로그에서 우클릭 금지 기능을 제공하기도 하지만 기본적인 소스는 알아야겠죠?

		oncontextmenu="return false" : 오른쪽 마우스버튼 막기
		onseletstart="return false" : 왼쪽마우스버튼으로 드래그 막기
		ondragstart="return false" : 왼쪽마우스버튼으로 이미지드래그복사 막기
		onkeydown="return false" : 키보드 단축키 복사(ctrl+c) 막기

		우선 HTML 소스를 확인하면 <body> 태그가 있습니다. body 태그 안에 아래처럼 넣어주시면 됩니다.

		<body oncontextmenu="return false" onselectstart="return false" ondragstart="return false"onkeydown="return false">

		스크립트 소스로는 <head>와 </head> 사이에 아래처럼 넣어주세요.

		<script language="javascript">
		document.oncontextmenu = function(){return false;}

		//마우스 오른쪽 금지
		</script>

		간단하고 쉬운 수정으로 내 홈페이지를 보호하도록 합시다~!!

  * 헬로네이쳐 홈페이지 예제(https://www.hellonature.net/shop/goods/goods_plan_list.php?category=117&utm_source=kakaotalk&utm_medium=display_kakaotalkda_pc&utm_campaign=pc&utm_term=cheeseporkcutlet)  
    



■ 전화번호유효성검사 (https://devkimgoon.tistory.com/52)
하이픈 없이 입력 시
@"01{1}[016789]{1}[0-9]{7,8}"

하이픈 포함하여 입력 시
@"01{1}[016789]{1}-[0-9]{3,4}-[0-9]{4}"



■ C# DataGridView 스크롤 이동과 특정 컬럼 선택 (https://bigenergy.tistory.com/485)
    닷넷에서안됨
Private Sub SurroundingSub()
    Dim iColIdx As Integer = -1
    Dim iRowIdx As Integer = -1

    For i As Integer = 0 To datagridview1.Columns.Count - 1

        If datagridview1.Columns(i).Name = "찾아야할 컴럼명" Then
            iColIdx = i
            Exit For
        End If
    Next

    For i As Integer = 1 To datagridview1.Rows.Count - 1

        If datagridview1.Rows(i).Cells(0).Value.Equals("찾아야할 행의 셀값") Then
            iRowIdx = i
            Exit For
        End If
    Next

    If iColIdx >= 0 AndAlso iRowIdx >= 0 Then
        datagridview1.FirstDisplayedCell = datagridview1.Rows(iRowIdx).Cells(iColIdx)
        datagridview1.Rows(iRowIdx).Cells(iColIdx).Selected = True
    End If
End Sub


■ 띄어쓰기로 구분하여 추출
        Dim ThSp As String() = address1.Text.Split(New Char() {" "c})
        Dim LocalADD As String = ThSp(0) + " " + ThSp(1)  'ThSp(0) + " " + ThSp(1) + " " + ThSp(2) '도 + 시 + 동




■alret 사용법 
https://rgy0409.tistory.com/241



■QR코드 생성 https://m.blog.naver.com/jangstargosu/140149894767





■asp.net 실시간 접속자 수 알아내기(https://ssogarif.tistory.com/1938)
	<%@ Application Language="VB" %>

	<script runat="server">

		Sub Application_Start(ByVal sender As Object, ByVal e As EventArgs)
			' 응용 프로그램이 시작될 때 실행되는 코드입니다.
			Application("ActiveUsers") = 0
		End Sub
    
		Sub Application_End(ByVal sender As Object, ByVal e As EventArgs)
			' 응용 프로그램이 종료될 때 실행되는 코드입니다.
		End Sub
        
		Sub Application_Error(ByVal sender As Object, ByVal e As EventArgs)
			' 처리되지 않은 오류가 발생할 때 실행되는 코드입니다.
		End Sub

		Sub Session_Start(ByVal sender As Object, ByVal e As EventArgs)
			' 새 세션이 시작할 때 실행되는 코드입니다.
			Session.Timeout = 1
			Session("Start") = "Now"
			Application.Lock()
			Application("ActiveUsers") = System.Convert.ToInt32(Application("ActiveUsers")) + 1
			Application.UnLock()
		End Sub

		Sub Session_End(ByVal sender As Object, ByVal e As EventArgs)
			' 세션이 끝날 때 실행되는 코드입니다. 
			' 참고: Session_End 이벤트는 Web.config 파일에서 sessionstate 모드가
			' InProc로 설정되어 있는 경우에만 발생합니다. 세션 모드가 StateServer 또는 SQLServer로 
			' 설정되어 있는 경우에는 이 이벤트가 발생하지 않습니다.
			Application.Lock()
			Application("ActiveUsers") = System.Convert.ToInt32(Application("ActiveUsers")) - 1
			Application.UnLock()
		End Sub
       
	</script>

	lable1.Text = Application("ActiveUsers").ToString()

■접기/펼치기 소스
http://agami.egloos.com/1799087

1. 기본적인 열고 닫기(하나로 열고 닫기, 아래 닫기 버튼)
<a href='javascript:void(0)' onclick=this.nextSibling.style.display=(this.nextSibling.style.display=='none')?'block':'none';>열기</a><DIV style='display:none'>
감추었다가 나타나게 할 내용을 쓰세요
<A onclick=this.parentNode.style.display='none'; href=javascript:void(0)>닫기</A></DIV>

2. 약간 응용된 열고 닫기(열기/닫기 전환)
<a href='javascript:void(0)' onclick="this.innerHTML=(this.nextSibling.style.display=='none')?'닫기':'열기';this.nextSibling.style.display=(this.nextSibling.style.display=='none')?'block':'none'";>클릭하면 보여요</a><DIV style='display:none'>
감추었다가 나타나게 할 내용을 쓰세요
</DIV>

3. 조금 더 응용된 열고 닫기(열기/닫기 전환, 아래 닫기 버튼)
<A onclick="this.nextSibling.style.display='block';this.innerHTML=''"; href='javascript:void(0)'>열기</a><DIV style='display:none'>

1. 기본적인 열고 닫기(하나로 열고 닫기, 아래 닫기 버튼)
열기


2. 약간 응용된 열고 닫기(열기/닫기 전환)
열기

3. 조금 더 응용된 열고 닫기(열기/닫기 전환, 아래 닫기 버튼)
열기


 
출처 : http://psicopompus.tistory.com

■ 알림푸쉬 (https 에서만 작동함) 
<%--알림푸쉬
       <script language="javascript" type="text/javascript">
        var Notification = window.Notification || window.mozNotification || window.webkitNotification;
        Notification.requestPermission(function (permission) {
            // console.log(permission);
        });
        function show() {
            //여기서부터 알림https://developer.mozilla.org/ko/docs/Web/API/notification
            window.setTimeout(function () {
                var now = new Date();
                var instance = new Notification(
				now.getHours() + "시" + now.getMinutes() + "분", {
				    icon: "IMAGE/OrderCall.png",
				    body: '주문이 들어왔습니다.',
				    sound: 'Bell/Film.mp3'
				}
			);
                instance.onclick = function () {
                    // Something to do
                    //window.​open("http//acaboard.iptime.org:880/mft/OrderList.aspx", name, features, replace)
                };
                instance.onerror = function () {
                    // Something to do
                };
                instance.onshow = function () {
                    //                   PlaySound() 
                    // Something to do
                };
                instance.onclose = function () {
                    // Something to do
                };
            }, 1000);
        }
    </script>
--%>


■[간단 팁] MessageBox.Show 쓰기..
http://hoons.net/board/asptip/content/44485
아래처럼 하시면 MessageBox.Show를 쓸 수 있게 됩니다.
일단.. 프로젝트에 파일 하나 간단하게 생성해주시구요. (이름은 MessageBox.cs 정도가 적당하겟네요!)

(개인 라이브러리 소장하고 계신 분들은 요기에 추가해도 괜찮겠군요)

다음과 같이 클래스를 만들어줍니다. (물론, 네임스페이스 안에 넣어야겠죠..)

public static class MessageBox
{
    public static void Show(String message, Page page)
    {
        page.ClientScript.RegisterStartupScript(page.GetType(), "MessageBox", "alert(\"" + message + "\");", true);
    }
}

그리고.. MessageBox 보여주고 싶은 페이지에서....
MessageBox.Show("메세지박스 내용", this);
이러면... 메세지 박스가 나타나는 것을 볼 수 있답니다~

혹시 ASP.NET에서 이 코드가 문제되는 것이 있다면 조언 및 첨언 부탁드립니다. ㅎㅎ (아직 입문이라서요~)

■div 를 팝업레이어로 만들기

https://stackoverflow.com/questions/23004265/make-a-div-work-as-a-popup
<html>
<head>
<title>LIGHTBOX EXAMPLE</title>
<style>
.black_overlay{
    display: none;
    position: absolute;
    top: 0%;
    left: 0%;
    width: 100%;
    height: 100%;
    background-color: black;
    z-index:1001;
    -moz-opacity: 0.8;
    opacity:.80;
    filter: alpha(opacity=80);
}
.white_content {
    display: none;
    position: absolute;
    top: 25%;
    left: 25%;
    width: 50%;
    height: 50%;
    padding: 16px;
    border: 16px solid orange;
    background-color: white;
    z-index:1002;
    overflow: auto;
}
</style>
    <body>
       <p>This is the main content. To display a lightbox click <a href = "javascript:void(0)" onclick = "document.getElementById('light').style.display='block';document.getElementById('fade').style.display='block'">here</a></p>
        <div id="light" class="white_content">This is the lightbox content. <a href = "javascript:void(0)" onclick = "document.getElementById('light').style.display='none';document.getElementById('fade').style.display='none'">Close</a>암호입력 바랍니다. </div>
        <div id="fade" class="black_overlay"> </div>
    </body>
</head>

■ 제이쿼리 이용한 팝업창 (최고!!) popup

 https://www.aspsnippets.com/DownloadFile.aspx?File=15c6e069-a3ec-40e2-8164-805d765b9815.zip#center

  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script src="http://ajax.aspnetcdn.com/ajax/jquery.ui/1.8.9/jquery-ui.js" type="text/javascript"></script>
    <link href="http://ajax.aspnetcdn.com/ajax/jquery.ui/1.8.9/themes/start/jquery-ui.css"
        rel="stylesheet" type="text/css" />
   
   
    <script type="text/javascript">
        $("[id*=ImgBtnDeliverly]").live("click", function () {
            $("#dialog").dialog({
                title: "예약손님 테이블 번호",
                buttons: {
                    Close: function () {
                        $(this).dialog('close');
                    }
                }
            });
            return false;
        });
    </script>
    <div id="dialog" style="display: none">
        <asp:TextBox ID="TextBox1" runat="server"></asp:TextBox>
        This is a simple popup
    </div>
 <asp:Button ID="btnPopup" runat="server" Text="Show Popup" 
        onclick="btnPopup_Click" />-


■ 제이쿼리 이용한 팝업창 (더 최고!!) popup ★★★★★★★★★★★ 내가 만든 작품
   aspx 측
    <script type="text/javascript">
        function RSVTB() {
            $("#dialogTB").dialog({
                title: "예약손님 테이블 번호",
                buttons: {
                    Close: function () {
                        $(this).dialog('close');
                    }
                }
            });
            return false;
        };
    </script>
	
	<%--예약손님팝업--%> 
    <div id="dialogTB" style="display: none">
        예약손님의 테이블을 지정해 주세요!
        <asp:TextBox ID="TextBox1" runat="server" placeholder="테이블번호"></asp:TextBox>
    </div>

  .vb측
    ScriptManager.RegisterClientScriptBlock(Me.Page, Me.[GetType](), Nothing, "RSVTB()", True)


■순수 aps.net 으로 popup window 띄우기? 아니 같은창을 팝업으로띄우기 http://www.ittutorials.in/articles/open-popup-window-on-button-click-event
        <html>
		<head runat="server">
		<title>ASP.Net - Open popup window on button click</title>
		</head>
		<body>
		<form id="frmPopupExample" runat="server">
			<asp:Button ID="btnOpenPopupWindow" runat="server" Text="Open Popup Window" onclick="btnOpenPopupWindow_Click" />
		</form>
		</body>
		</html>

		Protected Sub btnOpenPopupWindow_Click(sender As Object, e As System.EventArgs) Handles btnOpenPopupWindow.Click

		Dim intId As Integer = 100

		' Passing intId to popup window.
		Dim strPopup As String = "<script language='javascript' ID='script1'>" + "window.open('popup.aspx?data=" + HttpUtility.UrlEncode(intId.ToString()) + "','new window', 'top=90, left=200, width=300, height=100, dependant=no, location=0, alwaysRaised=no, menubar=no, resizeable=no, scrollbars=n, toolbar=no, status=no, center=yes')" + "</script>"

		ScriptManager.RegisterStartupScript(DirectCast(HttpContext.Current.Handler, Page), GetType(Page), "Script1", strPopup, False)

		End Sub


■[HTML5] 'Visual Studio 10'에서 'HTML5' 사용하기.
https://blog.g1s.kr/2011/07/html5-visual-studio-10-html5.html


■캔버스(canvas) - 이미지저장 (asp.net 코드이용)
https://www.aspsnippets.com/Articles/Upload-Save-HTML5-Canvas-Image-to-Server-in-Folder-Disk-in-ASPNet.aspx

■캔버스(canvas)
  - 캔버스이미지 다운로드 https://riptutorial.com/ko/html5-canvas/example/31763/%EC%9D%B4%EB%AF%B8%EC%A7%80-%ED%8C%8C%EC%9D%BC%EC%97%90-%EC%BA%94%EB%B2%84%EC%8A%A4-%EC%A0%80%EC%9E%A5
  <a id="download" download="myImage.jpg" href="" onclick="download_img(this);">Download to myImage.jpg</a>

	<script>
		var canvas = document.getElementById("canvas");
		var ctx = canvas.getContext("2d");
		var ox = canvas.width / 2;
		var oy = canvas.height / 2;
		ctx.font = "42px serif";
		ctx.textAlign = "center";
		ctx.textBaseline = "middle";
		ctx.fillStyle = "#800";
		ctx.fillRect(ox / 2, oy / 2, ox, oy);

		download_img = function (el) {
			// get image URI from canvas object
			var imageURI = canvas.toDataURL("image/jpg");
			el.href = imageURI;
		};
	</script>  

  -모바일에서 캔버스사용(핸드폰에서 손가락으로 그림) https://m.blog.naver.com/loudon23/30095202299
   (공부방에 예제있음)    
  -캔버스 테두리 보이게
     <canvas id="canvas" width="300" height="300" style="border:solid 1px #000000; background-color:#ffffff;">이 브라우저에서는 HTML5 CANVAS를 지원하지 않습니다.</canvas>


■ 스와이퍼 http://idangero.us/swiper/demos/
   현재까지 가장모던한... https://jos39.tistory.com/247

■ 유용한 Css 모음
   https://webclub.tistory.com/364
   - footer 고정 
   #footer { position: fixed; left: 0px; bottom: 0px; height: 30px; width: 100%; background: #444; } /* IE 6 */ * html #footer { position: absolute; top: expression((0-(footer.offsetHeight)%2B(document.documentElement.clientHeight ? document.documentElement.clientHeight : document.body.clientHeight)%2B(ignoreMe = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop))%2B'px'); }

출처: https://webclub.tistory.com/364 [Web Club]


■ footer
   https://matthewjamestaylor.com/bottom-footer



■슬라이더 모음
   https://ryuseunghyun.tistory.com/2400
   https://cafe.naver.com/crossbrowsing/136
   https://tympanus.net/codrops/2012/04/30/fluid-css3-slideshow-with-parallax-effect/

   제스처 슬라이더
   https://minukang.github.io/2017/10/31/hammerjs/


■ 페이지 전체색 요기요
<meta name="theme-color" content="#DC1400">

https://stackoverflow.com/questions/26960703/how-to-change-the-color-of-header-bar-and-address-bar-in-newest-chrome-version-o


■ <div> 맨앞으로 가져오기 https://aboooks.tistory.com/83
    z-index 숫자가 높을수록 앞으로옴

■ 텍스트박스에 Type을 정해주면 입력박스에 포커스받을시 자동으로 입력박스까지 스크롤됨★


■[jQuery] 떠있는 레이어 만들기(http://www.happyjung.com/lecture/2118?sca=JavaScript&page=2)

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.2/jquery.min.js"></script>
<script type="text/javascript">
$(document).ready(function() {
    var currentPosition = parseInt( $(".float_layer").css("top"));
    $(window).scroll(function() {
        var position = $(window).scrollTop();
        $(".float_layer").stop().animate
            ({"top":position+currentPosition+"px"},1000);
    });
});
</script>

<style>
    .float_layer{position:absolute; top:0px; left:0px;}
</style>

<div class="float_layer">
    내용
</div>



참고자료
http://taisou.tistory.com/427 

■안드로이드 모바일폰에서 에서 카카오톡프로그램 실행
<a href="kakaolink://">카카오톡 실행</a>
 

■마우스올리거나 터치하면 간단 도움말박스 http://jsfiddle.net/shanidkv/LpjLuL81/1/

 <style type="text/css">

.wrap{
    margin-top: 100px;
}
.wrapper {
  text-transform: uppercase;
  cursor: help;
  position: relative;
  text-align: center;
}

.wrapper .tooltip {
  background: #1496bb;
  bottom: 100%;
  color: #fff;
  display: block;
  left: -25px;
  margin-bottom: 15px;
  opacity: 0;
  padding: 10px;
  pointer-events: none;
  position: absolute;
  width: 200px;
}

/* This bridges the gap so you can mouse into the tooltip without it disappearing */
.wrapper .tooltip:before {
  bottom: -20px;
  content: " ";
  display: block;
  height: 20px;
  left: 0;
  position: absolute;
  width: 100%;
}  

  
.wrapper:hover .tooltip {
  opacity: 1;
  pointer-events: auto;
  -webkit-transform: translateY(0px);
     -moz-transform: translateY(0px);
      -ms-transform: translateY(0px);
       -o-transform: translateY(0px);
          transform: translateY(0px);
}

</style>

<div class="wrap">Welcome <span class="wrapper">[?]<span class="tooltip">진짜 기가막히구만!!!</span>
  </span>
</div>





■이미지리싸이즈
https://m.blog.naver.com/PostView.nhn?blogId=airwindtree&logNo=70188790950&proxyReferer=https%3A%2F%2Fwww.google.com%2F


'이미지리싸이징(업로드후에 싸이즈줄임)---------------------------------------------
'이미지원본 썸네일 에 활용하면 굿
            FileUpload2.PostedFile.SaveAs(Path.Combine(savePath1, "간판.png")) '업로드 이미지명
            Dim img As Bitmap = New Bitmap(Path.Combine(savePath1, "간판.png")) '업로드된 이미지를 객체로 생성
            Dim width As Integer = 200
            Dim height As Integer = (width * img.Height) / img.Width
            Dim resizeImg As Bitmap = New Bitmap(width, height)
            Dim g As Graphics = Graphics.FromImage(resizeImg)
            g.InterpolationMode = InterpolationMode.HighQualityBicubic
            g.DrawImage(img, New Rectangle(0, 0, width, height))
            resizeImg.Save(Path.Combine(savePath1, "resize.png"))
            img.Dispose() <== 반드시 해줘야 메모리 누수막음 (서버에서 파일삭제 가능)

'이미지리싸이징(업로드전에 싸이즈줄임)---------------------------------------------
            서버 F드라이버에유용한예제에서 확인 씨샵으로 되어있음
			
			
			Dim fileName1 As String = FileUpload2.FileName

            Dim directory As String = savePath1
            Dim originalBMP As Bitmap = New Bitmap(FileUpload2.FileContent)
            Dim newWidth As Integer = 100
            Dim newHeight As Integer = 100
            Dim newBMP As Bitmap = New Bitmap(originalBMP, newWidth, newHeight)
            Dim oGraphics As Graphics = Graphics.FromImage(newBMP)
            oGraphics.SmoothingMode = SmoothingMode.AntiAlias
            oGraphics.InterpolationMode = InterpolationMode.HighQualityBicubic
            oGraphics.DrawImage(originalBMP, 0, 0, newWidth, newHeight)
            newBMP.Save(directory & "간판")
            originalBMP.Dispose()
            newBMP.Dispose()
            oGraphics.Dispose()




■텍스트 입력박스 받기

I'm assuming you use webforms.

The most simple thing is to make a webform with one input box (<asp:textbox runat="server" id="inputfield" />). Add a button with an onclick event (<asp:button runat="server" id="button" onclick="OnClick" />. In the onclick eventhandler you do something with the value.

protected void OnClick(object sender, EventArgs args){
  string input = inputfield.Text;
  // do something
}

■자바스크립트로 입력박스 컨폼박스..등등

https://mainia.tistory.com/1042

<head>

<script type="text/javascript">

<!--

   var retVal = confirm("Confirm 대화상자 ?");

   if( retVal == true ){

      alert("확인선택!");

   }else{

      alert("취소선택!");
	  여기서 백히스토리로 해주면 될듯
   }

//-->

</script>

</head>



출처: https://mainia.tistory.com/1042 [녹두장군 - 상상을 현실로]

■원격서버에 FTP를 이용한 파일 업로드
https://deuxist.tistory.com/520
asp.net FTP 파일 업로드

.ASPX
<asp:FileUpload id ="FileUpload1" runat ="server"   />

.CS
string filename = Path.GetFileName(FileUpload1.FileName);
FtpWebRequest rq = (FtpWebRequest)System.Net.FtpWebRequest.Create("ftp://xxx.com/" + filename);
rq.Credentials = new System.Net.NetworkCredential("아이디", "비밀번호");
rq.Method = System.Net.WebRequestMethods.Ftp.UploadFile;
System.IO.Stream fs = FileUpload1.PostedFile.InputStream;
byte[] buffer = new byte[fs.Length];
fs.Read(buffer, 0, buffer.Length);
fs.Close();
System.IO.Stream ftpstream = rq.GetRequestStream();
ftpstream.Write(buffer, 0, buffer.Length);
ftpstream.Close();    



■파일만들기
'Dim fInfo As FileInfo = New FileInfo("C:\M\abcd.txt")

        'If Not fInfo.Exists Then
        '    fInfo.Create()
        'End If


■ gridview 의 RowDataBound 와 DataBound 의 차이점
   RowDataBound  행추가시마다 이벤트 실행됨
   DataBound 행 다 추가되고 이벤트 실행됨

■ 내위치(현재위치 네비게이터) 표시
http://blog.naver.com/PostView.nhn?blogId=ttlbin10&logNo=220660180026


■ 기가막힌 JQUERY 모음 http://jqueryui.com/dialog/
   

■ 텍스트박스에 입력시 메시지표시하기
   
<script>
    function ShowHide(theDiv, how) {
        document.getElementById(theDiv).style.display = how;
    }
</script>
<div id="Message2" style="display:none">The Second Message Goes Here!</div>
<div id="Message1" style="display:none">The First Message Goes Here!</div>
<hr>
<form>
<input type="Text" name="blah" onfocus="ShowHide('Message1','block')" onblur="ShowHide('Message1','none')">
<input type="Text" name="blah" onfocus="ShowHide('Message2','block')" onblur="ShowHide('Message2','none')">
</form>

■ datalist 안에 컨트롤 제어하기
https://www.syncfusion.com/faq/1355/how-to-hide-and-show-data-in-the-datalist

■ DataList1 라벨값찾기
   Protected Sub DataList1_ItemCommand(source As Object, e As System.Web.UI.WebControls.DataListCommandEventArgs) Handles DataList1.ItemCommand
        Response.Write("<script language = 'javascript'>alert('" + DirectCast(e.Item.FindControl("LblMenu"), Label).Text + "')</script>")



■ 슬라이드 스와이퍼 예제
http://idangero.us/swiper/demos/

■ 배경은 움직이지 않고 뜨는 효과
    
	테이블 전체에 배경주고 테이블 안에 또다른 테이블 div 등을 넣어 이미지 넣으면됨
	 position: fixed; 로함
	 <table id="mainTB" runat="server" 
                                        style="background-image: url(''); background-repeat:no-repeat; background-position:center center; height: 85%; position: fixed;" 
                                        align="center" width="350">
	html {  height: 100%; background: linear-gradient(#536D90,#B9CEDF);}  여기서 height 150 주면 뜨는효과냄

■ Javascript 뒤로가기 방지, 새로고침 방지, 복사 방지
[출처] Javascript 뒤로가기 방지, 새로고침 방지, 복사 방지|작성자 니키아


 // 뒤로가기 방지

window.history.forward(1);



// 우클릭방지

oncontextmenu='return false' 



 // 드래그 방지

ondragstart='return false'



// 선택복사 방지

onselectstart='return false'



//새로고침, 뒤로가기 막기

document.onkeydown = function(e) {

 key = (e) ? e.keyCode : event.keyCode;

 if(key==8 || key==116) {

  if(e) {

   e.preventDefault();

  } else {

   event.keyCode = 0;

   event.returnValue = false;

  }

 }

}

//오른쪽마우스 막기

document.oncontextmenu = function(e){

 if(e){

  e.preventDefault();

 }

 else{

  event.keyCode = 0;

  event.returnValue = false;

 }

}
[출처] Javascript 뒤로가기 방지, 새로고침 방지, 복사 방지|작성자 니키아

■https://m.blog.naver.com/PostView.nhn?blogId=shin20301&logNo=90143766369&proxyReferer=https%3A%2F%2Fwww.google.co.kr%2F

* 방법1)
       - 폼로드에넣으면 해당폼 전체적용
	    '---- 뒤로가기버튼 방지 -------------
        'Response.Expires = 0
        'Response.Cache.SetNoStore()
        'Response.AppendHeader("Pragma", "no-cache")
        '------------------------------------------------


*방법2)		
 <% Response.AppendHeader("Cache-Control","no-cache") %> -->이방법은 잘안됨 확인해볼것

 *방법3)
 히스토리를 이용해서 막기
히스토리를 조작해서 뒤로가기를 막을 수 있다. 자바스크립트를 이용하는 것이니 만큼, 자바스크립트를 지원하지 않는 브라우저에서는 사용 할 수 없다. 뒤로가기를 눌러서 이전 페이지를 호출할 경우 "에러"가 출력되는 경우가 많을 건데, 유저 실수를 막아서 사이트의 흐름을 원할히하기 위한 목적이라고 보면 된다. 다른 방법도 마찬가지로 완전히 막을 수 있는 그런 방법은 없다.

 history.pushState(null, null, location.href);
    window.onpopstate = function () {
        history.go(1);
};



■ JQUERY(제이쿼리) 
    비하인드코드에서 제이쿼리스크립트 실행하기위해서 제이쿼리 함수이름넣음
	비하인드코드에서제이쿼리호출
	 <%--jQuery Ajax 이용하여 알림톡 전송--%>
    <script src="http://code.jquery.com/jquery-1.11.2.min.js"></script>
    <script src="http://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
 
    <script type="text/javascript" language="javascript">

      

            function ALIMTOK() {
                $.ajax({
                    type: "POST",
                    url: "http://221.139.14.189/API/alimtalk_api",
                    dataType: "text",
                    error: function () {
                        alert('통신실패!!');
                    },
                    success: function (data) {
                        alert("통신데이터 값 : " + data);
                        $("#dataArea").html(data);
                    }
                });
            }
     
    </script>





■ post get 방식전송 http://blog.danggun.net/1066

■   비하인드코드에서form방식으로전송
        '-------- 알림톡전송 ----------
            Dim collections As New NameValueCollection()
            collections.Add("api_key", "RJIL5V972GB0822")
            collections.Add("template_code", ViewState("K_Code"))
            If ViewState("K_Code") = "SJT_018224" Then '배달
                collections.Add("variable", TxtBoxPhoneNo.Text.Trim() & "|" & ORLST & "|" & Date.Now.ToString("yyyy-MM-dd")) 'TextBox3.Text.Trim()) '고객폰
            ElseIf ViewState("K_Code") = "SJT_018222" Then '포장
                collections.Add("variable", TxtBoxPhoneNo.Text.Trim() & "|" & ORLST & "|" & "오늘" & "|" & ViewState("VSTime")) 'TextBox3.Text.Trim()) '고객폰
            ElseIf ViewState("K_Code") = "SJT_018223" Then '예약
                collections.Add("variable", TxtBoxPhoneNo.Text.Trim() & "|" & ORLST & "|" & "오늘" & "|" & ViewState("VSTime")) 'TextBox3.Text.Trim()) '고객폰
            End If
            collections.Add("callback", "01052482870") '발신번호(회사폰)
            collections.Add("dstaddr", ViewState("strHP")) '수신번호(가게사장폰)
            collections.Add("next_type", "1") '0 - 알림톡 젂송 실패시 대치문 자 없음 1 - 알림톡 젂송 실패시 문자 메시지로 발송 
            collections.Add("send_reserve", "0") '0 - 즉시발송 1 - 예약발송

            Dim remoteUrl As String = "http://221.139.14.189/API/alimtalk_api"

            Dim html As String = "<html><head>"
            html += "</head><body onload='document.forms[0].submit()'>"
            html += String.Format("<form name='PostForm' method='POST' action='{0}'>", remoteUrl)
            For Each key As String In collections.Keys
                html += String.Format("<input name='{0}' type='text' value='{1}'>", key, collections(key))
            Next
            html += "</form></body></html>"
            Response.Clear()
            Response.ContentEncoding = Encoding.GetEncoding("utf-8")
            Response.HeaderEncoding = Encoding.GetEncoding("utf-8")
            Response.Charset = "utf-8"
            Response.Write(html)
            Response.End()
            '------------------------------
■   Jquery Ajax 로 전송
   <%--jQuery Ajax 이용하여 알림톡 전송--%>
    <script src="http://code.jquery.com/jquery-1.11.2.min.js"></script>
    <script src="http://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
 
    <script type="text/javascript" language="javascript">

        $(document).ready(function () {
            $.ajax({
                type: "POST",
                url: "http://221.139.14.189/API/alimtalk_api",
                data: { api_key: 'RJIL5V972GB0822', template_code: 'SJT_018306', variable:'변수1|변수2|변수3..|', callback: '01052482870',dstaddr:'01052482870', next_type:'1', send_reserve:'0' },
                dataType: "text",
                error: function () {
                    alert('통신실패!!');
                },
                success: function (data) {
                    alert("통신데이터 값 : " + data);
                    $("#dataArea").html(data);
                }
            });
        });
    </script>
    <%--jQuery Ajax 이용하여 알림톡 전송끝--%>

■ 변수이용하여보낼때(개고생)
   var allData = { api_key: 'RJIL5V972GB0822', template_code: '<%=varTmpCode%>', variable: '변수1|변수2|변수3..|', callback: '01052482870', dstaddr: '<%=SAJANG_Phone%>', next_type: '1', send_reserve: '0' };


■ placeholder 바꾸기
 LblPosi.Attributes.Add("placeholder", "드시고싶은메뉴 또는 음식점명")

■ placeholder 컬러 바꾸기
<style type="text/css"> 
    input::-webkit-input-placeholder { /* WebKit browsers */
        color:    #D8D8DA;
    }
    input:-moz-placeholder { /* Mozilla Firefox 4 to 18 */
        color:    #D8D8DA; 
    }
    input::-moz-placeholder { /* Mozilla Firefox 19+ */
        color:    #D8D8DA;
    }
    input:-ms-input-placeholder { /* Internet Explorer 10+ */
        color:    #D8D8DA;
    }
</style>

■ 체크박스를 이미지로
 <asp:CheckBox ID="ChkBoxPKG" runat="server" 
                   Text="<img src='./IMAGE/D_BtnPkg.png'/>" AutoPostBack="True" style="color: #003399" />
■ 크롬실행(로컬용)
Process.Start("chrome.exe", "http://linguist79.tistory.com")


■ alert 줄바꿈 \n ==> **(중요)카카오알림톡에 적용가능

■ WriteLine에서 줄바꿈
 Dim swLog3 As StreamWriter = New StreamWriter(Server.MapPath("CallBell\" + ViewState("getLTD") + "\" + "PosBell" + ".txt"), False, Encoding.Default) 'true 하면 연속해서씀
        swLog3.WriteLine("CALLBELLPC" & _
                         "{0} 구분:" & BUNRU & _
                         "{0} 테이블번호:" & TBNO & _
                         "{0}" & "주문내용: ", _
                         Environment.NewLine)
        swLog3.Close()
하면
{0} 에서 줄이바뀐다. 더응용해볼것

■ 스마트폰에서 알림소리 안날때 (서버도메인경로가아니어서) 나오게
    <body>
    <!--모바일접속-->
    <script type="text/javascript">
        var filter = "win16|win32|win64|mac";
        if (navigator.platform) {
            if (0 > filter.indexOf(navigator.platform.toLowerCase())) {
                location.href = "http://acaboard.iptime.org:8080/MFT/Default.aspx?GETKind=D";
                /*alert("Mobile");*/
            } else {
                
            }
        }
    </script>
    
    <iframe id="my_iframe" src="http://acaboard.iptime.org:8080/MFT/Default.aspx?GETKind=D"  
                style="height: 660px; width: 100%; border: 0" >
    </iframe> 
    
    </body> 

■ 모바일에서 사운드 재생 (모든브라우저에서 사용가능하지만 6회마다 페이지 다시읽어줘야됨)
   *** 반드시 프레임을 통하지 말고 할것 ***
   <script type="text/javascript">
          function PlaySound_pojang() {
              var audioCtx = new (window.AudioContext || window.webkitAudioContext)();
              var source = audioCtx.createBufferSource();
              var xhr = new XMLHttpRequest();
              xhr.open('GET', 'bell/pojangjumun.wav');
              xhr.responseType = 'arraybuffer';
              xhr.addEventListener('load', function (r) {
                  audioCtx.decodeAudioData(
                    xhr.response,
                    function (buffer) {
                        source.buffer = buffer;
                        source.connect(audioCtx.destination);
                        source.loop = false;
                    });
                  source.start(0);
              });
              xhr.send();
          };
      </script>


■ 모바일에서 사운드 연속 재생방법 (아주중요***** 크롬에서만 가능)
   * 포닷에서는 1번은 해당없음


   1.재생할 iframe 을 하나만들고 폼 로드시에 재생
    
	Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        If Not IsPostBack Then
            Call soundStart() '이렇게 해주면 모바일 사운드재생
	    End if
    End Sub

	Sub soundStart()
        IFRA.Attributes("src") = "../../wav/laser.wav"
    End Sub
   2. <iframe ID="IFRA"> 안의 내용
      <body>
			<!--<audio src="/workboard/getfile/워크보드/유재하_-_내_마음에_비친_내_모습.mp3" autoplay="autoplay">-->
			<!--<audio src="/STUDYROOM/wav/searcher.wav" autoplay="autoplay">-->
			<audio controls="" autoplay="autoplay"> 
			  <source src="laser.wav" type="audio/wav"/>
			  <source src="laser.mp3" type="audio/mp3"/>
			  <source src="laser.mp3" type="audio/ogg"/>
			지원하지않는 브라우져
			</audio>
				(9.0 이상)
	  </body>
 


■ 텍스트박스 자동완성 만들기 http://dotnetmentors.com/aspnet/jquery-autocomplete-by-example.aspx


■ JavaScript | 모바일 웹 주소창 숨기기 http://www.happyjung.com/lecture/1467?sca=JavaScript&page=2



■ 제이쿼리 스크롤시 화면이 페이드 되면서 나타나는 기능 알고싶어요 https://sir.kr/qa/74621
   <script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>

    <script type ="text/javascript">
    $(window).ready(function(){
    var max = 1000; //100% 투명할때의 스크롤 값
    $(window).scroll(function(){
        var scrollPX = $(this).scrollTop();
        if( scrollPX  < max ) {
            $("#bg").css({"opacity": (max-scrollPX)/max });
        }else{
            $("#bg").css({"opacity": 0});
        }  
      });
    });
    </script>

■ div table 등에 그라이언트 주기
.TitleBox {  background: linear-gradient(#032646,#536D90,#032646);  
               color: #FFFFFF; padding: 5px; border: 1px solid #FFFFFF; border-radius: 10px;
               }


■ JQUERY(제이쿼리) -----------------------------------------------------------------------------------
<!-- 제이쿼리모바일, 제이쿼리, 폰갭 라이브러리 파일(다운로드 방식)  
<link rel="stylesheet" href="jquery.mobile/jquery.mobile-1.4.5.min.css"/> 
<script src="jquery.mobile/jquery-1.11.1.min.js"></script> 
<script src="jquery.mobile/jquery.mobile-1.4.5.min.js"></script> -->

 <%--제이쿼리모바일, 제이쿼리, 폰갭 라이브러리 파일(CDN 방식)  
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css"/>
	<script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
	<script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
--%>

■ JQUERY(제이쿼리)를 이용한 뿅뿅
    <html>
	<head>
		<meta charset="utf-8"/>
		<title>두뇌로설명회</title>
		<script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>

		<style type="text/css">

			body {	margin-left: 0px; margin-right: 0px;  }
			html {  height: 100%; background: linear-gradient(#536D90,#B9CEDF);}
		</style>

		<script type ="text/javascript">
			var i = 2//String("00" + 2).slice(-3);
			var j; 
			$(document).ready( function() {
				$('#my_image').on({ 
					'click': function(){ 
						j = String("00" + i).slice(-3);
						//alert(j)
						$('#my_image').attr('src',"설명회통합/"+ j +".png");
						i=i+1; 
					
					} 
				});				
			});					
		</script>
	</head>
	<body>
		<img id="my_image" src="설명회통합/001.png" width="100%" height="748"/>
	</body>
	</html>


■ 비하인드코드에서 가로크기 설정  
        Div1.Style("width") = "600px" ==> 임의숫자 "" 를 씌움
        Div1.Style("width") = 100% ==> 퍼센트 "" 뺌

■ 비하인드코드에서 폰트 조절
<span style='background-color: #FFFFFF;Font-Size:30 font-weight: bold' class='box-radius'>☞주문메뉴☜</span>
<span style='color:blue; text-decoration: underline'>(확인)</span>
*방법 : 디자인 박스에서 설정후 아래부분에 나오는 코딩 복사해서 넣으면 그대로 적용됨
        style - 스타일수정박스 - (조작후) - 설명박스에자동코딩됨 그걸 복사해서 넣음


■ 비하인드코드에서 백그라운드이비지 바꾸기 http://www.nullskull.com/q/10095139/how-to-change-lttdgt-background-from-code-behind-c.aspx
msgboxtb.Style.Add(HtmlTextWriterStyle.BackgroundImage, "IMAGE/RealMessageble.png")

■ 머리말 꼬리말 등등..http://www.webmadang.net/script/script.do?action=read&boardid=3002&page=1&seq=37
<style tyle="text/css">

html,

body {

    margin:0;

    padding:0;

    height:100%;

}

#wrapper {

	position:relative;

    min-height:100%;

}

#header {

	height:70px;

    background:#ccc;

}

#container {

    padding:20px;

}

#footer {

    position:absolute;

    bottom:0;

    width:100%;

    height:70px;   

    background:#ccc;

}

</style>


■ 모바일 핸드폰 키패드에 숫자로 나오게(피씨에러없음)
   <div>전화<asp:TextBox ID="TxtBoxTEL" runat="server" type="tel" data-mini="true" 
'                                        placeholder=""></asp:TextBox> </div>  

■ [제이쿼리] jQuery cookie(쿠키) 사용하기 http://blog.naver.com/PostView.nhn?blogId=elren&logNo=220845229927&categoryNo=0&parentCategoryNo=31&viewDate=&currentPage=1&postListTopCurrentPage=1&from=postView
    # 쿠키(cookie) 사용하기

1. 쿠키 저장, 쿠키 값 설정하기

1) 기본 저장

1
$.cookie('key', 'value');

- 기본 : 세션 쿠키

- 브라우저가 열려 있는 동안만 유지

2) 만료일 지정 

1 $.cookie('key', 'value', { expires : 값 } );

- expires 단위는 일(日)

- 쿠키 사용 기간을 일 단위로 지정

3) 경로(path) 지정

1$.cookie('key', 'value', { expires : 값, path : '/' } );
2$.cookie('key', 'value', { path : '/' } );



- 별도의 path 지정을 하지 않으면, 쿠키가 만들어진 현재 페이지에만 적용.

- 모든 페이지에서 쿠키 사용을 원할 시 위와 같이 path:'/' 설정

2. 쿠키 읽기 

1
$.cookie('key');

- 해당 key가 없다면 null 반환

3. 쿠키 삭제

1
2
$.cookie('key', null);
$.removeCookie('key', 옵션);

- path 옵션을 주어 쿠키를 만들었다면 삭제할 때 같은 path 옵션 필요

# 쿠키 생성 시 옵션 항목

expires : 365

기본 : 세션쿠키

쿠키 사용 기간을 일 단위로 설정.

path : '/'

기본 : 현재 페이지

쿠키가 적용되는 페이지 경로. 

별도로 지정하지 않는 경우 쿠키를 생성한 현재 페이지에서만 사용.

사이트 전체 페이지에 적용하려면 위와 같이 설정.

domain : 'domain.com'

기본 : 쿠키가 만들어진 도메인 

쿠키가 적용될 도메인

secure : true

기본 : false

true로 설정 시 쿠키 전송은 https 프로토콜로만 가능

raw : true

기본 : false

false일 경우, 쿠키가 생성되거나 쿠키를 읽을 때

기본적으로 인코딩/디코딩을 한다(encodeURIComponent / decodeURIComponent 이용) 

■ 비하인드코드에서디자인스타일바꾸기 
 디자인: <div id="BOX1" runat="server" ></div>
 비하인드코드:   BOX1.Style("FontSize") = 55 

■ 변환함수
   문자열을 시간으로 Convert.ToDateTime(문자열)

■ 텍스트박스에 미리 글자정보 넣기
    <asp:TextBox ID="sample6_address" runat="server" placeholder="주소"></asp:TextBox>

■ 화면해상도구하기
    <script>
        var w = screen.availWidth;
        var h = screen.availHeight;
        alert("현재 접속하신 기기 화면의 너비는 " + w + "px이며, 높이는" + h + "px입니다.");
     </script>
■ 콘텐트의 높이에 따라 자동으로 Resizing 되는 Iframe 만들기. http://naradesign.net/wp/2007/12/12/129/
   <script type="text/javascript">
        // iframe resize
        function autoResize(i) {
            var iframeHeight =
            (i).contentWindow.document.body.scrollHeight;
            (i).height = iframeHeight + 20;
        }
    </script>
	<iframe src="#iframeUrl" 
   onload="autoResize(this)" scrolling="no" frameborder="0"></iframe>
   
   같은 도메인 URL을 지닌 iframe 콘텐트에만 이 스크립트를 사용할 수 있습니다.
IE6~7, FF2, Opera9, Safari2~3 크로스 브라우징을 확인 하였습니다.
참조

■ jQuery 로 iframe 의 내부 값  가져오기 http://aspdotnet.tistory.com/m/1090
		jQuery 로 iframe 의 내부 값 가져오기

		부모페이지

		<html lang="en">
		 <head>
		  <meta charset="UTF-8">
		  <meta name="Generator" content="EditPlus®">
		  <meta name="Author" content="">
		  <meta name="Keywords" content="">
		  <meta name="Description" content="">
		  <title>Document</title>
		  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
		   <script type='text/javascript'>
		 function init() {
		  var getval = $('#my_iframe').contents().find('#someID').html();
		  alert(getval);
		 }
		</script>
		 </head>
		 <body onload="init()">
 

		<IFRAME id="my_iframe" NAME='my_iframe' SRC='test.html'></IFRAME>

		<a onclick="init()">test</a>

		 </body>
		</html>

 

 

		iframe 내부 페이지

 

		<!doctype html>
		<html lang="en">
		 <head>
		  <meta charset="UTF-8">
		  <meta name="Generator" content="EditPlus®">
		  <meta name="Author" content="">
		  <meta name="Keywords" content="">
		  <meta name="Description" content="">
		  <title>Document</title>
		 </head>
		 <body>
		  <div id="someID">Hello world!</div>
		 </body>
		</html>
■ 문자열
   - 마지막문자 자르기 
     ORLST="1234" 일때
	 ORLST.Substring(0, ORLST.Length - 1) 하면
	 ORLST="123" 이된다

■ 테마만들고 적용
   App_Thermes - bt - bt.css
   bt.css 안에내용
   body 
{
/* Permalink - use to edit and share this gradient: http://colorzilla.com/gradient-editor/#f1e767+0,feb645+100;Yellow+3D */
background: rgb(241,231,103); /* Old browsers */
background: -moz-radial-gradient(center, ellipse cover,  rgba(241,231,103,1) 0%, rgba(254,182,69,1) 100%); /* FF3.6+ */
background: -webkit-gradient(radial, center center, 0px, center center, 100%, color-stop(0%,rgba(241,231,103,1)), color-stop(100%,rgba(254,182,69,1))); /* Chrome,Safari4+ */
background: -webkit-radial-gradient(center, ellipse cover,  rgba(241,231,103,1) 0%,rgba(254,182,69,1) 100%); /* Chrome10+,Safari5.1+ */
background: -o-radial-gradient(center, ellipse cover,  rgba(241,231,103,1) 0%,rgba(254,182,69,1) 100%); /* Opera 12+ */
background: -ms-radial-gradient(center, ellipse cover,  rgba(241,231,103,1) 0%,rgba(254,182,69,1) 100%); /* IE10+ */
background: radial-gradient(ellipse at center,  rgba(241,231,103,1) 0%,rgba(254,182,69,1) 100%); /* W3C */
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#f1e767', endColorstr='#feb645',GradientType=1 ); /* IE6-9 fallback on horizontal gradient */

}

하고 Document 속성에 StyleSheetThema 에 BT 넣음
  
■ chekbox 체크박스
   - 예아니오 true fale 디비에 저장하는방법
   DeliveryTimeSet = " + ChkBoxDTimeSET.Checked.ToString() + "

■ 브라우져 현재 작업창 닫기 https://gist.github.com/thirdj/6247017#file-closebrowsers-js
    
 closeBrowsers.js
$(function(){   
  $('#window-btn').click(function(){     
    if ( $.browser.msie ) {
      window.opener='Self';
      window.open('','_parent','');
      window.close();
    } else {
      window.close(); // 일반적인 현재 창 닫기
      window.open('about:blank','_self').self.close();  // IE에서 묻지 않고 창 닫기
    }
  })
});



■ 자바스크립트 없이 모바일 펼침메뉴 만들기
   
   <%--모바일펼침메뉴시작--%>
             ol, ul, dl { list-style: none;}
        html, body, form, div, p, h1, h2, h3, h4, h5, h6, dl, dt, dd, ul, ol, li, pre, input, blockquote, th, td, thead, tbody, legend, label, select, option, button, fieldset, select, textarea {
            margin: 0;
            padding: 0;
            text-align: center;
        }
        a, a:hover {
            color: inherit;
        }a {
            text-decoration: none;
            cursor: pointer;
            color: #444;
        }
        .body{
          position:relative;
          padding:0;
          margin:0;
          height:100%;
          width:100%;
          min-height:500px;
        }
        #wrap {
                position: relative;
            width: 100%;
            height: 100%;
            display: block;
            min-height: 1000px;
        }

        #header {
            height: 55px;
            overflow: hidden;
            position: relative;
            background: #ffffff; /* Old browsers */
            background: -moz-linear-gradient(top, #ffffff 0%, #ffffff 76%, #eeeeee 100%); /* FF3.6-15 */
            background: -webkit-linear-gradient(top, #ffffff 0%,#ffffff 76%,#eeeeee 100%); /* Chrome10-25,Safari5.1-6 */
            background: #ffffff; /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+ */
            filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#ffffff', endColorstr='#eeeeee',GradientType=0 ); /* IE6-9 */
            box-shadow: 0px 0px 10px #555;
            z-index: 2;
        }
        #header .logo {
                float: left;
                font-size:20px;
                line-height:40px;
                margin-left:20px;
            color: #FFCC00;
            height: 32px;
            width: 123px;
            margin-right: 20px;
            margin-top: 10px;
            margin-bottom: 0;
        }
        #header .menu {
                float: right;
                margin:10px 20px 0;
            }
        #content {
            min-height: 720px;
            padding: 5%;
            z-index: 3;
        }

        /*
          모바일웹 메뉴
        */

        #m_nav {
            display: none;
            position: absolute;
            top: 0;
            right: 0;
            width: 76%;
            height: 800px;
            background-color: #fff;
            z-index: 1002;
            box-sizing: border-box;
        }

            #m_nav .deps1 {
                position: absolute;
                right: 0;
                width: 100%;
            }

                #m_nav .deps1 > li {
                    padding: 0 30px;
                }

                    #m_nav .deps1 > li > a {
                        display: block;
                        width: 100%;
                        font-size: 17px;
                        font-weight: 500;
                        color: #888;
                        padding: 12px 20px;
                        box-sizing: border-box;
                        border-bottom: 1px solid #ddd;
                    }

                        #m_nav .deps1 > li > a:hover {
                            color: #000;
                        }

            #m_nav .title {
                color: #fff;
                background: #2aaeeb;
                font-size: 24px;
                padding: 16px 23px !important;
            }

            #m_nav .close_icon {
                overflow: hidden;
                text-indent: -999px;
                width: 40px;
                height: 40px;
                position: absolute;
                top: 20px;
                left: -80px;
                background: url('http://cfile25.uf.tistory.com/image/990FAC33599FC712190B56') no-repeat 0 0;
                cursor: pointer;
            }

            #m_nav .deps2 {
                padding: 10px 0;
                background: #f5f5f5;
                border-bottom: 1px solid #ddd;
            }

                #m_nav .deps2 > li {
                    margin-left: 38px;
                }

                    #m_nav .deps2 > li > a {
                        display: block;
                        padding: 9px 0;
                    }

                        #m_nav .deps2 > li > a:hover {
                            font-weight: 700;
                        }

        #fade {
            display: none;
            position: absolute;
            top: 0%;
            left: 0%;
            width: 100%;
            height: 100%;
            background-color: black;
            z-index: 1001;
            -moz-opacity: 0.8;
            opacity: .80;
            filter: alpha(opacity=80);
        }

            #fade .close {
                display: block;
                position: absolute;
                top: 0%;
                left: 0%;
                width: 100%;
                height: 100%;
            }   
        <%--모바일펼침메뉴끝--%>

		<body>

		   <%--펼쳐지는메뉴<!-- 상단 -->
                <span class="menu"><a href="javascript:void(0)" 
                 onclick="document.getElementById('m_nav').style.display = 'block'; document.getElementById('fade').style.display = 'block'">
                <img src="IMAGE/MobileMenu.png" 
                 alt="전체메뉴" /></a></span>
           
               <!-- 메뉴열림 -->
                <div id="m_nav">
                    <i class="close_icon" href="javascript:void(0)" onclick="document.getElementById('m_nav').style.display = 'none'; document.getElementById('fade').style.display = 'none'">닫기</i>
                    <ul class="deps1">
                        <li class="title">MENU</li>
                        <li><a href="DELIVERY.aspx">우리업소 소개</a></li>
                        <li><a href="">의견 보내기</a></li>
                        <li><a href="">쿠폰/포인트</a></li>
                    </ul>
                </div>
                <div id="fade">
                    <a class="close" href="javascript:void(0)" onclick="document.getElementById('m_nav').style.display = 'none'; document.getElementById('fade').style.display = 'none'" title="닫기">
                    </a>
                </div>--%>
          </body>




■ ASP.NET] ASP.NET 이벤트 발생 순서 http://wiz.pe.kr/m/80

■ 그리드 이미지 버튼 바꾸기 https://stackoverflow.com/questions/229870/gridview-dynamic-image-change-in-imagebutton
    <ItemTemplate>
            <asp:ImageButton ID="ImgBtnDeliverly" runat="server" ImageUrl='<%# GetImageUrl(Eval("처리여부")) %>' onclick="ImgBtnDeliverly_Click" />
    </ItemTemplate>

   Public Function GetImageUrl(checkObject As Object) As String
        If (checkObject = "대기중") Then
            Return "~/IMAGE/배달대기.png"
            'Return StrSAU.ToString.Substring(0, 3) + " ..."
        ElseIf (checkObject = "처리완료") Then
            Return "~/IMAGE/배달완료.png"

        Else

            Return "~/IMAGE/배달완료.png"
        End If
    End Function

■ 그리드 내부에 인덱스버튼넣었을때 인덱스번호 찿기(제일중요)
   'GridView1_ImgBtnPRS_1 찾음
        Dim Gidx As Integer = Right(DirectCast(sender, System.Web.UI.WebControls.ImageButton).ClientID, 1)
    *찾는방법 :
	디버깅시 해당프로시저에 + 를 클릭하여 속성리스트나오면 거기서 모든 속성값을 찾을수 있다.

■ asp.net gridview imagebutton click event https://stackoverflow.com/questions/8220006/asp-imagebutton-onclick-function-inside-gridview-within-an-updatepanel
    <ItemTemplate>
        <asp:ImageButton ID="ImgBtnPRS" runat="server" ImageUrl="~/IMAGE/처리완료.png" 
            onclick="ImageButton1_Click" />
    </ItemTemplate>
   
    Dim imageButton As ImageButton = CType(sender, ImageButton)
	Dim row As GridViewRow = CType(imageButton.NamingContainer, GridViewRow)
	Dim BTNPRS As ImageButton = DirectCast(row.FindControl("ImgBtnPRS"), ImageButton)

	BTNPRS.OnClientClick = "CallPrint('bill')" 

■ Visual C# .NET을 사용하여 DataTable 간에 DataRow를 복사하는 방법 https://support.microsoft.com/ko-kr/help/308909/how-to-copy-datarows-between-datatables-by-using-visual-c--net

' Copy from the results of a Select method.
For Each MyDataRow As DataRow In DataTable1.[Select]("Region = 'WA'")
	DataTable2.ImportRow(MyDataRow)
Next
Console.WriteLine(DataTable2.Rows.Count)
Console.ReadLine()

' Copy from the results of a DataView.
DataView1 = DataTable1.DefaultView
DataView1.RowFilter = "Region = 'WA'"
For i As Integer = 0 To DataView1.Count - 1
	DataTable2.ImportRow(DataView1(I).Row)
Next
Console.WriteLine(DataTable2.Rows.Count)
Console.ReadLine()
 


■ 각 변수사용의 설명 
    http://blog.naver.com/PostView.nhn?blogId=february2ttl&logNo=80141030635

■ 텍스트박스 모서리 둥글게
.box-radius {
   padding: 10px;
   border: 1px solid #cc0000;
   border-radius: 15px;
   -moz-border-radius: 15px;
   -webkit-border-radius: 15px;
   -o-border-radius: 15px;
}

■ chekbox 값 DB저장
    cmd = New OleDbCommand("UPDATE NFC_SMSmsg SET smsDW = '" + TextBoxDW.Text + "', smsHW = '" + TextBoxHW.Text + "' , StudyOption = '" + RdoBtnLstStudy.SelectedIndex.ToString() + "', sndSMS = " + ChkBoxSndSMS.Checked.ToString + ", sndMail = " + ChkBoxSndMail.Checked.ToString + " ", cn)

   

■ 모바일 바탕에 스타일(예 그라이테이션) 모두 적용시키려면 (아래순서)
    <%@ Page Language="VB" AutoEventWireup="false" CodeFile="NFC_출결.aspx.vb" Inherits="NFC_출결" %>
    <meta name="viewport" content="width=device-width, height=device-height, user-scalable=no,initial-scale=2,maximum-scale=1.0,minimum-scale=1.0" />
  

■ 형식변환 http://mainia.tistory.com/304
   Dim Usecnt As Integer = Convert.ToInt16(LblUseSms.Text) + 1 : 문자-> 숫자


■ accdb 및 mdb 연결하기 https://www.connectionstrings.com/access/
   -표준-
   Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\myFolder\myAccessFile.accdb;
   Persist Security Info=False;
   -암호있으면-
   Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\myFolder\myAccessFile.accdb;
   Jet OLEDB:Database Password=MyDbPassword;



■ (중요) 변수줄때 따옴표가 중복될경우 " -> ' 로 바꿔서 저장해준다 또는 기존 " 를 없앤다
   예)TarX = "Content = "5; url=Order테이블.aspx"" ===> TarX = "Content = '5; url=Order테이블.aspx'" or "Content = 5; url=Order테이블.aspx?value=  url=Order테이블.aspx"(추천)
   변수포함이면) TarX = "url=Order테이블.aspx?value=" + getLTD
 
■ 메타테그에 페이지 자동리로드 비하인드코드에서
   <meta http-equiv="refresh" content="<%=tarX %>">
    Public TarX As String
    Protected Sub Page_Load(sender As Object, e As System.EventArgs) Handles Me.Load
        TarX = "3"
    end sub

 
■ 스타일에그라이언트추가
     html 
         {
           height: 150%;
           background: linear-gradient( SkyBlue,Lavender , LightGreen);
          }

■ 폼로드에서 커맨드버튼 불러오기 https://stackoverflow.com/questions/21061160/how-to-click-a-button-on-form-load-using-c-sharp
   public partial class WebForm1 : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        Button1_Click(sender, e);
    }

    protected void Button1_Click(object sender, EventArgs e)
    {
        Response.Write("Calling event from an event...");
    }
}
ASPX :

<body>
<form id="form1" runat="server">
<div>
    <asp:Button ID="Button1" runat="server" Text="Button" onclick="Button1_Click" />
</div>
</form>



■공통함수 만들기 http://www.devpia.com/Maeul/Contents/Detail.aspx?BoardID=7&MaeulNo=5&no=76308&ref=76306
   
   using System;
using System.Data;
using System.Configuration;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Web.UI.HtmlControls;

public static class Math1
{
 public static float GetPI()
    {
        return 3.14F;
    }
}
 
App_Code폴더 밑에 Math1.cs라는 클래스 화일을 만든 후 위처럼 하게 되면..
 
    protected void Page_Load(object sender, EventArgs e)
    {
        Response.Write(Math1.GetPI());
    }
 
이런 형식으로 호출 할 수도 있습니다..static은 쓰기 나름이겠지만요..
 
 
브라우져단 자바스크립트로 필요하다면 .js화일을 이용한 방법도 있겠죠..


■모바일 이미지 자동 조절 http://www.dweb.co.kr/m/bbs/board.php?bo_table=webstandard&wr_id=20


■<div> 나 <table>을 이용하여 <span> 내맘대로 위치하기
  <div style="position: relative">
     <span runat="server" style="position: absolute; ">
       내망대로 스판 위치 시킨다..중요
     </span>
 </div>
  * span 의 right 속성을 줘야 <div>에 비례해 움직인다.
  예) position: absolute; top: 0px; right: 0px; text-align: right; float: right;


■[실행모드(모바일)에서 디버깅방법]
열때 IIS모드로 열어야 됨- 디자인모드에서실행 - 중단점 걸림 - 계속실행(디자인모드에서는 실행상태) - 실행모드에서실행

■Ajax(아작스)

- 업데이트판넬 여러개 쓸때 http://blog.danggun.net/1986

■반응형웹
  - 화면 크기에 따라 배경및 폰트 변경 
  </body>
   <style type="text/css">
        body{background-color:blue;}
        @media all and (min-width:320px){
        body{background-color:yellow}
        }
        @media all and (min-width:720px
        {
        body{background-color:red;}
         .article {font-size:44px;}
        }
        @media all and (min-width:1024px){
        body{background-color:skyblue;}
        .article {font-size:12px;}
        }
        
        img { max-width: 100%;
              height: auto;
            }
   </style>

   - jQuery를 이용하면 웹 페이지 내에 있는 모든 이미지에 대해서 위에서 설명한 크기 자동 조절 속성을 추가할 수 있습니다. http://www.erzsamatory.net/86
	<!DOCTYPE html>
	<html lang="ko">
	<head>
		<meta charset="utf-8"/>
		<title>Responsive Web</title>
		<script src="http://code.jquery.com/jquery-1.7.0.min.js"></script>
		<style>
			body {
				padding:0px;
				margin:0px;
			}
		</style>
		<script>
			$(function() {
				$("#post_content img, .resizablebox").each(function() {
					var oImgWidth = $(this).width();
					var oImgHeight = $(this).height();
					$(this).css({
						'max-width':oImgWidth+'px',
						'max-height':oImgHeight+'px',
						'width':'100%',
						'height':'100%'
					});
				});
			});
		</script>
	</head>
	<body>
		<div id="post_content">
			<img src="http://www.erzsamatory.net/attach/1/3349047834.jpg" />
			<br /><br />
			<img src="http://www.erzsamatory.net/attach/1/2751001801.jpg" />
		</div>
	</body>
	</html>
■FreeTextBox1

   ' 문자때문에 저장오류시 


■ 형변환함수 http://blog.daum.net/courting/6


■ 기타
   - 모바일에서 크기 맞게 나오게 하려면 하이퍼링크 타켓을 _parent 로..


■panel(판넬)
  모니터 화면크기에맞게 판넬크기 조절하기 http://stackoverflow.com/questions/9955854/make-asp-panel-fill-all-the-height-of-its-container-height 
  <asp:Panel ID="Panel1" runat="server" ScrollBars="Vertical">   
      <div style="height:calc(100vh - 240px);">
                                     
         내용
      </div> 
  </asp:Panel>
                           
■ pdf 파일 오픈

   '------ 코드에서 오브젝트 Literal 사용 ------------
   (https://www.aspsnippets.com/Articles/Open-View-PDF-Files-on-Browser-in-ASPNet-using-C-and-VBNet.aspx)
   HTML Markup
The HTML Markup consists of an ASP.Net LinkButton and a Literal control.
<asp:LinkButton ID="lnkView" runat="server" Text="View PDF" OnClick="View"></asp:LinkButton>
<hr />
<asp:Literal ID="ltEmbed" runat="server" />
 
 
Open (View) PDF Files on Browser in ASP.Net
The below event handler is raised when the View LinkButton is clicked. Here I am making use of HTML OBJECT Tag to embed PDF in browser. An HTML string of an OBJECT tag is generated in which the path of the PDF file is set.
The HTML string is then set to the Literal Tag.
To know more about Literal control, please visit Difference between Label and Literal control in ASP.Net
C#
protected void View(object sender, EventArgs e)
{
    string embed = "<object data=\"{0}\" type=\"application/pdf\" width=\"500px\" height=\"300px\">";
    embed += "If you are unable to view file, you can download from <a href = \"{0}\">here</a>";
    embed += " or download <a target = \"_blank\" href = \"http://get.adobe.com/reader/\">Adobe PDF Reader</a> to view the file.";
    embed += "</object>";
    ltEmbed.Text = string.Format(embed, ResolveUrl("~/Files/Mudassar_Khan.pdf"));
}
 
VB.Net
Protected Sub View(sender As Object, e As EventArgs)
    Dim embed As String = "<object data=""{0}"" type=""application/pdf"" width=""500px"" height=""300px"">"
    embed += "If you are unable to view file, you can download from <a href = ""{0}"">here</a>"
    embed += " or download <a target = ""_blank"" href = ""http://get.adobe.com/reader/"">Adobe PDF Reader</a> to view the file."
    embed += "</object>"
    ltEmbed.Text = String.Format(embed, ResolveUrl("~/Files/Mudassar_Khan.pdf"))
End Sub



   '-------- 전체 pdf 파일 불러옴 ------------
                'Dim FilePath As String = Session("strIP") + "/GONGBUBANG/STUDYROOM/겨자씨의꿈/" + ViewState("Dpath") + "001.pdf" 'Server.MapPath("javascript1-sample.pdf")
                'Dim User As New WebClient()
                'Dim FileBuffer As [Byte]() = User.DownloadData(FilePath)
                'If FileBuffer IsNot Nothing Then
                '    Response.ContentType = "application/pdf"
                '    Response.AddHeader("content-length", FileBuffer.Length.ToString())
                '    Response.BinaryWrite(FileBuffer)
                'End If


■ [asp.net] 코드 비하인드에서 동적으로 CSS 바꾸기 ... - HOONS닷넷
STABLE.Attributes("style") = "width:380px;" => 스타일 직접 작성
STABLE.Attributes("class") = "box" => 스타일가져옴
STABLE는 테이블 아이디
FrmSiteMaster.Attributes.Add("style", "background-color: #FFFFFF")
DIV_Price.Attributes.Add("class", "Style_non")

■ 텍스트와 이미지 탑라인 맞추기 http://shonm.tistory.com/category/HTML/img%20%ED%83%9C%EA%B7%B8%EB%A5%BC%20%ED%85%8D%EC%8A%A4%ED%8A%B8%EC%99%80%20%EB%86%92%EC%9D%B4%20%EB%A7%9E%EC%B6%94%EA%B8%B0
이미지 가운데(중간) 위치
<img src="imgags/download.PNG" style="vertical-align:middle;">

<a href="AddnewPage1.aspx">
    <img class="displayed1" src="Images/NewProjectCohesive02.jpg" alt="" />
</a>

■ 페이지에 url 불러오기
   <object type="text/html" data="http://validator.w3.org/" width="800px" height="600px" style="overflow:auto;border:5px ridge blue">
    </object>

■ 새로고침(다시읽기)reflash
Once the page is rendered to the client you have only two ways of forcing a refresh. One is Javascript

setTimeout("location.reload(true);", timeout);
The second is a Meta tag:

<meta http-equiv="refresh" content="600">
You can set the refresh intervals on the server side.
 https://stackoverflow.com/questions/1206507/how-do-i-refresh-the-page-in-asp-net-let-it-reload-itself-by-code

Response.Flush(); 코딩으로사용시

Response.Write("<script type='text/javascript'> setTimeout('location.reload(true); ', timeout);</script>")


 function reloadPage()
 {
     window.location.reload()
 }
Code Behind

Response.Redirect(Request.RawUrl)
Meta Tag

<meta http-equiv="refresh" content="600"></meta>
Page Redirection

Response.Redirect("~/default.aspx"); // Or whatever your page url



■ 자바스크립트 타이머 - setTimeout, setInterval, clearInterval 함수
   http://ooz.co.kr/194

■ 줄바꾸기
   recip_address, " _
& "rm.expiration_date,

■ 쿼리문
    - 필드변수로 할때
       Dim strOJT As String = ViewState("sltField")
       SLTQRY = "select * from [member] where (gubun =" + GUBUN + ") and  (" + strOJT + " like '%" + TxtBoxFindBox.Text + "%') and (삭제 = 0 )"

	   "UPDATE " + ViewState("getLTD") + " set 처리여부 = '처리완료' where ID = " + GridView1.Rows(GridView1.SelectedIndex).Cells(0).Text + ""

■ 칼라바꾸기
   TxtBoxSbject.BorderColor = System.Drawing.ColorTranslator.FromHtml("#B5C3DE")

■ 비하인드에서 mp4실행
   - 비하인드 코드
     videoTag.Attributes("controls") = ""
     videoTag.Attributes("src") = "/GONGBUBANG/STUDYROOM/mov/직각이등변삼각형.mp4"
   - 소스코드
    <video id="videoTag" runat="server" controls="">
                        
                        </video>


■ [스크랩] 이미지배경 투명처리 http://www.moros.kr/118
첨부파일을 참조에 추가해서 사용하면 되며 사용 샘플 코드는 아래와 같다.
 
투명화 범위를 웹 컬러 포멧(#efefef 형태)  으로 지정할 수 있으며 처리 결과물의 경로를 지정할 수 있다. 
 
결과물은 png 형태로 저장한다.
 
도장이나 개인 사인등의 배경을 투명화 처리하는데 사용할 수 있다.
 
그레이 스케일 이미지의 경우 범위 지정을 좀 더 섬세히 하면 깔끔한 결과물을 얻을 수 있다.
 
결과 예제
 
원본 이미지 : 
     
 
결과 이미지 :

 
using System;
using System.Data;
using System.Configuration;
using System.Collections;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Web.UI.HtmlControls;
using SSICOM_GDI_PLUS;
 
namespace gdiplus_exam
{
    public partial class _Default : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            string sOrgPath = @"c:\\ssssss.bmp";  //원본 파일경로
            string sTargetPath = @"e:\"; //결과물 저장폴더
 
            SSICOM_GDI_PLUS.IMAGE_CONVERT sic = new IMAGE_CONVERT();
 
            /// <param name="sFileName">원본 파일명</param>
            /// <param name="sColorStr">투명화 비교 시작 값 (web color format)</param>
            /// <param name="eColorStr">투명화 비교 종료 값 (web color format)</param>
            /// <param name="sTargetPath">결과물 저장폴더(png 확장자를 가진 원본파일이름)</param>
// #aaaaaa 부터 #ffffff 까지 영역의 색상을 투명화 처리 한다.
            string sConvertedimagePath = sic.fctConvertToTransparent(sOrgPath, "#aaaaaa", "#ffffff", sTargetPath);
 
            Response.Write("<img src='" + sOrgPath + "'>");
            Response.Write("<img src='" + sConvertedimagePath + "'>");
        }
    }
}
 
 
 
처리 메소드 소스
 
using System.Drawing;
using System.Drawing.Imaging;
using System.IO;
 
상기 3개의 네임 스페이스를 추가하여야 한다.
 
        /// <summary>
        /// 특정 컬러를 투명화 처리한다.
        /// </summary>
        /// <param name="sFileName">원본 파일명</param>
        /// <param name="sColorStr">투명화 색상 범위 시작 값 (web color format)</param>
        /// <param name="eColorStr">투명화 색상 범위 종료 값 (web color format)</param>
        /// <param name="sTargetPath">결과물 저장폴더(png 확장자를 가진 원본파일이름)</param>
        /// <returns></returns>
        public string fctConvertToTransparent(string sFileName, string sColorStr, string eColorStr, string sTargetPath)
        {
            // html 포멧 컬러일 경우 #이 선행되어야 한다. 
            if (!sColorStr.StartsWith("#"))
                sColorStr = "#" + sColorStr;
 
            if (!eColorStr.StartsWith("#"))
                eColorStr = "#" + eColorStr;
 
            // 색상 정보를 컬러 오브젝트로 선언
            Color sColor =  ColorTranslator.FromHtml(sColorStr);
            Color eColor = ColorTranslator.FromHtml(eColorStr);
 
            FileInfo fi = new FileInfo(sFileName);
 
            System.Drawing.Color tmpColor;
 
            // 결과물 경로용
            string sResultFile = string.Empty;
 
            // 원본 파일을 읽어 비트맵을 생성
            using (System.Drawing.Bitmap BaseBitmap = (System.Drawing.Bitmap)System.Drawing.Bitmap.FromFile(sFileName))
            {
                // 결과물을 생성하기 위한 비트맵
                using (System.Drawing.Bitmap NewBitMap = new System.Drawing.Bitmap(BaseBitmap.Width, BaseBitmap.Height, System.Drawing.Imaging.PixelFormat.Format32bppArgb))
                {
                    // BaseBitmap 을 픽셀단위로 읽으면서 해당 픽셀의 색 정보가 지정한 색상 범위에 속하는 경우라면
                    // 투명 색상으로 지정한다. 그게 아니라면 원래 색상을 그대로 유지한다.
                    // 이런 형태로 NewBitMap 의 동일한 좌표에 점을 찍는 형태로 구현되었다.
 
                    for (int x = 0; x < BaseBitmap.Width; x++)
                    {
                        for (int y = 0; y < BaseBitmap.Height; y++)
                        {
                            // 특정 픽셀의 색상 정보를 갖고온다.
                            tmpColor = BaseBitmap.GetPixel(x, y);
 
                            if (!
                                (
                                ((tmpColor.R >= sColor.R) && (tmpColor.R <= eColor.R)) &&
                                ((tmpColor.G >= sColor.G) && (tmpColor.G <= eColor.G)) &&
                                ((tmpColor.B >= sColor.B) && (tmpColor.B <= eColor.B))
                                )
                               )
                            {
                                NewBitMap.SetPixel(x, y, tmpColor);
                            }
                        }
                    }
 
                    sResultFile = sTargetPath + fi.Name.Substring(0, fi.Name.Length - fi.Extension.Length) + DateTime.Now.Ticks.ToString() + ".png";
                    NewBitMap.Save(sResultFile, System.Drawing.Imaging.ImageFormat.Png);
                }
            }
 
            fi = null;
 
            return sResultFile;
        }


■ 에러처리
    - Web.config 에서 처리해주는 방법
  <!-- <customErrors mode="On" /> Off클라이언트에서 에러내용 view --> 이부분 반드시 주석처리해야함
    <!--■ 페이지 에러날경우 특정 웹페이지로 바로가기-->
    <customErrors mode="RemoteOnly" defaultRedirect="ErrPage.aspx">
      <error statusCode="500" redirect="Test.aspx" /> 에러번호에 따라 에러처리
    </customErrors>


■ 프레임
   <!--

<head runat="server">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
<LINK REL="SHORTCUT ICON" HREF="http://ddoksori.codns.com:8080/workboard/wb.ico">
    <title>워크보드업무전용게시판</title>
 
    <style type="text/css">
        #form1
        {
            text-align: center;
        }
        </style>
 
    </head>

 <frameset rows="1*">
 <frame id="frameID" src="http://ddoksori.codns.com:8080/workboard/Default.aspx" runat="server"></frame>
 </frameset>


     <frameset row="1*">
        <frame name="main" src="http://ddoksori.codns.com:8080/workboard/Default.aspx" runat="server"></frame>  
</frameset>
  
   -->
'------------------------------------------------------------------------------------------------
예시

1 . Default.aspx 페이지

    <iframe id="frameID" style="width:100%;border:0px;height:10%;" src="docu.aspx" runat="server"> 

    위 코드를 추가

 

2. Default.aspx.cs 페이지

         HtmlControl frame1 = (HtmlControl)this.FindControl("frameID");

        VB.NET코드 : Dim frame1 As HtmlControl = DirectCast(Me.FindControl("frameID"), HtmlControl)


          위 코드로 iframe에 접근 가능하다.

   

         frame1.Attributes["src"]="www.naver.com"; 

         VBNET코드 : frame1.Attributes("src") = "www.naver.com"

         위 코드로  iframe에 속성을 변경 가능하다 .

         위 코드는 src 속성을 변경한 것이다.

 

   또는

 

         frameID.Attributes["src"]="www.naver.com"; 

         runat="server" 를 해주었으므로 iframe 아이디로 속성에 접근 가능하다.

 

여기서 포인트!

 iframe에 runat="server" 가 있어야 비하인드 코드인 cs 파일에서 접근 가능하다
[출처] ASP.NET 에서 iframe 사용하기|작성자 세진

■ Background, 배경이미지 설정

-css 에 설정 (모든 페이지에 적용됨)
body   
{
    /*background: #DDDCF3;
    background: #FFFFFF;*/
   background-image:url('../IMAGE/Background1.png');  /*백그라운드에 이미지 불러옴(코드에서 처리) */
}

-body 에 설정
<body  background="IMAGE/Background.png">
</body>

- 스타일로 설정
<body style="background-image:url(bgr.jpg);">
...
<body style=" margin:0px;width:600px; height:90%;" >
</body>

<style type="text/css">
body {
  background-image: url("IMAGE/Background.png");
}
</style>


■ 이미지
    - 일반(컨트롤이아닌)이미지 코드에서 속성 정해주기
         이미지 아이디를 kind1로 한다음  kind1.Attributes("src") = "IMAGE/신규등록/회사명.png" 


■ 비하인드에 클릭이벤트 없이 소스코드에서 해결방법
    비하인드에 추가
     Public Sub NextView(ByVal sender As Object, ByVal e As System.EventArgs)
        MultiView1.ActiveViewIndex += 1
    End Sub

    소스코드에 추가
    <asp:ImageButton ID="ImgBtnNext1" runat="server" 
            ImageUrl="https://cdn4.iconfinder.com/data/icons/circle-blue/64/next.png" 
             OnClick="NextView" />
    </asp:View>

■ 윈도우프린트
   Protected Sub GridView1_SelectedIndexChanged(sender As Object, e As System.EventArgs) Handles GridView1.SelectedIndexChanged
        ScriptManager.RegisterClientScriptBlock(Me.Page, Me.[GetType](), Nothing, "printing()", True)
    End Sub

	<script language="javascript" type="text/javascript">
        function printing()
        {
            window.print();
        }
    </script>

■ 프린터버튼추가

 <script language="javascript" type="text/javascript">
        function CallPrint(strid) {
            var prtContent = document.getElementById(strid);
            var WinPrint = window.open('출력', '빵', 'letf=1000,top=1000,width=1000,height=1000,toolbar=50,scrollbars=50,status=50');
            WinPrint.document.write(prtContent.innerHTML);
            WinPrint.document.close();
            WinPrint.focus();
            WinPrint.print();
            WinPrint.close();
            prtContent.innerHTML = strOldOne;
        }
</script>

출력버튼추가후 소스코드에
    <div id ="bill">
       <asp:button id="BtnPrint" runat="server" text="Print" onclientclick="javascript:CallPrint('bill');" xmlns:asp="#unknown" />
    </div>


■ 인덱를이용하여 for 문으로 스테이트 변수 만들기 ("SAWONID" & i 에서 & 가 포인트) - 내가직접발견
    Dim SAWONID() As String = MEMINFO(1).Split(New Char() {";"c}) '아이디
        For i = 1 To UBound(MEMINFO(1).Split(New Char() {";"c}))
            ViewState("SAWONID" & i) = SAWONID(i)
        Next
           
           *특정문자열 개수찿기 UBound(MEMINFO(1).Split(New Char() {";"c}))


■ 라벨 자동줄바꿈
    lblMsg.text = 내용.replace("\r\n","</br>")

■ 다른 페이지에 함수실행
    1. 시나리오
korea.aspx.cs 와 japan.aspx.cs 두개가 있다.
korea.aspx.cs 에는 japan.aspx.cs 에 기술되어 있는 Takeshima(string _getparm){...} 를 호출하고자 한다.

2. korea.aspx.cs 기술
korea.aspx.cs 에는 아래와 같이 객체를 생성한다.

Dim bll As New japan()
Dim a As String = bll.Takeshima("아니다")
Response.Write(a)

구현하며...

3. japan.aspx.cs 기술

Public Function Takeshima(_getparm As String) As String
	Return Convert.ToString("다케시마 우리꺼") & _getparm
End Function

파라미터 받은 값과 합쳐서 문자열을 반환토록 했다.

4. 실행하자.

이제 실행해보자. korea.aspx 를 실행하면, 해당 japana.aspx.cs 의 Takeshima 메소드를 호출하게 된다.

■ 이미지  미리보기 http://kindtis.tistory.com/514

<%--이미지 업로드전 미리보기--%>
<script type="text/javascript" src="http://code.jquery.com/jquery-1.8.2.js"></script>
<script type="text/javascript">
    function readURL(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();
            reader.onload = function (e) {
                $('#Imgpic1').attr('src', e.target.result);
            }
            reader.readAsDataURL(input.files[0]);
        }
    }
</script>
<%--<input type='file' onchange="readURL(this);" />--%>
    <div runat="server" id="ImgpicBox"><img id="Imgpic1" src="IMAGE/사진.png"  
            alt="image" height="150" width="120" /></div>
<asp:FileUpload ID="FileUpload1" runat="server" Height="22px" Width="300px"  onchange="readURL(this);"/>


■ C #를 사용하여 Asp.Net에서 업로드하는 동안 이미지 크기 조정
   https://www.technetexperts.com/web/image-resizing-during-upload-in-asp-net-using-c/2/

■ How to upload a file without page refresh
   http://dotnetthoughts.net/how-to-upload-a-file-without-page-refresh/

■ Upload File (파일업로드)
https://asp-net-example.blogspot.com/2009/01/aspnet-fileupload-example-how-get_13.html

■ Upload File (파일업로드)

-파일업로드 풀패스  System.IO.Path.GetFullPath(FileUpMenuImg.FileName)

-이벤트발생시키기..http://stackoverflow.com/questions/4665040/click-event-of-a-button-to-fire-fileupload-control-in-asp-net

소스코드에..
<%--파일업로드 이벤트발생--%>
    <script type="text/javascript" >
        function uploadImage() {
            $('#<%= uploadedfiles0_Btn.ClientID %>').click();
            alert('***')
        }

        function selectFile() {
            $('#<%= uploadedfiles0.ClientID %>').click();
        }
   </script>

<asp:FileUpload ID="uploadedfiles0" runat="server"  style="font-size: large; color: #000000;" Width="339px"  onChange="uploadImage()" class="hidden"/>
<asp:Button ID="uploadedfiles0_Btn" runat="server" Text="Upload File" OnClientClick="selectFile(); return true;" /> <%--'false하면 함수만 실행(비하인드코드실행안함)--%>

*파일선택시에 이벤트 발생시키려면
<asp:FileUpload ID="uploadedfiles0" runat="server"  style="font-size: large; color: #000000;" Width="339px"  onChange="selectFile()" class="hidden"/>


비하인드코드에
 Protected Sub uploadedfiles0_Btn_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles uploadedfiles0_Btn.Click
        Response.Write("<script language = 'javascript'>alert('로그인 페이지로 이동합니다.')</script>")
    End Sub



   - 서브밋버튼없이 전송 http://www.aspsnippets.com/Articles/Upload-File-without-clicking-Submit-Button-using-FileUpload-control-in-ASPNet.aspx
   Protected Sub Page_Load(sender As Object, e As EventArgs) Handles Me.Load
        FileUpload1.Attributes("onchange") = "UploadFile(this)"
   End Sub

   -서브밋 후의 이벤트 http://stackoverflow.com/questions/830899/asp-net-fileupload-event-after-choice-is-made-and-before-submit-for-upload
   <asp:FileUpload runat="server" 
    onchange="alert('you selected the file: '+ this.value)" />

■  파일업로드
           Try
                FileUpReport.SaveAs(Server.MapPath("\DATA\TEST\" & TxtNAME.Text & "_" & FileUpReport.FileName))
                ImgRPT.ImageUrl = "http://www.디로그.kr/DATA/TEST/" & TxtNAME.Text & "_" & FileUpReport.FileName
                LblMsg.Text = "업로드된파일:   " '& TxtNAME.Text & "_" & FileUpReport.PostedFile.FileName
            Catch ex As Exception
                LblMsg.Text = ex.Message.ToString
                'Response.Write("<script language = 'javascript'> alert(" + ex.Message.ToString + ") </script>")
            End Try


■ 파일업로드 입력박스없이 버튼만보이게
   

■ 파일업로드이벤트(fileupload event)만들기: http://www.aspsnippets.com/Articles/Upload-File-without-clicking-Submit-Button-using-FileUpload-control-in-ASPNet.aspx

Protected Sub Page_Load(sender As Object, e As EventArgs) Handles Me.Load
    FileUpload1.Attributes("onchange") = "UploadFile(this)"
End Sub

<script type="text/javascript">
    function UploadFile(fileUpload) {
        if (fileUpload.value != '') {
            document.getElementById("<%=btnUpload.ClientID %>").click();
        }
    }
</script>

파일에 업로드하면 btnUpload 클릭이벤트가 실행된다.

■  파일업로드시 이미 파일이 있으면...
 //1-2.업로드
    //업로드될 dir경로를 만든다.
    string sFileUri = HttpContext.Current.Server.MapPath("~/")
                        + string.Format(@"\{0}", FileUpload1.PostedFile.FileName);
 
    //이미 같은 이름의 파일이 있으면 지워준다.
    File.Delete(sFileUri);

■  파일업로드시 이미지 미리보기 http://jubilate.tistory.com/57
    //미리보기될 이미지 컨트롤
<img id=imgJPG runat="server" width=750 />
//업로드 컨트롤
<asp:FileUpload ID="fileUploadControl" OnPropertyChange="javascript:fn_imagePreview(this.value);" runat="server" BorderColor="Gainsboro" BorderWidth="1px" ForeColor="DarkGray" ToolTip="이미지파일(jpg)업로드 시 가로넓이 750px로 맞춰야 이미지가 깨지지 않고 제대로 나옵니다."/>

//이벤트 함수
function fn_imagePreview(imagePath)
    {
        var img = document.all.imgJPG;
        
        img.src = imagePath;    


■ 마우스 드래그 선택복사금지  http://ccoma.tistory.com/235

■ 백그라운드 이미지 중간이동
       .ImageBG
{ 
background-image: url('IMAGE/공부방.png');
background-repeat: no-repeat;
background-position: center;
}


■ css 를 이용하여 바탕 테마 바꾸기
   App_Themes 폴더에 ??.css 파일 만듦 (http://www.colorzilla.com/gradient-editor/ 에서 샘프로드 받을수 있음)
   site.master 에 아래 코드 추가
     <%--바탕css--%>
    <link href="App_Themes/bt/bt.css" rel="stylesheet" type="text/css" /> 


■ 위치 비하인드코드에서 이동하기 AllSlt 는 div 아이디
             AllSlt.Style("top") = "39px"
            AllSlt.Style("left") = "-720px"

■ 이미지에 하스팟을 걸때 target="_parent" 을주면 Server.Transfer("StudyRoom.aspx") 효과를 낸다.

   <div>
        <img src="바탕.png" alt="" border="0" usemap="#Map" class="style1" />
        <map name="Map" id="Map">
        <area shape="circle" coords="448, 378, 127" href="../../StudyRoom.aspx" target="_parent" />
        </map>
    </div>


■ 공용모듈 공통함수
    http://www.devpia.com/Maeul/Contents/Detail.aspx?BoardID=7&MaeulNo=5&no=76308&ref=76306





■ 비하인드코드에서변수설정하여 소스코드로 넘기기 http://stackoverflow.com/questions/3794282/asp-net-pass-variable-from-code-behind-to-aspx

    *비하인드코드단 아래와같이 반드시 전역변수로 설정한다
     Partial Class slide_top_banner
    Inherits System.Web.UI.UserControl
    Public ImgPath As String = "IMAGE/slide_1.png"
         Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load

         End Sub
    End Class

    *소스코드단
        <li>
           <img src="<%=ImgPath%>" alt="" />
        </li>

    (배경화면 바꾸기 예제)
    

     비하인드 코드
     Public bg as string
     Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
               If Request.Cookies("PAGE") Is Nothing Then
                  TopBanner.Visible = True
                  bg = "./IMAGE/Background.png"
               Else
                  TopBanner.Visible = False
                   bg = "./IMAGE/Background1.png"
            End If
     End Sub     
          
     소스코드
     <body background="<%=bg%>">
	 
	        If Session("LTD") = "KDCUAV" Then
                bgPosition = "width: 100%;"
            Else
                bgPosition = "width: 980px; text-align: center; margin: 0px auto 0px auto;"
            End If
	   

■ 구글주소줄에서 한글깨짐 디코딩하기
Response.Write("<script language='JavaScript'>alert('" + Server.UrlDecode(Request.Url.AbsolutePath) + "')</script>")




■ 도메인주소(URL)알아오기 http://egloos.zum.com/bangley/v/5767637

(참고1 : http://www.codeproject.com/Articles/6781/URL-Demo)
Response.Write("<script language='JavaScript'>alert('" + Request.Url.Host.ToLower() + "')</script>")

(참고2 :http://warehouseofdev.tistory.com/entry/현재-URL-가져오기 )
Response.Write("<script language='JavaScript'>alert('" + Request.Url.ToString() + "')</script>")
Response.Write("<script language='JavaScript'>alert('" + Request.Url.AbsolutePath + "')</script>")

(다른내용)
//현재 URL통채로 가져오기
Request.Url.Tostring()
예)http://www.egloos.com/egloo/insert.aspx?eid=c0007408
결과>http://www.egloos.com/egloo/insert.aspx?eid=c0007408

//사이트 명만 가져오기
Request.Url.Host
예)http://www.egloos.com/egloo/insert.aspx?eid=c0007408
결과>www.egloos.com

//폴더 및 파일명 가져오기 
Request.Url.LocalPath
예)http://www.egloos.com/egloo/insert.aspx?eid=c0007408
결과>/egloo/insert.aspx

//파일명만 가져오기
System.IO.Path.GetFileName(Request.Url.LocalPath)
예)http://www.egloos.com/egloo/insert.aspx?eid=c0007408
결과>insert.aspx




■ 웹폼디자인
   마스터 페이지 있는상태에서 백그라운드 색 바꾸기



■body 설정
body 
       {
        vertical-align: middle;
        text-align: center; 
        margin-right: 0px;
	    margin-left: 0px;
	    margin-top: 0px; 
       }

■ 스타일디자인(site.css)
  body   
{
    /* background: #DDDCF3;
    background: #FFFFFF;
    background-image:url('../IMAGE/바탕_흐림.png'); /* 백그라운드에 이미지 불러옴 */
    font-size: .80em;
    font-family: "Helvetica Neue", "Lucida Grande", "Segoe UI", Arial, Helvetica, Verdana, sans-serif;
    margin: 0px;
    padding: 0px;
    color: #696969;
    text-align: center;
    font-weight: 700;*/
}
   .page
{
   width: 960px;  /*모바일용으로 만들기위해 가로길이 속성값 없앤다*/
    background-color: #fff;
    margin: 20px auto 0px auto;
    border: 0px solid #496077;  /*메인페이지속성 1px로하면 라인생김*/
}




■ nothing 와 "" 의차이

   dim A as String 이면 if isnothing(A) then
   dim A as String="" 이면 if A="" then  

■ 코드싸인
http://www.devpia.co.kr/Maeul/Contents/Detail.aspx?BoardID=17&MAEULNO=8&no=165796&ref=165796&page=-1424


■ 변수
   -'변수설정시  Dim SAVFileNAME As String = "" 하면 <>"" 하고  Dim SAVFileNAME As String 하면 Nothing 처리
   
  - 형식변경 : https://msdn.microsoft.com/ko-kr/library/s2dy91zy.aspx


■ gmail 계정으로 이메일 전송
        Dim message As New MailMessage()
        message.From = New MailAddress("ddoksorivb@gmail.com")
        message.[To].Add(New MailAddress("ddoksorivb@gmail.com"))
        message.IsBodyHtml = True
        message.Subject = "회원 가입 환영 안내"
        message.Body = "야호"
        message.SubjectEncoding = System.Text.Encoding.UTF8
        message.BodyEncoding = System.Text.Encoding.UTF8
        Dim client As New SmtpClient("smtp.gmail.com", 25)
        client.EnableSsl = True
        client.UseDefaultCredentials = False
        client.Credentials = New System.Net.NetworkCredential("ddoksorivb", "gichuln0t2")
        client.Send(message)

       에러:SMTP 서버에 보안 연결이 필요하거나 클라이언트가 인증되지 않았습니다. 서버 응답: 5.5.1 Authentication Required. Learn more at
       해결:http://www.technologycrowds.com/2015/05/smtp-server-authentication-server-response-5-5-1-Authentication-Required-in-Gmail.html
       
Move to Security Feature

Now click on Gmail Setting Feature, move to security feature or alternatively can hit/paste this URL in your browser https://www.google.com/settings/security/lesssecureapps where you can see settings. 
Access for less secure apps

Turn off (default) 
Turn On  


■ db업데이트후 바로 읽기 (cn.close 한번 cn.close한번)
 cmd = New OleDbCommand("UPDATE ORDERS SET 처리여부='읽음' , pDATE = '" + Now + "' where SEQ = " + seq + "", cn)
            cn.Open()
            cmd.ExecuteNonQuery()
            'cn.Close()


            cmd = New OleDbCommand("select * from ORDERS where SEQ = " + seq + "", cn)
            'cn.Open()
            dr = cmd.ExecuteReader(CommandBehavior.CloseConnection)
            If dr.Read() Then
                LtlASK.Text = Replace(dr("요청내용"), "p>", "div>")
            End If
            dr.Close()
            cn.Close()

■ Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        '/전송버튼 연속클릭방지 반복클릭
        ImageButton1.Attributes.Add("onclick", "this.disabled=true;" + ClientScript.GetPostBackEventReference(ImageButton1, "").ToString())


■ split 사용법 : http://ooz.co.kr/42
    Dim arrText As String() = Label2.Text.Split(New Char() {";"c})
                    For i As Integer = 0 To arrText.Length - 1
                        ' 페이지에 텍스트(이름) 출력
                        Response.Write(arrText(i) + "<br>")
                    Next
■요일구하기
    Dim cultures As System.Globalization.CultureInfo = System.Globalization.CultureInfo.CreateSpecificCulture("ko-KR")
        Dim date1 As String = DateTime.Now.ToString(String.Format("yyyy년 MM월 dd일 ddd요일", cultures))

        Response.Write("<script language = 'javascript'>alert('" + date1 + "') </script>")

■날짜차이
'방문시간 시간보다 늦으면 알림톡발송중지.. 
                
                'Dim OdrDATE As String = Convert.ToDateTime(Left(GridView1.Rows(Gidx).Cells(6).Text, 10))
                Dim OdrDATE As String = GridView1.Rows(Gidx).Cells(6).Text
                Dim NowDATE As String = DateTime.Now.ToString("yyyy-MM-dd")


                Dim T1 As DateTime = DateTime.Parse(OdrDATE)
                Dim T2 As DateTime = DateTime.Parse(NowDATE)
                Dim TS As TimeSpan = T2 - T1

                Dim diffDay As Integer = TS.Days
                If diffDay > 0 Then
                    Exit Sub
                End If

■ < date의 일주일 전 날짜 구하기 >

date.AddDays(-7).ToShortDateString();


출처: http://kmj1107.tistory.com/entry/ASPNET-일주일-전-날짜-구하기-원하는-날짜-구하기?category=291064 [토순이네집]
■날짜-차이-시간차이-분-차이-초차이-구하기 
http://holjjack.tistory.com/entry/ASPNET-날짜-차이-시간차이-분-차이-초차이-구하기

Private Sub SurroundingSub()
    Dim StartDate As DateTime = Convert.ToDateTime("2012-05-07 08:00:00")
    Dim EndDate As DateTime = Convert.ToDateTime("2012-05-10 10:20:30")
    Dim dateDiff As TimeSpan = EndDate - StartDate
    Dim diffDay As Integer = dateDiff.Days
    Dim diffHour As Integer = dateDiff.Hours
    Dim diffMinute As Integer = dateDiff.Minutes
    Dim diffSecond As Integer = dateDiff.Seconds
    Response.Write("날짜차이 : " & diffDay.ToString() & "일 <br/>")
    Response.Write("시간차이 : " & diffHour.ToString() & "시간 <br/>")
    Response.Write("분차이 : " & diffMinute.ToString() & "분 <br/>") .TotalMinutes 은 전체분
    Response.Write("초차이 : " & diffSecond.ToString() & "초 <br/>")
    Response.[End]()
End Sub

또는
https://funylife.tistory.com/entry/vb-%EC%8B%9C%EA%B0%84%EA%B0%84%EA%B2%A9-%EC%B2%B4%ED%81%AC
'Dim gap As TimeSpan = DateTime.Now - Convert.ToDateTime(dr("ORDER_TIME"))
                    'If gap.Minutes > 5 Then '자동 완료처리가 타이머가 65초마다 실행됨
                    '    cmd = New OleDbCommand("UPDATE TABLEORDER set 처리여부 = '배달완료' where ID = " + dr("ID").ToString() + "", cn)
                    '    cmd.ExecuteNonQuery()
                    'End If

■현재시간을 표시해주는 포맷
  DateTime.Now.ToString("tt h:mm") 하면 ==> 오후 12:28
  DateTime.Now.ToString("h:mm:ss tt") 하면 ==> 12:27:34 오후

■ 

Dim tStart As Long = Now.Ticks
        '' Do processing
        Dim tEnd As Long = Now.Ticks
        Dim tTaken As String = "Time taken " + TimeSpan.FromTicks(tEnd - tStart).TotalSeconds.ToString()
        timerLabel.Text = tTaken 'timerLabel.Text + 1

■ 날짜원하는데로표현가능 - 잘응용할것
http://sixthgo.tistory.com/entry/aspNet-%EB%82%A0%EC%A7%9C%EC%8B%9C%EA%B0%84-%EB%8D%B0%EC%9D%B4%ED%84%B0%ED%98%95DateTime


■ 표시 포맷
int hours, minute, second;
            //시간공식
            hours = num / 3600;//시 공식
            minute = num % 3600 / 60;//분을 구하기위해서 입력되고 남은값에서 또 60을 나눈다.
            second = num % 3600 % 60;//마지막 남은 시간에서 분을 뺀 나머지 시간을 초로 계산함
 
■ 날짜시간관련 : 
    년월 DateTime.Now.ToString("yyyyMM")
	시간 TimeOfDay  짧은시간 TimeOfDay.ToShortTimeString
	http://egloos.zum.com/silganok/v/1697151 ===> 내맘대로 포맷변경
    http://www.underroom.com/409
    http://taeyo.net/Columns/View.aspx?SEQ=78&PSEQ=8&IDX=0

   - 년월일(요일) 표시 :   Label1.Text = DateTime.Now.ToString("yyyy년 MM월 dd일 (dddd)")

   - 10분후 구하기 http://cocoaday.tistory.com/165
        가. 설명
		DateAdd() : 필수. 문자열 식을 사용하여 시간 간격을 출력한다.
 
		나. 사용법
		DateAdd(Interval, Number, Date)
		구성요소	필수/선택	값	설명
		Interval	필수요소	yyyy	연도
		w	요일
		q	분기
		ww	주
		m	월
		h	시간
		y	일자
		n	분
		d	일
		s	초
		Number	필수요소	숫자	양수(이후 시간을 계산하는 경우)
		음수(이전 시간을 계산하는 경우)
		Date	필수요소	날짜	

		다. 예제
		now() : 2011-07-22 오후 4:25:26
		예문	결과값	설명
		DateAdd("yyyy",10,now())	2021-07-22 오후 4:25:26	10년 후
		DateAdd("w",10,now())	2011-08-01 오후 4:25:26	10일 후
		DateAdd("q",10,now())	2014-01-22 오후 4:25:26	10분기 후
		DateAdd("ww",10,now())	2011-09-30 오후 4:25:26	10주일 후
		DateAdd("m",10,now())	2012-05-22 오후 4:25:26	10개월 후
		DateAdd("h",10,now())	2011-07-23 오전 2:25:26	10시간 후
		DateAdd("y",10,now())	2011-08-01 오후 4:25:26	10일 후
		DateAdd("n",10,now())	2011-07-22 오후 4:35:26	10분 후
		DateAdd("d",10,now())	2011-08-01 오후 4:25:26	10일 후
		DateAdd("s",10,now())	2011-07-22 오후 4:25:36	10초 후  
 
■ 날짜시간포맷 바꾸기 https://stackoverflow.com/questions/3025361/c-sharp-datetime-to-yyyymmddhhmmss-format
// create date time 2008-03-09 16:05:07.123
DateTime dt = new DateTime(2008, 3, 9, 16, 5, 7, 123);

String.Format("{0:y yy yyy yyyy}",      dt);  // "8 08 008 2008"   year
String.Format("{0:M MM MMM MMMM}",      dt);  // "3 03 Mar March"  month
String.Format("{0:d dd ddd dddd}",      dt);  // "9 09 Sun Sunday" day
String.Format("{0:h hh H HH}",          dt);  // "4 04 16 16"      hour 12/24
String.Format("{0:m mm}",               dt);  // "5 05"            minute
String.Format("{0:s ss}",               dt);  // "7 07"            second
String.Format("{0:f ff fff ffff}",      dt);  // "1 12 123 1230"   sec.fraction
String.Format("{0:F FF FFF FFFF}",      dt);  // "1 12 123 123"    without zeroes
String.Format("{0:t tt}",               dt);  // "P PM"            A.M. or P.M.
String.Format("{0:z zz zzz}",           dt);  // "-6 -06 -06:00"   time zone

// month/day numbers without/with leading zeroes
String.Format("{0:M/d/yyyy}",           dt);  // "3/9/2008"
String.Format("{0:MM/dd/yyyy}",         dt);  // "03/09/2008"

// day/month names
String.Format("{0:ddd, MMM d, yyyy}",   dt);  // "Sun, Mar 9, 2008"
String.Format("{0:dddd, MMMM d, yyyy}", dt);  // "Sunday, March 9, 2008"

// two/four digit year
String.Format("{0:MM/dd/yy}",           dt);  // "03/09/08"
String.Format("{0:MM/dd/yyyy}",         dt);  // "03/09/2008"
Standard DateTime Formatting

String.Format("{0:t}", dt);  // "4:05 PM"                           ShortTime
String.Format("{0:d}", dt);  // "3/9/2008"                          ShortDate
String.Format("{0:T}", dt);  // "4:05:07 PM"                        LongTime
String.Format("{0:D}", dt);  // "Sunday, March 09, 2008"            LongDate
String.Format("{0:f}", dt);  // "Sunday, March 09, 2008 4:05 PM"    LongDate+ShortTime
String.Format("{0:F}", dt);  // "Sunday, March 09, 2008 4:05:07 PM" FullDateTime
String.Format("{0:g}", dt);  // "3/9/2008 4:05 PM"                  ShortDate+ShortTime
String.Format("{0:G}", dt);  // "3/9/2008 4:05:07 PM"               ShortDate+LongTime
String.Format("{0:m}", dt);  // "March 09"                          MonthDay
String.Format("{0:y}", dt);  // "March, 2008"                       YearMonth
String.Format("{0:r}", dt);  // "Sun, 09 Mar 2008 16:05:07 GMT"     RFC1123
String.Format("{0:s}", dt);  // "2008-03-09T16:05:07"               SortableDateTime
String.Format("{0:u}", dt);  // "2008-03-09 16:05:07Z"              UniversalSortableDateTime

/*
Specifier   DateTimeFormatInfo property     Pattern value (for en-US culture)
    t           ShortTimePattern                    h:mm tt
    d           ShortDatePattern                    M/d/yyyy
    T           LongTimePattern                     h:mm:ss tt
    D           LongDatePattern                     dddd, MMMM dd, yyyy
    f           (combination of D and t)            dddd, MMMM dd, yyyy h:mm tt
    F           FullDateTimePattern                 dddd, MMMM dd, yyyy h:mm:ss tt
    g           (combination of d and t)            M/d/yyyy h:mm tt
    G           (combination of d and T)            M/d/yyyy h:mm:ss tt
    m, M        MonthDayPattern                     MMMM dd
    y, Y        YearMonthPattern                    MMMM, yyyy
    r, R        RFC1123Pattern                      ddd, dd MMM yyyy HH':'mm':'ss 'GMT' (*)
    s           SortableDateTi­mePattern             yyyy'-'MM'-'dd'T'HH':'mm':'ss (*)
    u           UniversalSorta­bleDateTimePat­tern    yyyy'-'MM'-'dd HH':'mm':'ss'Z' (*)
                                                    (*) = culture independent   
*/
Update using c# 6 string interpolation format

// create date time 2008-03-09 16:05:07.123
DateTime dt = new DateTime(2008, 3, 9, 16, 5, 7, 123);

$"{dt:y yy yyy yyyy}";  // "8 08 008 2008"   year
$"{dt:M MM MMM MMMM}";  // "3 03 Mar March"  month
$"{dt:d dd ddd dddd}";  // "9 09 Sun Sunday" day
$"{dt:h hh H HH}";      // "4 04 16 16"      hour 12/24
$"{dt:m mm}";           // "5 05"            minute
$"{dt:s ss}";           // "7 07"            second
$"{dt:f ff fff ffff}";  // "1 12 123 1230"   sec.fraction
$"{dt:F FF FFF FFFF}";  // "1 12 123 123"    without zeroes
$"{dt:t tt}";           // "P PM"            A.M. or P.M.
$"{dt:z zz zzz}";       // "-6 -06 -06:00"   time zone

// month/day numbers without/with leading zeroes
$"{dt:M/d/yyyy}";    // "3/9/2008"
$"{dt:MM/dd/yyyy}";  // "03/09/2008"

// day/month names
$"{dt:ddd, MMM d, yyyy}";    // "Sun, Mar 9, 2008"
$"{dt:dddd, MMMM d, yyyy}";  // "Sunday, March 9, 2008"

// two/four digit year
$"{dt:MM/dd/yy}";    // "03/09/08"
$"{dt:MM/dd/yyyy}";  // "03/09/2008"


■ 글자 이미지에 링크(Link) 걸기
    Dim ImgInsertCoding As String = "<div>파일첨부:" + Replace(SAVFileNAME.Trim, " ", "") + "<a href=" + ImgPath + " ><img src =" + iconeExcel + "></a></div>"
 
■ 비하인드코드(Bhidecode) 안에서 태그사용
  
    줄바꿈 LblPEmail.Text = "보호자 <br/> 이메일" 
      
    한줄띄기 :  
    라인긋기 : TxtDetailODR.Text = TxtDetailODR.Text + "<hr/>" + ImgInsertCoding


■  Treeview (트리뷰)

     선택한 노드 간단하게 찿아 링크걸기 : TreeView1.SelectedNode.NavigateUrl = "Click_EDUMOD.aspx?value=두뇌로/" & TreeView1.SelectedNode.ValuePath()

     * 바로가게 하기
        Protected Sub TreeView1_SelectedNodeChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles TreeView1.SelectedNodeChanged
        Server.Transfer("Click_EDUMOD.aspx?value=두뇌로/" & TreeView1.SelectedNode.ValuePath())
    End Sub


     처음표시될때 색 유지 시키려면 부모노드 selection 속성을 none ?
     - 노드 안보이게 감춤 : Treeview.Nodes.RemoveAt(0)

     Treeview1.ExpandAll() '트리뷰전부펼침
     TVcnt = Treeview1.Nodes.Count '트리뷰노드갯수
     TreeView1.Nodes(0).ChildNodes(0).ChildNodes.Count '자식노드갯수
     Treeview1.Nodes(0).Text
     
            For i = (TVcnt - 1) To 0 Step -1 '트리뷰총노드갯수부터하나씩줄여가면서비교 (TVcnt 가 총 5일경우 4,3,2,1 순)
                If Treeview1.Nodes(i).Value <> s Then '맨아래 root 노드 제목부터 비교
                    Treeview1.Nodes.RemoveAt(i) '노드삭제
                End If
            Next i

      Treeview1.Nodes(i).Value 'root 노드값
      TreeView1.Nodes(i).ChildNodes(0).Value '첫번째 자식노드값
      TreeView1.Nodes(i).ChildNodes(1).Value '두번째 자식노드값
      TreeView1.Nodes(i).ChildNodes(0).ChildNodes(0).Value '첫번째 자식의 첫번째노드값

- 노드사이의 세로간격
   ParentNodeStyle - NodeSpacing (부모노드의 세로간격)

 If TreeView1.SelectedValue = "영업시간설정 바로가기" Then
            TreeView1.SelectedNode.NavigateUrl = "../Default.aspx?HelpLTD=GoSaleTime&GETJUMUN=" & LblLTD.Text
        ElseIf TreeView1.SelectedValue = "영업시간설정 바로가기" Then

        End If
    
■ dropdownlist (드롭다운리스트)

      드롭다운리스트(dropdownlist)에 아이템 추가 (http://forums.asp.net/t/1287909.aspx)
       DDL_PAGE.Items.Clear()
       
         (예1) DDLSearch.Items.Add(New ListItem("text", "value", True))
       
        (예2)
        DDL_PAGE.Items.Add(New ListItem(LblBOOK.Text + "_1", LblBOOK.Text + "_1"))
        DDL_PAGE.Items.Add(New ListItem(LblBOOK.Text + "_2", LblBOOK.Text + "_2"))
        DDL_PAGE.Items.Add(New ListItem(LblBOOK.Text + "_3", LblBOOK.Text + "_3"))

        -삭제 
        DDLSltPhone.Items.RemoveAt (1)
		myDropDown.Items.Remove(myDropDown.Items.FindByValue("TextToFind"))

       -삽입
          DDLSltPhone.Items.Insert(1, New ListItem("-", "lind"))
        *이미지로삽입
		  RdoBtnLstRSV.Items.Insert(1, New ListItem("<img src='./IMAGE/C_BtnPKG_OFF.png'/>", "<img src='./IMAGE/C_BtnPKG_OFF.png'/>"))

       -리네임
         DDLSltPhone.Items(1).Text = "소스수집" 

       -이름으로선택   
	    RdoBtnLstMsg.Items.FindByValue("직접입력").Selected = True



■ 드롭다운리스트에 내용미리표시 
  https://stackoverflow.com/questions/18025414/how-to-auto-select-a-item-from-dropdownlist-when-page-is-loaded

 
 ■ 드롭다운리스트
    1. 데이타 바인딩 후  항목추가방법
            DDL_MEMBER.DataSourceID = "ADS_MEMBER"
            DDL_MEMBER.DataTextField = "이름"
            ' DDL_MEMBER.Items.Insert(0, "선택")'asp.net 1.0일때
            DDL_MEMBER.Items.Add("이름선택") '반드시 AppendDataBoundItems = 'true'



■ 네비게이션메뉴(메뉴 menu)
    
	-다양한디자인 http://demos.telerik.com/aspnet-ajax/menu/examples/mobile-and-touch-support/adaptive-behavior/defaultvb.aspx
    - url 미리 거는방법
	Protected Sub Menu1_Load(sender As Object, e As System.EventArgs) Handles Menu1.Load
        Menu1.Items(4).ChildItems(0).NavigateUrl = ("IMAGE/" + Session("LTD") + "/" + Menu1.Items(4).ChildItems(0).Value + ".aspx")
    End Sub


    - 인덱스로 아이템선택: NavigationMenu.Items(x)
       예) NavigationMenu.Items(1).ImageUrl = "~/GONGBUBANG/IMAGE/메뉴탭/사원전용자료.png"
    - 벨류값으로 선택
        If NavigationMenu.SelectedItem.Parent.Parent.Value = "추천학습" Then

    -간격넓히기 : IncludeStyleBlock="false"  하면간격은넓어지지만 backcolor 속성이 사라져 주위간격이생김
	              폰트싸이즈 키워주면 간격 넓어짐 (이미지 사용할때 적절) 
    -backcolor 를 주면 주위간격이사라짐
    -메뉴클릭
        Sub NavigationMenu_MenuItemClick(ByVal sender As Object, ByVal e As MenuEventArgs)
       ' Display the text of the menu item selected by the user.
         Message.Text = "You selected " & _
         e.Item.Text & "."

         또는 e.item.value 
        End Sub
    
       root 에 MenuItemClick 적용하려면 디자인모드에서 Delete the NavigateUrl="~/Default.aspx" 할것

    
    - 경로값 : NavigationMenu.SelectedItem.ValuePath.ToString
    - 메뉴추가하거나 삭제하기
       A. Remove items:
           Menu1.Items.RemoveAt(1) 인덱스로삭제
           Menu1.Items.Remove(Menu1.FindItem("Jobs")) 벨류값으로찿아서삭제

           Menu1.Items(3).ChildItems.RemoveAt(1) 칠드를 이용해서 삭제

       B. Add Items:

          Menu1.Items.Add(new MenuItem("News"))

          OR use this to specify the required properties for the new added item:

          MenuItem item = new MenuItem()

          item.NavigateUrl =""

          item.Text = "Child Test"

          Menu1.Items.Add(mnuTestChild)
  
    - 아이템 추가
        Menu2.Items.Add(New MenuItem("Text", "Value"))
 
        Menu1.Items(0).ChildItems.Add(item)
    
    - 리네임
       Menu1.Items(3).ChildItems.Item(2).Text = "소스추가"
  
    - 가운데위치 ★
      <div style="border: 1px solid #CC6600; margin: 0 auto 0 auto; width: 80%;" align="center"> 
     <img src="https://movie-phinf.pstatic.net/20190417_250/1555465284425i6WQE_JPEG/movie_image.jpg" 
            width="200"/>
      </div>



■ SMS란 Short Message Service(단문 메시지 서비스)의 약자로 휴대폰으로 전1234567890  



■ 

■ 한글영문 바이트 가져오기
    
Public Function ConvertEllipsisString(strDest As String, nMaxLength As Integer) As String
	Dim strConvert As String
	Dim nLength As Integer, n2ByteCharCount As Integer
	Dim arrayByte As Byte() = System.Text.Encoding.[Default].GetBytes(strDest)
	nLength = System.Text.Encoding.[Default].GetByteCount(strDest)
	If nLength > nMaxLength Then
		' 글 제목이 너무 길 경우... 
		n2ByteCharCount = 0
		For i As Integer = 0 To nMaxLength - 1
			If arrayByte(i) >= 128 Then
				' 2바이트 문자 판별 
				n2ByteCharCount += 1
			End If
		Next
		strConvert = strDest.Substring(0, nMaxLength - (n2ByteCharCount / 2)) + "..."
	Else
		strConvert = strDest
	End If
	Return strConvert
End Function

'=======================================================
'Service provided by Telerik (www.telerik.com)
'Conversion powered by NRefactory.
'Twitter: @telerik
'Facebook: facebook.com/telerik
'=======================================================



■ 텍스트박스(textbox)
   -배경색투명 :  BackColor="Transparent" 
   - 입력박스 가운데위치
   <asp:TextBox ID="myTextBox" runat="server" style="text-align: center"></asp:TextBox>


■ 한글영문 바꾸기 http://notgivuphil.tistory.com/454
 
■ 한글인코딩디코딩
    -asp.net
    send : Server.UrlEncode()
    receive : Server.UrlDecode() 
    -javascript
    send : encodeURIComponent()
    receive : decodeURIComponent()
 
■ CSS
    디자인 뷰 보려면 좌측 css개요 -> 요소 -> body -> 스타일작성
   적용하려면 페이지에 끌어다놓으면된다. 이때 반드시 로컬경로를 상대경로 로 수정해줘야된다. 

■ [중요]그리드뷰에서 컬럼 내용을 사용하면서 감추기
https://stackoverflow.com/questions/6416244/hide-column-in-gridview
   
 
.style3
{
 Display:none   
}

Then place the following before the end 'BoundField' tag for each of the columns that you want make invisible:

<HeaderStyle CssClass="style3"></HeaderStyle>
<ItemStyle CssClass="style3"></ItemStyle>
appear just as if you had specified 'Visible=False" but it will be accessible to your code. Bear in mind however that it will appear if you 'view source' from the browser, so don't use this technique if the hidden data is sensitive.

■ ASP.NET GridView 데이터 바인딩을 사용한 동적 합성 이미지
   https://www.neodynamic.com/ND/FaqsTipsTricks.aspx?tabid=66&prodid=0&sid=45

■ 그리드뷰  
   내가 필드 정의하려면 열편집에서 필드자동생성 체크 없앰

■ 데이터 테이블 만들기 (http://blog.daum.net/_blog/BlogTypeView.do?blogid=0C9F6&articleno=16869882)

Dim dt As New DataTable()
            dt.Columns.Add(New DataColumn("num", GetType(Integer)))
            dt.Columns.Add(New DataColumn("name", GetType(String)))
            For i As Integer = 0 To temp.Length - 1
                Dim dr As DataRow = dt.NewRow()
                dr("num") = i + 1
                dr("name") = temp(i)
                dt.Rows.Add(dr)
            Next
■ 그리드뷰 디비없이 그리드뷰만들고 삭제하기 (잘됨 : 유용한예제에 있음) https://www.aspsnippets.com/Articles/Delete-row-from-GridView-without-using-database-in-ASPNet.aspx
Imports System.Data
Imports System.Linq
Partial Class VB
    Inherits System.Web.UI.Page
    Protected Sub Page_Load(sender As Object, e As EventArgs) Handles Me.Load
        If Not Page.IsPostBack Then
            Dim dt As New DataTable()
            dt.Columns.AddRange(New DataColumn(1) {New DataColumn("Item"), New DataColumn("Price")})
            dt.Rows.Add("Shirt", 450)
            dt.Rows.Add("Jeans", 3200)
            dt.Rows.Add("Trousers", 1900)
            dt.Rows.Add("Tie", 185)
            dt.Rows.Add("Cap", 100)
            dt.Rows.Add("Hat", 120)
            dt.Rows.Add("Scarf", 290)
            dt.Rows.Add("Belt", 150)
            ViewState("dt") = dt
            BindGrid()
        End If
    End Sub
    Protected Sub BindGrid()
        GridView1.DataSource = TryCast(ViewState("dt"), DataTable)
        GridView1.DataBind()
    End Sub
    Protected Sub OnRowDeleting(sender As Object, e As GridViewDeleteEventArgs)
        Dim index As Integer = Convert.ToInt32(e.RowIndex)
        Dim dt As DataTable = TryCast(ViewState("dt"), DataTable)
        dt.Rows(index).Delete()
        ViewState("dt") = dt
        BindGrid()
    End Sub
    Protected Sub OnRowDataBound(sender As Object, e As GridViewRowEventArgs)
        If e.Row.RowType = DataControlRowType.DataRow Then
            Dim item As String = e.Row.Cells(0).Text
            For Each button As Button In e.Row.Cells(2).Controls.OfType(Of Button)()
                If button.CommandName = "Delete" Then
                    button.Attributes("onclick") = "if(!confirm('Do you want to delete " + item + "?')){ return false; };"
                End If
            Next
        End If
    End Sub

End Class


■ 그리드내부에서 confirm 받기
   Protected Sub GrdOdrList_RowDataBound(sender As Object, e As System.Web.UI.WebControls.GridViewRowEventArgs) Handles GrdOdrList.RowDataBound
        If e.Row.RowType = DataControlRowType.DataRow Then
            Dim l As LinkButton = DirectCast(e.Row.FindControl("LinkButton1"), LinkButton)
            l.Attributes.Add("onclick", "javascript:return " + "confirm('Are you sure you want to delete this record " + DataBinder.Eval(e.Row.DataItem, "ID") + "')")
        End If
    End Sub
    Protected Sub GrdOdrList_RowCommand(sender As Object, e As System.Web.UI.WebControls.GridViewCommandEventArgs) Handles GrdOdrList.RowCommand
        If e.CommandName = "Delete" Then
            ' get the categoryID of the clicked row
            Dim categoryID As Integer = Convert.ToInt32(e.CommandArgument)
            ' Delete the record 
            ' Implement this on your own :) 
        End If
    End Sub

■ 그리드뷰-마우스올리면 색 바꾸기
'그리드 뷰의 마우스 오버시 색 바꾸기
Protected Sub AllItemGridView_RowDataBound(sender As Object, e As GridViewRowEventArgs)
	'Row가 DateRow일때만 적용하기 위해서    
	If e.Row.RowType = DataControlRowType.DataRow Then
		'마우스 오버시에 변할 색
		e.Row.Attributes("onMouseOver") = "this.style.backgroundColor='#ffecf0';"
		'Alternate와 Row의 색을 다르게 주었기 때문에
		If e.Row.RowState.ToString() = "Alternate" Then
			'마우스 아웃시에는 다시 원래색으로 바꾸어 주기 위해서
			e.Row.Attributes("onMouseOut") = "this.style.backgroundColor='#E6E6E6';"
		Else
			'AlternateRow가 아닌경우에는 원래색으로
			' Row의 색을 입력한다.
			e.Row.Attributes("onMouseOut") = "this.style.backgroundColor='';"
		End If
	End If
End Sub

'=======================================================
'Service provided by Telerik (www.telerik.com)
'Conversion powered by NRefactory.
'Twitter: @telerik
'Facebook: facebook.com/telerik
'=======================================================



■ 그리드뷰 - 행추가
Private Sub SetInitialRow()
        Dim dt As New DataTable()
        Dim dr As DataRow = Nothing
        dt.Columns.Add(New DataColumn("RowNumber", GetType(String)))
        dt.Columns.Add(New DataColumn("Column1", GetType(String)))
        dt.Columns.Add(New DataColumn("Column2", GetType(String)))
        dt.Columns.Add(New DataColumn("Column3", GetType(String)))
        dr = dt.NewRow()
        dr("RowNumber") = 1
        dr("Column1") = String.Empty
        dr("Column2") = String.Empty
        dr("Column3") = String.Empty
        dt.Rows.Add(dr)
        'dr = dt.NewRow();

        'Store the DataTable in ViewState
        ViewState("CurrentTable") = dt

        Gridview1.DataSource = dt
        Gridview1.DataBind()
    End Sub

■ 그리드뷰(gridview)에 컴보박스 넣기
http://www.aspsnippets.com/Articles/How-to-populate-DropDownList-in-GridView-in-ASPNet.aspx

■ 그리드뷰에 넣은 컴보박스 이벤트 발생 시키려면 (확인불가)
     Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
      
        Me.BindCountryList(DDLSltMem1)
    end sub

    Private Sub BindCountryList(ByVal DDLSltMem1 As DropDownList)
      ....여기에 적용 코드 넣을것...
    End Sub

    *또다른방법 http://forums.asp.net/t/1049639.aspx


Protected Sub btnGo_Click(sender As Object, e As EventArgs)
	' Retrieve header
	Dim header As GridViewRow = gv.HeaderRow

	' Retrieve control
	Dim ddlYears As DropDownList = TryCast(header.FindControl("ddlYears"), DropDownList)

	If ddlYears IsNot Nothing Then
		' Retrieve value
		Dim selectedYear As String = ddlYears.SelectedValue
	End If
End Sub





■ 그리드뷰(gridview) 

  - 캡션(caption)넣기
     <asp:GridView ID="GridView1" runat="server" AllowPaging="True" 
            AutoGenerateColumns="False" CellPadding="4" ForeColor="#333333" 
            Width="100%" HorizontalAlign="Center" 
            caption='<table align="center" class="style1">
        <tr>
            <td style="text-align: center">
                빈방조회하기</td>
        </tr>
    </table> <br />' 

  - 3번째 필드값(데이타값) 바꾸기
    Dim field As BoundField = DirectCast(Me.GridView1.Columns(3), BoundField)
            field.DataField = "등록사원"
----------------------------------
            field.SortExpression = "등록사원"
            field.HeaderText ="등록사원"
   
   - 컬럼안보이게 
      AutoGenerateColumns="False" 

   - 특정열 감추기
      GridView2.Columns(7).Visible = False

	  GridView1.Columns(1).ItemStyle.CssClass = "Style_non"

   - 헤더 텍스트 바꾸기
     Me.GridView1.Columns(3).HeaderText = "사번"

   - 싸이즈 바꾸기
       BridView1.ControlStyle.Font.Size = 9;
	   http://stackoverflow.com/questions/6650383/how-to-edit-a-gridview-column-font-from-code-behind
   -넓이바꾸기
     GridView1.Columns(9).ItemStyle.Width = 50
   - 체크박스 적용
   <Columns>
       <asp:TemplateField>
            <ItemTemplate>
              <asp:CheckBox ID="ChkGrd" runat="server" />
            </ItemTemplate>
       </asp:TemplateField>                 
   </Columns>

   *autopostback=false 하면 아래 chkRow.Checked를 인식하지 못함

   코드쪽에:
  Dim data As String = ""
            For Each row As GridViewRow In GridView1.Rows
                If row.RowType = DataControlRowType.DataRow Then
                    Dim chkRow As CheckBox = TryCast(row.Cells(0).FindControl("ChkGrd"), CheckBox)
                    If chkRow.Checked Then
                        Dim storid As String = row.Cells(1).Text
                        Dim storname As String = row.Cells(2).Text
                        Dim state As String = row.Cells(3).Text
                        data = (Convert.ToString((Convert.ToString((data & storid) + " ,  ") & storname) + " , ") & state) + "<br>"
                    End If
                End If
            Next
            lblmsg.Text = data


   * 그리드 헤더와 리스트에 체크박스 적용(현재 워크보드에 적용중)
     - 소스부분에
                        <asp:TemplateField>
                             <headertemplate>
		                        <asp:CheckBox id="ChkAll" runat="server" 
                                     oncheckedchanged="ChkAll_CheckedChanged" AutoPostBack="True" />
	                        </headertemplate>

                             <ItemTemplate>
                                 <asp:CheckBox ID="ChkEa" runat="server" />
                             </ItemTemplate>
	                      
                            <ItemStyle Width="20px" />
                        </asp:TemplateField>

       -코드부분에..
      Protected Sub ChkAll_CheckedChanged(ByVal sender As Object, ByVal e As System.EventArgs)
        Dim chk As CheckBox = DirectCast(GridView1.HeaderRow.FindControl("ChkAll"), CheckBox)
        If chk.Checked Then
            ToggleCheckState(True)
        Else
            ToggleCheckState(False)
        End If


    End Sub

    Private Sub ToggleCheckState(ByVal checkState As Boolean)
        ' Iterate through the Products.Rows property
        For Each row As GridViewRow In GridView1.Rows
            ' Access the CheckBox
            Dim cb As CheckBox = DirectCast(row.FindControl("ChkEa"), CheckBox)
            If cb IsNot Nothing Then
                cb.Checked = checkState
            End If
        Next
    End Sub

■그리드뷰 그룹화(group)
https://www.aspsnippets.com/Articles/ASPNet-GridView-Group-Header-Row-Columns-and-display-Multiple-Columns-under-Single-Column.aspx

■그리드뷰	인덱스 맨마지막 페이지 으로 이동
	Protected Sub GridView1_DataBound(ByVal sender As Object, ByVal e As System.EventArgs) Handles GridView1.DataBound
        Me.GridView1.PageIndex = (Me.GridView1.PageCount - 1)
    End Sub

■그리드뷰에 콤보박스 넣으려면~(잘됨)
<asp:TemplateField HeaderText="처리여부">
    '데인타 바인딩 부분-------
	<ItemTemplate>
        <asp:Label ID="Label1" runat="server" Text='<%# Bind("처리여부") %>'></asp:Label>
    </ItemTemplate>
	'------------------------
	'콤보박스 입력부분--------------
	<asp:DropDownList ID="DDL_HDR_PRS" runat="server" 
        style="color: #FFFFFF; font-weight: 700; background-color: #5A799C" 
        AutoPostBack="True" 
        onselectedindexchanged="DDL_HDR_PRS_SelectedIndexChanged">
        <asp:ListItem>전체</asp:ListItem>
        <asp:ListItem Value="대기중">안읽음</asp:ListItem>
        <asp:ListItem Value="읽음">읽음</asp:ListItem>
        <asp:ListItem>읽음(H)</asp:ListItem>
        <asp:ListItem>읽음(M)</asp:ListItem>
    </asp:DropDownList>
	'--------------------------------------------------------
</asp:TemplateField>
 
 [비하인드코드 콤보박스 이벤트 발생 시키는 부분]
  '그리드뷰의 종류별찿기 이벤트발생
    Protected Sub DDL_HDR_PRS_SelectedIndexChanged(ByVal sender As Object, ByVal e As System.EventArgs)
        Dim ddl As DropDownList = DirectCast(GridView1.HeaderRow.FindControl("DDL_HDR_PRS"), DropDownList)

        Dim GUBUN As String = ddl.SelectedItem.Value.ToString
        Adap = New OleDbDataAdapter("SELECT * FROM [ORDERS] where (담당사원사번 = '" + Session("USERID") + "') and (처리여부 = '" + GUBUN + "') order by SEQ desc", cn)

        ds = New DataSet()
        Adap.Fill(ds, "ORDERS")
        GridView1.DataSource = ds 'ds.Tables("ORDERS")
        GridView1.DataBind()

        CngColor() '긴급칼라바꾸기
    End Sub 

■그리드뷰에 종류별 아이콘 넣기
    -소스코드-
    <ItemTemplate>
        <asp:Label ID="Label2" runat="server" Text='<%# ValidateString1(Eval("구분")) %>'></asp:Label>
    </ItemTemplate>
	-비하인드코드-
	Protected Function ValidateString1(ByVal Emergency As Object) As String '필드가공하여짤게표시
        'Pass values as object since they may be DBNull
        If Session("UsePlace") = "기업용" Then
            If (Emergency = "긴급") Then
                Return "<img src='../IMAGE/긴급.gif'>" '<br/>" '+ StrSAU
            Else
                Return ""
            End If
        Else
            If (Emergency = "메시지") Then
                Return "<img src='../IMAGE/그리드표시_메시지.gif'>" '<br/>" '+ StrSAU
                'Return StrSAU.ToString.Substring(0, 3) + " ..."
            ElseIf (Emergency = "학습일지") Then
                Return "<img src='../IMAGE/그리드표시_학습일지.gif'>"
            ElseIf (Emergency = "출결") Then
                Return "<img src='../IMAGE/그리드표시_출결.gif'>"
            ElseIf (Emergency = "고지서") Then
                Return "<img src='../IMAGE/그리드표시_고지서.gif'>"
            ElseIf (Emergency = "선생님께질문") Then
                Return "<img src='../IMAGE/그리드표시_선생님께질문.gif'>"
            ElseIf (Emergency = "과제제출") Then
                Return "<img src='../IMAGE/그리드표시_과제출제.gif'>"
            ElseIf (Emergency = "질문답변") Then
                Return "<img src='../IMAGE/그리드표시_질문답변.gif'>"
            ElseIf (Emergency = "과제출제") Then
                Return "<img src='../IMAGE/그리드표시_과제출제.gif'>"
            Else
                Return ""
            End If
        End If
    End Function
■ 그리드뷰 종류:  csharpdotnetfreak.blogspot.com/2011/04/gridview-examples-in-aspnet-20-35.html
 
■ 그리드뷰에 css적용방법
css 파일을 테마폴더나 css 폴더에 넣고 내용을 알맞게 바꿔준다    
site.master 에   <link href="App_Themes/Grid/Gridstyle.css" rel="stylesheet" type="text/css" /> 를 추가
그리드뷰에 속성에 css에 gridview2 가 나타난다.
    
■ 그리드뷰에 체크박스 추가시 체크확인
   For j As Integer = 0 To GrdVwAddMnu.Rows.Count - 1
            Dim isChecked As Boolean = (CType(GrdVwAddMnu.Rows(j).FindControl("ChkAddMnu"), CheckBox)).Checked

            If isChecked Then
                dt.Rows.Add(j, GrdVwAddMnu.Rows(j).Cells(1).Text, DDLQty.Text, GrdVwAddMnu.Rows(j).Cells(2).Text, (DDLQty.Text * GrdVwAddMnu.Rows(j).Cells(2).Text))
                TotalPie = TotalPie + (DDLQty.Text * GrdVwAddMnu.Rows(j).Cells(2).Text)
            End If
        Next
 
■ 그리드뷰 이미지 크기 일정하게 유지시키기 ControlStyle-Width="50" ControlStyle-Height="50"

■ 그리드뷰 행(row)클릭시 선택 : http://www.aspsnippets.com/Articles/Add-Row-Click-event-to-GridView-Rows-in-ASPNet.aspx
  Protected Sub GridView1_RowDataBound(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewRowEventArgs) Handles GridView1.RowDataBound
        If e.Row.RowType = DataControlRowType.DataRow Then
            e.Row.Attributes("onclick") = Page.ClientScript.GetPostBackClientHyperlink(GridView1, "Select$" & e.Row.RowIndex)
            e.Row.Attributes("style") = "cursor:pointer"
        End If
    End Sub

   (* 그리드에 select 추가안해주면 Invalid postback or callback argument.  Event validation is enabled using <pages enableEventValidation="true"/> in configuration or <%@ Page EnableEventValidation="true" %> in a page.  For security purposes, this feature verifies that arguments to postback or callback events originate from the server control that originally rendered them.  If the data is valid and expected, use the ClientScriptManager.RegisterForEventValidation method in order to register the postback or callback data for validation.
에러가 난다. 
이때는 페이지에 EnableEventValidation="false" 또는 web.config 에 <pages enableEventValidation="false"/> 를 추가 

   [중요] 연속해서 리스트선택이 안되면  <asp:LinkButton ID="lnkDummy" runat="server" Visible="False"></asp:LinkButton> 를 추가해준다.


   * 아무반응 없는에러도 EnableEventValidation="false" 추가

   Protected Sub GridView1_SelectedIndexChanged(sender As Object, e As System.EventArgs) Handles GridView1.SelectedIndexChanged
        'Response.Write("<script language = 'javascript'>alert('포장이나 배달일경우 사용 할 수 있는 버튼입니다.')</script>")
        'GridView1.CssClass = "Style_non"
        ''GridView4.CssClass = "Style_non"
        'DataList1.CssClass = ""

        Dim index As Integer = GridView1.SelectedRow.RowIndex
        Dim name As String = GridView1.SelectedRow.Cells(0).Text
        Dim country As String = GridView1.SelectedRow.Cells(1).Text
        Dim message As String = "Row Index: " & index & "\nName: " & name + "\nCountry: " & country
        ClientScript.RegisterStartupScript(Me.[GetType](), "alert", "alert('" + message + "');", True)
    End Sub

■ 그리드색바꾸기
    '===== 긴급 빨간색으로 표시====
        Dim i As Byte
        For i = 0 To GridView1.Rows.Count - 1
            If GridView1.Rows(i).Cells(5).Text = "긴급" Then
                GridView1.Rows(i).Cells(5).ForeColor = Drawing.Color.Crimson '참조(그리드라인색바꿈
                GridView1.Rows(i).Cells(5).Font.Bold = True
            ElseIf GridView1.Rows(i).Cells(4).Text = "처리완료" Then
                GridView1.Rows(i).Cells(4).ForeColor = Drawing.Color.Crimson '참조(그리드라인색바꿈
            End If
        Next i
        '=============================

■ 그리드를 이용한 레코드 찿기
Dim i As Byte
        For i = 0 To GridView2.Rows.Count - 1
            If GridView2.Rows(i).Cells(5).Text = Replace(TxtBoxMenu.Text.Trim(), " ", "") Then
                Response.Write("<script language = 'javascript'>alert('이미 저장되어있는 메뉴 입니다..')</script>")
                Exit Sub
            End If
        Next i
        Exit Sub



■ [asp.net] GridView 클릭 이벤트 만들기
    http://psh85a.tistory.com/entry/aspnet-GridView-%ED%81%B4%EB%A6%AD-%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EB%A7%8C%EB%93%A4%EA%B8%B0






■ Add Row Click event to GridView Rows in ASP.Net 
   http://www.aspsnippets.com/Articles/Add-Row-Click-event-to-GridView-Rows-in-ASPNet.aspx



■ select 버튼을 이용하여 다른웹페이지에 GRIDVIEW값 전달
    test.aspx로 이동
    Response.Redirect(String.Format("test.aspx?"))
    
    test.aspx로 이동하면서 testvalue에 gridview에서 선택한 값 넘기기
    Response.Redirect(String.Format("test.aspx?testValue=" + gridview.SelectedValue"))
    -받을때
    Page_Load
      string testvalue = request("testvalue")
    End sub

■ 버튼클릭으로 소스컨트롤 내용 그리드뷰어에 표시하기
    Protected Sub BtnLOGIN_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles BtnLOGIN.Click
        ADS.SelectCommand = "select * from mission where 회원명 = '" + TxtMEMNO.Text + "' "
        GridView1.DataSourceID = "ADS"
    End Sub

■ 선택 그리드뷰 셀값 가져오기 행선택
    GRIDVIEW1.ROWS(GridView1.SelectedIndex).CELLS(2).TEXT

■   그리드뷰	행번호 GridView1.SelectedRow.RowIndex


■  그리드뷰에서 필드표현을 자유롭게하기(안됨)
    http://blog.outsider.ne.kr/26 

■  그리드뷰에서 원하는 필드 가공하여 표시하기    http://blog.naver.com/hanbyi/110028229317 
    <ItemTemplate> == 안됨 
         <asp:Label ID="Label1" runat="server" 
         Text='<%# if ( (Eval("처리사유").Tostring().Length > 1) , (Eval("처리사유")="") , (Eval("처리사유").Substring(0,3)+"...") ) %>'></asp:Label> 
    </ItemTemplate>

■ 비하인드코드에서 변수받아 그리드 뷰 필드불러오기
<%# Eval(Me.SltPhone)%>

■그리드뷰에서 회사명으로 링크필드 보내기
 <asp:HyperLinkField DataNavigateUrlFields="회사명,소그룹" 
                            DataNavigateUrlFormatString="Main.aspx?movFile={0}&movFile={1} " DataTextField="회사명" HeaderText="소속" 
                            Target="_blank" />

■ 그리드뷰 필드 짧게가공하여 표시하기 : http://forums.asp.net/t/1011868.aspx?GridView+Control+BoundField+DataFormatString+String+Remove+
    *아주잘됨-현재사용*
   (코딩부분)
   Protected Function ValidateString(ByVal StrSAU As Object) As String '필드가공하여짤게표시
        ' Pass values as object since they may be DBNull
        If (StrSAU.ToString.Length > 3) Then
            Return StrSAU.ToString.Substring(0, 3) + " ..."
        Else
            Return StrSAU.ToString()
        End If
    End Function
  (소스부분)
    <ItemTemplate>
       <asp:Label ID="Label1" runat="server" Text='<%# ValidateString(Eval("처리사유").ToString())%>'></asp:Label>
     </ItemTemplate>



■ gridview 필드길이 고정하기(cs에서..)  | Building Server Controls (서버 컨트롤 제작)	2007-07-13 오후 5:26:20
 ozzy98  ozzy98님께 메시지 보내기ozzy98님을 내 주소록에 추가합니다.ozzy98님의 개인게시판 가기	번호: 112  / 읽음:1,836

gridview 이벤트중 RowCreated 라는것이 있는데
이부분에서 아래와 같이 해당 cell의 길이를 지정해주면 됩니다.
근데, rowcount가 많을경우 사용하기가 좀 꺼려지네요... 그래도 우선 급하신 분들을 위해서.. ^_^
 
 protected void GridView1_RowCreated(object sender, GridViewRowEventArgs e)
    {
        if (e.Row.RowIndex > -1)
        {
            e.Row.Cells[11].Width = Unit.Pixel(150);
            e.Row.Cells[12].Width = Unit.Pixel(150);
        }
    }

■ #.[ASP,NET] 텍스트창에서 엔터로 검색하기
--＊Program --/ASP.NET(C#,닷넷)
ASP.NET, 검색, 엔터, 텍스트박스, 텍스트박스 엔터 검색
[사용방법]

우리가 보통 데이터를 검색할떄 텍스트창에 텍스트만 치고서 엔터를 누른다.

마우스보다는 자주 애용하는 엔터. 검색시 엔터를 사용하기 위해서는 아래와 같이 하면된다



페이지 로드 부분에 다음과 같은 소스를 작성



 protected void Page_Load(object sender, EventArgs e)
{

    if (!IsPostBack)

   {

this.텍스트박스.Attributes.Add("onkeypress", "if(event.keyCode == 13) { "

+ Page.ClientScript.GetPostBackEventReference(활성버튼, "") + "; return false;}");

}

}

■ 스타일(style)
    - 컨트롤 visible 사용하면 실행이 안되지만 style="display:none" 하면 실행이 되고 보이지는 않는다.
       style="display:none" 은 디자인 속성에 없어도 실행속성에서 사용 가능하다.

■ 표여백
http://ankyu.entersoft.kr/Lecture/jquery/css_01.asp


■ 백그라운드 이미지 비하인드코드에서 바꾸기 https://forums.asp.net/t/1878343.aspx?Set+background+image+of+body+in+code+behind+file
   <body background='<%=bg%>'> 

   public string bg = "image1.jpg" 


■ 테이블 

- 테이블 내부간격 없앨려면
   <table cellpadding="0" cellspacing="0">

- 속성에 관하여
   테이블 속성을 style 에서 width 등을 설정해주면 원 속성이 정의 되어 실제 크기의 속성이된다. 하지만 뷰포트 적용 안된다 
   왜냐면 실제크기이니까 그러므로 % 로 해주면 실제크기이며 모바일도 제대로 적용된다.
결론: 다른테이블을 같은크기로 설정하려면 디자인 모드에서 style 속성에서 크기를 % 해주 면 됨 (새로만들기.aspx 에 적용함)
   디자인이나 비하인드의 style 에서 정의해주면 보여지는것만 바뀐다 즉 pc에서는 맞게 보이지만 모바일ㅇ서는 틀리게 보인다.


- 비하인드코드에서 테이블 백그라운드 바꾸기
  batang.Style("background-image") = "url(IMAGE/워크보드메인바탕.png)"

- 테이블간격 http://webisfree.com/blog/?titlequery=css-%ED%85%8C%EC%9D%B4%EB%B8%94-%ED%83%9C%EA%B7%B8%EC%97%90%EC%84%9C-td-%ED%83%9C%EA%B7%B8--%ED%85%8C%EB%91%90%EB%A6%AC%EA%B0%84-%EA%B0%84%EA%B2%A9-%EC%A1%B0%EC%A0%95-%EB%B0%A9%EB%B2%95--border-spacing
   table {
   border-spacing: 2px;
   border-collapse: separate;
  }
- 고정시킨상태에서 글자넣기 :    http://www.homejjang.com/09/table_layout.php

   표 -> 테이블레이아웃
   table-layout 속성값을 fixed로 지정하면 셀안의 데이터가 길어서 지정한 너비 이   상으로 셀을 밀어버리는 것을 방지합니다.
   보통 셀안의 내용이 한글인 경우 공백이 중간 중간에 들어가므로 자동으로 지정   한 너비에서 줄바꿈이 일어납니다.

   편집일경우 : 스타일 - 위치 - 포지션 - 픽스

- 언비지블(감추기) 하는방법 (테이블, <tr>,<td>수준에서 모두적용가능)
   아이디 지정 하고 서버에서실행으로 지정후 실행모드에서 visible=false 
   예) <tr id="AD_File" runat ="server" > 한후 visible = false(디자인모드에없음?) 


- 테이블 위에 두열 아래 한열 하면 아래쪽이 줄어들경우 colspan 을 2로 



■ 이미지버튼에서 이미지 불러올때 디자인모드와 실행모드 경로 같게 해줄것

 (예) ImgBtnNext.ImageUrl = "img/다음문제.png"  와 "~/STUDYROOM/영어단어/img/다음문제.png" 하면 문제 발생 

■ 타이머 스크립트메니져 쓸때 주의점
   업데이트판넬안에 있는것만 해당된다.

■ 난수를 이용한 랜덤수 만들기 http://yyman.tistory.com/entry/ASPNET-%EB%82%9C%EC%88%98%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%9E%9C%EB%8D%A4-%EC%88%98-%EB%A7%8C%EB%93%A4%EA%B8%B0
        Dim Rand As New Random
        Dim Iteration As Integer = 0

        Iteration = Rand.[Next](1, 100)
        Label1.Text = Iteration.ToString()

■ <div> 에 태그살고 코드로 언비지블 시키는 방법  http://forums.asp.net/t/1214005.aspx?Load+a+swf+file

<div id="abc" runat =server >
<object width="425" height="344">
  <embed src="001.swf" type="application/x-shockwave-flash" width="425" height="344"></embed>
</object>
   </div>

  Protected Sub Button1_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Button1.Click
        If Page.IsPostBack Then
            System.Threading.Thread.Sleep(3000)
            abc.Visible = False
        End If
    End Sub

■ Thread를 통한 예약된 작업실행 http://nsinc.tistory.com/117
  Private Sub scheduledTask()
        While True
            '작업코드 작성..
            '12시간 마다 실행
            System.Threading.Thread.Sleep(TimeSpan.FromSeconds(12))
        End While
    End Sub

    Protected Sub Application_Start()
        Dim taskThread As New System.Threading.Thread(AddressOf scheduledTask)
        taskThread.Start()
    End Sub  

	'//위코드 타이머로 이용

■ 타이머 만들기 http://www.csharpstudy.com/Threads/timer.aspx


■ 3초후 버튼감춤 
       If Page.IsPostBack Then
            System.Threading.Thread.Sleep(3000) '3초정지
            Button2.Visible = False
        End If


■ 수행시간

Imports System.Collections.Generic
Imports System.Diagnostics
Imports System.Linq
Imports System.Text
Imports System.Threading.Tasks

Namespace Test
	Class Program
		Private Shared Sub Main(args As String())
			Dim sw As System.Diagnostics.Stopwatch = New Stopwatch()
			sw.Reset()
			' 초기화
			sw.Start()
			' 시작
			'**********************************************************************
			'                          시간측정 구문                               
			'**********************************************************************
			sw.[Stop]()
			' 종료
			Console.WriteLine("수행 시간 : {0}", sw.ElapsedMilliseconds / 1000F)
		End Sub
	End Class
End Namespace




■ 플래시파일 넣기 http://stackoverflow.com/questions/668846/how-to-embed-a-flash-swf-file-into-asp-net
   <object width="425" height="344">
  <embed src="001.swf" type="application/x-shockwave-flash" width="425" height="344"></embed>
</object>


    


■ 컨트롤자동생성 컨트롤만들기
        Dim image As New Image()
        'Dim label As New Label()
        'label.Text = "Programmatic control"
        Page.Controls.Add(image) : 응용하면 Form1.Controls.Add(TextBox1) , Panel1.Controls.Add(TextBox1)

        image.ImageUrl = "~/PIC/공부방/images.jpg"
       '위치지정
         image1.Style("Position") = "Absolute" <= 반드시 써줄것
         image1.Style("top") = "190px"
         image1.Style("left") = "190px"


        클릭이벤트 만들기 (form 태그밑에서 작동)
       http://www.aspsnippets.com/Articles/Creating-Dynamic-Button-LinkButton-and-ImageButton-in-ASP.Net.aspx

       (설명) 마스타페이지와 연결된 상태에서 동적으로 컨트롤을 생성면 소스코드에 Form 태그가 없어 form1.Controls.Add(...) 를 할수 없어
       형식 runat=server 구문과 함께 form 태그 내부에 와야 합니다. 에러발생 이를 해결하기 위해 아래 코딩 삽입 (참조페이지http://seoddong.tistory.com/89))
         Public Overrides Sub VerifyRenderingInServerForm(ByVal control As System.Web.UI.Control)
        ' Confirms that an HtmlForm control is rendered for the specified ASP.NET server control at run time.
        End Sub
       하면 정상으로 생성된다.
       하지만 만들어진 컨트롤로 이벤트 발생시키면 작동되지 않는다..(방법이 있는지 없는지 못찿겠음 ㅠㅠ) 
       ★ 해서 마스타 페이지를 포함한 상태에서 컨트롤 만들고 이벤트 발생시키려면 form 대신 panel 컨트롤을 추가해서쓰면 만사 오케이!!

■ 자동생성된 컨트롤로 이벤트 발생시키려면 ~
     AddHandler btn.Click, AddressOf btn_Click 추가한후
        Panel1.Controls.Add(btn) 이렇게 해주면 된다.

        

■ 썸네일생성하기 http://m.blog.naver.com/gocathy/220302287042

■ http://allofweb-textcube.blogspot.kr/2009/08/02-aspnet-using-c-%EC%9D%B4%EB%AF%B8%EC%A7%80-%EC%8D%B8%EB%84%A4%EC%9D%BC-%EB%A7%8C%EB%93%A4%EA%B8%B0-%EC%98%88%EC%A0%9C.html

■ asp.net 이미지 자동 축소 저장 (http://blog.daum.net/_blog/BlogTypeView.do?blogid=0ZYyW&articleno=20&categoryId=7&regdt=20110905133016)
클라이언트가 사진을 줄이는 작업을 해서 업로드할 의사가 없는 상태에서 이미지를 리사이징 처리하는 방법
 
1. 1000*3000 의 사진을 그대로 올리고 서버에서 리사이즈를 한다
2. 클라이언트에서 자동 리사이즈를 해서 서버에 업로드한다.
 
2번 같은경우는 Active X 또는 Silverlight, Flex 등 클라이언트 쪽 추가 작업 필요함.
 
따라서 1번 업로드 후 서버쪽 리사이즈 처리.
 
일단 이렇게 작업함. 테스트 결과 이미지의 노이즈가 생각 보다 적으니 ok
-------------------------------------------------------------------------------------------------------
[Default.aspx]
==================================================================================
<%@ Page Language="C#" AutoEventWireup="true"  CodeFile="Default.aspx.cs" Inherits="_Default" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
  <asp:FileUpload ID="attachFile" runat="server" />
  <asp:Button ID="Button1" runat="server" Text="사진 올리기" onclick="Button1_Click" />
    </div>
    </form>
</body>
</html>
==================================================================================
 
 
[Default.aspx.cs]
==================================================================================
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.IO;
using System.Drawing;
using System.Drawing.Imaging;
using System.Drawing.Drawing2D;
public partial class _Default : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
    }
 
    protected void Button1_Click(object sender, EventArgs e)
    {
          //업로드 이미지명( 랜덤 문자+ 랜덤 숫자 적용 하여 유니크한 파일명 얻기 추가 작업요망)
          string imageName = Path.GetFileName(attachFile.PostedFile.FileName);
 
  //업로드된 이미지를 원하는 곳에 저장
  attachFile.PostedFile.SaveAs(Path.Combine(Server.MapPath("uploadimages"), imageName));
 
  //업로드된 이미지를 객체로 생성
  Bitmap img = new Bitmap(Path.Combine(Server.MapPath("uploadimages"), imageName));
 
  //새로운 크기로 만들 이미지 생성
  int width = 200;//웹에 출력될 너비
  int height = (width * img.Height) / img.Width;//종횡비 유지한 웹에 출력될 높이

  Bitmap resizeImg = new Bitmap(width, height);
 
  //GDI+를 이용해서 리사이즈된 이미지 생성
  Graphics g = Graphics.FromImage(resizeImg);
  g.InterpolationMode = InterpolationMode.HighQualityBicubic;
  g.DrawImage(img, new Rectangle(0, 0, width, height));
 
  //리사이즈된 이미지 저장
  resizeImg.Save(Path.Combine(Server.MapPath("uploadimages"), "resize.png"));//리사이즈된 파일명

 }


■ navigationmenu 에서..
  - 경로찿는방법
    Label1.Text = NavigationMenu.SelectedItem.ValuePath 

■ ASP.NET에서 오류 보고 페이지를 만드는 방법 - http://www.webmadang.net/develop/develop.do?action=read&boardid=1002&page=2&seq=5

■ ASP.NET에서 메일 보내기
ASP.NET에서 메일 보내기

다음 소스를 이용하면 된다.

우선 보내고자 하는 서버에 SMTP 서버가 올라가 있어야 한다.

그리고 릴레이 허용을 한다.(127.0.0.1 IP 에 대해서)

1. 네임 스페이스 추가한다..

using System.Net.Mail;

2. 메일 보내기 소스

  MailMessage message = new MailMessage();

  message.From = new Mai lAddress("hikim@kaoni.com");
  message.To.Add(new MailAddress("khihome@naver.com"));

  message.Subject = "안녕하세요";
  message.Body = "회신 주소 : ";

  message.SubjectEncoding = System.Text.Encoding.UTF8;
  message.BodyEncoding = System.Text.Encoding.UTF8;

  SmtpClient client = new SmtpClient("127.0.0.1");
  client.Send(message);
  Response.Write("OK");

■ [ASP] IsEmpy() 함수와 IsNull() 함수의 차이 -http://www.webmadang.net/develop/develop.do?action=read&boardid=1001&page=3&seq=55
    ※ IsEmpty : 변수의 값이 초기화 되었는지를 체크합니다.

    ※ IsNull : 데이타가 Null 인지를 체크합니다.
 <%
  Dim Uid

  session("Uid") = NULL
  Uid = NULL

  If IsEmpty(session("Uid")) Then
  response.write "session('Uid')는 골이 비었습니다." & "<br>" 
  End If


  If IsEmpty(Uid) Then
  response.write "Uid도 골이 비었습니다." & "<br>"
  End If

  If IsNull(session("Uid")) Then
  response.write "session('Uid')는 NULL이 되었습니다." & "<br>"
  End If

  If IsNull(Uid) Then
  response.write "Uid도 NULL이 되었습니다" & "<br>"
  End If
  %>

■ [ASP.NET] String.IsNullOrEmpty(문자열) - 문자열null체크 - http://modellerr.tistory.com/20


String.IsNullOrEmpty(문자열) 
문자열이 null 또는 공백문자이면 true 를 아니면 false 를 리턴한다. 

        if (!String.IsNullOrEmpty(Request.QueryString["gbn"]))
        {
            // 계약구분코드
            strCntrGbn = Request.QueryString["gbn"].ToString();
        }




■ 도메인네임 바뀌지 않고 페이지이동시키기
    소스 <head> 아래 아래코드를 기술해줌
     <frameset rows="*">
        <frame id="frameID" src="http://ddoksori.codns.com:8080/gongbubang/default.aspx" runat="server"></frame>
     </frameset>
     <body>
      ★ 위와같이 하여 페이지이동하면 도메인은 안바뀌지만 이동페이지에서 뷰포트 안먹는다
 

■ 플래시파일재생
http://www.beansoftware.com/ASP.NET-Tutorials/Play-Flash-Video.aspx


■브라우져 정보 알아오기 https://ooz.co.kr/67
var agent = navigator.userAgent.toLowerCase();

if (agent.indexOf("chrome") != -1) {

alert("크롬 브라우저입니다.");

}

사파리나 파이어 폭스 역시 다음과 같습니다.

if (agent.indexOf("safari") != -1) {
alert("사파리 브라우저입니다.");

}

if (agent.indexOf("firefox") != -1) {
alert("파이어폭스 브라우저입니다.");

}


네. 물론 인터넷 익스플로러도 위와 별로 다르지 않습니다.  IE 10버전까지라면 말이죠.

agent 에 msie (microsoft ineternet explorer) 가 포함되는지 확인하면 됩니다.

if (agent.indexOf("msie") != -1) {
alert("인터넷익스플로러 브라우저입니다.");

}



출처: https://ooz.co.kr/67 [이러쿵저러쿵]


■브라우져 또는 모바일 pc 체크
출처: https: //clairdelunes.tistory.com/31 [거꾸로 바라본 세상]

■ 브라우저 정보 알아오기

     브라우저 Request.Browser.Browser
	 버전 Request.Browser.ver

http://anshnote.blogspot.com/2011/07/aspnet-browser-httpbrowsercapabilities.html

	Dim bc As HttpBrowserCapabilities
    Dim s As String
    bc = Request.Browser
    s = "Browser Capabilities" & vbLf
    s += "Type = " & bc.Type & vbLf
    s += "Name = " & bc.Browser & vbLf
    s += "Version = " & bc.Version & vbLf
    s += "Major Version = " & bc.MajorVersion & vbLf
    s += "Minor Version = " & bc.MinorVersion & vbLf
    s += "Platform = " & bc.Platform & vbLf
    s += "Is Beta = " & bc.Beta & vbLf
    s += "Is Crawler = " & bc.Crawler & vbLf
    s += "Is AOL = " & bc.AOL & vbLf
    s += "Is Win16 = " & bc.Win16 & vbLf
    s += "Is Win32 = " & bc.Win32 & vbLf
    s += "Supports Frames = " & bc.Frames & vbLf
    s += "Supports Tables = " & bc.Tables & vbLf
    s += "Supports Cookies = " & bc.Cookies & vbLf
    s += "Supports VB Script = " & bc.VBScript & vbLf
    s += "Supports JavaScript = " & bc.JavaScript & vbLf
    s += "Supports Java Applets = " & bc.JavaApplets & vbLf
    s += "Supports ActiveX Controls = " & bc.ActiveXControls & vbLf
    Response.Write(s)



■ 서버아이피주소알아오기 
'============= 서버아이피주소 ===============
            Dim strIP As String = HttpContext.Current.Request.UserHostAddress
            Session("strIP") = "http://" & strIP & ":8080"
            'Response.Write("<script language = 'javascript'> alert('" + Session("strIP") + "') </script>")

■ 웹브라우져버전알아내기 http://jongbu.tistory.com/entry/%EB%AA%A8%EB%B0%94%EC%9D%BC%EA%B8%B0%EA%B8%B0-%EB%98%90%EB%8A%94-PC%EC%9D%98-%EB%B8%8C%EB%9D%BC%EC%9A%B0%EC%A0%80-%EB%B2%84%EC%A0%84-%EC%B2%B4%ED%81%AC%ED%95%98%EC%97%AC-%EB%AA%A8%EB%B0%94%EC%9D%BC-%ED%8E%98%EC%9D%B4%EC%A7%80-%EB%B0%8F-%EC%9D%BC%EB%B0%98-%ED%8E%98%EC%9D%B4%EC%A7%80-%EB%B0%94%EB%A1%9C%EA%B0%80%EA%B8%B0-%EA%B8%B0%EB%8A%A5%EC%9D%84-%EB%B9%84%ED%95%98%EC%9D%B8%EB%93%9C-%EC%BD%94%EB%93%9C%EC%97%90%EC%84%9C-%EA%B5%AC%ED%98%84

   Private Sub Button1_Click(ByVal sender As System.Object, _
       ByVal e As System.EventArgs) Handles Button1.Click
    Dim s As String = ""
    With Request.Browser
        s &= "Browser Capabilities" & vbCrLf
        s &= "Type = " & .Type & vbCrLf
        s &= "Name = " & .Browser & vbCrLf
        s &= "Version = " & .Version & vbCrLf
        s &= "Major Version = " & .MajorVersion & vbCrLf
        s &= "Minor Version = " & .MinorVersion & vbCrLf
        s &= "Platform = " & .Platform & vbCrLf
        s &= "Is Beta = " & .Beta & vbCrLf
        s &= "Is Crawler = " & .Crawler & vbCrLf
        s &= "Is AOL = " & .AOL & vbCrLf
        s &= "Is Win16 = " & .Win16 & vbCrLf
        s &= "Is Win32 = " & .Win32 & vbCrLf
        s &= "Supports Frames = " & .Frames & vbCrLf
        s &= "Supports Tables = " & .Tables & vbCrLf
        s &= "Supports Cookies = " & .Cookies & vbCrLf
        s &= "Supports VBScript = " & .VBScript & vbCrLf
        s &= "Supports JavaScript = " & _
            .EcmaScriptVersion.ToString() & vbCrLf
        s &= "Supports Java Applets = " & .JavaApplets & vbCrLf
        s &= "Supports ActiveX Controls = " & .ActiveXControls & _
            vbCrLf
    End With
    TextBox1.Text = s
End Sub

■ 모바일 접속여부 체크
    <script type="text/javascript">
    var filter = "win16|win32|win64|mac";
    if (navigator.platform) {
        if (0 > filter.indexOf(navigator.platform.toLowerCase())) {
            alert("Mobile");
        } else {
            alert("PC");
        }
    }
</script>


■ 모바일기기 또는 PC의 브라우저 버전 체크하여, 모바일 페이지 및 일반 페이지 바로가기 기능을 비하인드 코드에서 구현
    http://jongbu.tistory.com/entry/%EB%AA%A8%EB%B0%94%EC%9D%BC%EA%B8%B0%EA%B8%B0-%EB%98%90%EB%8A%94-PC%EC%9D%98-%EB%B8%8C%EB%9D%BC%EC%9A%B0%EC%A0%80-%EB%B2%84%EC%A0%84-%EC%B2%B4%ED%81%AC%ED%95%98%EC%97%AC-%EB%AA%A8%EB%B0%94%EC%9D%BC-%ED%8E%98%EC%9D%B4%EC%A7%80-%EB%B0%8F-%EC%9D%BC%EB%B0%98-%ED%8E%98%EC%9D%B4%EC%A7%80-%EB%B0%94%EB%A1%9C%EA%B0%80%EA%B8%B0-%EA%B8%B0%EB%8A%A5%EC%9D%84-%EB%B9%84%ED%95%98%EC%9D%B8%EB%93%9C-%EC%BD%94%EB%93%9C%EC%97%90%EC%84%9C-%EA%B5%AC%ED%98%84

    ASP.NET   

C#
 
 
 
모바일기기 또는 PC의 브라우저 버전 체크하여, 모바일 페이지 및 일반 페이지 바로가기 기능을 비하인드 코드에서 구현
 
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
 
public partial class testpage : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
 
       string userAgent = Request.UserAgent;
        
        bool isMobile = false;
 
        String[] browser = { "iphone", "ipod", "ipad", "android", "blackberry", "windows ce", "nokia", "webos", "opera mini", "sonyericsson", "opera mobi", "iemobile", "windows phone" };
 
        for (int i = 0; i < browser.Length; i++)
        {
            if(userAgent.ToLower().Contains(browser[i]) == true)
            {
                isMobile = true;
                break;
            }
        }
 
        Response.Write(isMobile);
 
    }
}

■ 파일 복사 이동 삭제
Dim sDir As String = "C:\TEST\test.txt"
Dim fileinfo As New FileInfo(sDir)

If fileinfo.Exitsts Then
	' 복사
	' true 미설정시 파일이 존재하면 에러 발생
	filinfo.CopyTo("C:\TEST\test2.txt", True)

	' 이동
	fileinfo.MoveTo("C:\TEST\test2_move.txt")

	' 삭제
	fileinfo.Delete()
End If


■ 클라이언트 아이피주소 알아내기   
        
		1. ASP.NET에서 주로 사용하는 방법

		Label1.Text = Request.UserHostAddress;

		2. 예전 사용방법
        
		Label2.Text = Request.ServerVariables["REMOTE_HOST"];

		Label3.Text = Request.ServerVariables["REMOTE_ADDR"];



출처: http://hyungsee.tistory.com/entry/현재-접속자의-IP주소를-얻는-방법 [형씨의 코드쟁여놓는 공간]

		
		Dim IP As String = Request.ServerVariables("REMOTE_ADDR")
        Response.Write("<script language='JavaScript'>alert('" + IP + "')</script>")

		브라우저 알아오기 Request.ServerVariables("HTTP_USER_AGENT")





■ 화면깜빡임 방지
<meta content="blendTrans(Duration=0.0)" http-equiv="Page-Enter" />
<meta content="blendTrans(Duration=0.0)" http-equiv="Page-Exit" />

■ sms 보내기 https://mydirect.co.kr/support/manual_view.php?serl=40

■ 성능모니터보기(서버동시 사용자계보기) - permon.msc
■ netstat -ano | find /c "8080"

■  두개상위폴더 ../../App_Data/
■ ./ 와 ~/의 차이 .(폴더) ..(바로위폴더)
   Response.Redirect 로 이동할경우 ./ 는 에러 ~/ 는 정상


■ 오류처리방법 http://www.webmadang.net/develop/develop.do?action=read&boardid=1002&page=2&seq=5

■ 세션 http://blog.naver.com/PostView.nhn?blogId=knight50&logNo=80152972412
      void Session_Start(object sender, EventArgs e) 
    {
        // Code that runs when a new session is started

    }

    void Session_End(object sender, EventArgs e) 
    {
        // Code that runs when a session ends. 
 
    }
[출처] [ASP.NET] Session in ASP.Net (퍼온글)|작성자 좋은생각



■ ASP.NET Web.config에서 세션상태 설정 방법 http://ldg119.tistory.com/408

■ 세션상태설정방법(자세히..) http://jajking-textcube.blogspot.kr/2009/08/aspnet-%EC%97%90%EC%84%9C%EC%9D%98-%EC%84%B8%EC%85%98-%ED%83%80%EC%9E%84%EC%95%84%EC%9B%83-%EC%84%A4%EC%A0%95%EC%9D%98-%EC%9A%B0%EC%84%A0%EC%88%9C%EC%9C%84session.html
   ASP.NET 에서의 세션 타임아웃 설정의 우선순위(session timeout)

세션 타임 아웃이란 서버와 클라이언트 사이의 연결이 일정시간 일어나지 않는 다면

연결 상태를 잊어버리는 것을 의미합니다

쉽게 말해서 컴퓨터 하다가 장기간 자리를 비우면 웹페이지에서 자동으로 로그아웃 되어 버리는 것이죠

오늘은 ASP.NET에서의 세션 타임 아웃에 관한 우선순위를 알아보죠.



1위: 페이지 설정

우선순위가 가장높은 아이는 바로 페이지에서의 설정입니다.


Form_Load()이벤트에들어가셔서  Session.Timeout=60 이라고 기술하시면

60분동안 세션끊김은 일어나지않습니다.

범위: 그 페이지에서만 유효 합니다.

 

2위: global.asax 설정

두번째는 글로벌환경설정에서의 기술입니다.

 Application_Start메소드에서 Session.Timeout=60 이라고 기술하시면

위와 같이 60분동안 세션 연결이 가능합니다.

범위: 한 세션내에서 유효 합니다.

 

3위: web.config 설정

세번째로 웹닷컴피그 파일이군요.

일반적으로 가장 많이 사용되는 설정입니다.

보통 우리가 아는 대부분의 ASP.NET 싸이트가 여기에 해당하겠죵.

 <system.web>

      ~~~(생략)~~~

        <sessionState mode="InProc" timeout="60" />

 </system.web>

범위:웹싸이트 전역에서 유효합니다.(가장 편리하죠)

 

4위:machine.config 설정

이거는 하나의 웹서버에 두개이상의 웹싸이트가 존재할 경우에나 유효합니다.

한마디로 일반적으로는별 신경안써도 되는 놈들이죠

그래도 혹시나 해서 경로를 적어둡니다.

C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\CONFIG

폴더 밑에 machine.config 파일이 존재합니다.

<sessionState mode="InProc"

     stateConnectionString="tcpip=127.0.0.1:42424"

     stateNetworkTimeout="10" sqlConnectionString="data  

     source=127.0.0.1;Integrated Security=SSPI"cookieless="false"

     timeout="60"/>

이라고 기술해 주시면 60분으로 적용이 됩니다.

오늘은 세션의 타입 아웃에 관해서 알아 보았습니다.

 

위의 4가지를 설정해 주시셔도 세션끊김 현상이 발생 할 수 있습니다.IIS서버의 설정이 기본으로 20분으로 잡혀 있기 때문이죠 그러면 IIS서버를 열어서 설정화면에서 시간을 늘려 주세요
그리고 세션이 모두 살아 있다고 해서 로그아웃이 안되는것도 아니랍니다. 예를 들어서 권한이 없어져도 세션끊김 현상과 같은 증상이 나타납니다. 그렇기 때문에 권한끊김 시간도 확인해 보시는게 좋을듯 합니다.
대한민국 개발자 여러분 홧팅하세용.^^

질문은 블로그 덧글에 달아주시면 감사하겠습니다.(덧글 매일확인)

■ iis세션시간설정 참고 http://www.sqler.com/430501
    
    gongbubang 세션시간 바꿔주면 web.congig 에 <sessionState cookieless="UseCookies" mode="InProc" timeout="80" /> 도 자동바뀜(신기)
    (세션모드 : uri 사용에서 쿠키사용으로 바꿔줬음)

■ 코딩에서 html 쓰기..
   LnkBtnMyWORK.Text = "받은 메시지 보기" & "<br/><font color=red>(" & rcnt & "개 안읽음)</font>"


■  배열만들기- 배열수가 적을때
'--------C#----------------------------------
label[] lbl = new label[] {label1, label2};

for (int i = 0; i < lbl.length; i++)
   {
     lbl[i].text = (i + 1).TOSTRING();
   }


'---------VB--------------------------------------
Dim lbl As label = New label() {label1, label2}


For i As Integer = 0 To lbl.length - 1 
  lbl(i).text = (i + 1).TOSTRING()
Next


* 배열만들기- 배열수가 많을때
String[] ButtonNames = new string[100];

for (int i = 0; i < 2; i++)
  {
    ButtonNames[i] = "button" + i + "";
    if(i==1)
      {
        this.Controls[ButtoNames[i].Text = "100";
      }
   }  

#########################################################

■ [RE]Response.Redirect 와 Server.Transfer의 차이?

예를들어 메세지박스 후 Server.Transfer 하면 메세지박스출력됨,  Server.Transfer 후 뒤로가기하면 전페이지가 재실행됨
         메세지박스 후 Response.Redirect 하면 메세지박스 출력안됨, Response.Redirect 후 뒤로가기하면 전페이지 실행안됨

(참고: https://forums.asp.net/t/1411915.aspx?response+redirect+and+messagebox+not+working)
Dim message As String = "이미 " + GU + " 처리 하였습니다."
ClientScript.RegisterClientScriptBlock(Me.GetType(), "Alert", "<script type = 'text/javascript'>window.onload=new function(){setTimeout(""alert('" + message + "');window.location='STUDYROOM_NFC/MyORDER.aspx';"", 1000)};</script>")



페이지로 제어권을 넘기고 실행이 끝나면 원래 페이지 제어권이 넘어오지 않고 거기서 실행이 끝나 버립니다.
서버에서만 페이지를 이동하고 결과를 클라이언트로 보내기 때문에 클라이언트 브라우져의 URL입력창에는 변화가 없습니다.
그리고, URL에 값을 붙여서 넘기는 Get방식의 사용도 불가능 합니다.

Response.Redirect의 경우 실행하게 되면 서버에서 HTTP헤더를 클라이언트로 보내서 클라이언트가 지정된 주소를 다시 찾게 합니다.
Transfer와는 달리 처음 실행 시 한번 접속이 이루어 지고 보내어진 HTTP 헤더로 클라이언트가 페이지 이동 후 다시 한번 서버로의 접속이 이루어지게 됩니다.

이밖에도 Server.Execute가 있습니다. 
Server.Execute의 경우 특정 페이지를 함수 처럼 실행 시키고 그 결과 값을 받을 수 있습니다.
Server.Execute를 실행 시키면 일단 설정한 페이지로 제어권이 넘어가서 해당 페이지 실행 후 결과값을 받고 다시 원래 페이지로 제어권이 넘어오게 됩니다.
(제어권이 넘어온다는 것은 원래 페이지의 Server.Execute 다음 코드가 계속 실행 된다는 이야기 입니다.)


■ 사운드재생'/Response.Write("<embed src=Bell/bell.wav loop=true autorun=true ></embed>;")

■ 사운드재생방법  http://www.elated.com/articles/html5-audio/
   <audio id="myTune">
  <source src="WhiteChristmas.mp3">
  <source src="WhiteChristmas.ogg">
</audio>
 
<button onclick="document.getElementById('myTune').play()">Play Music</button>
<button onclick="document.getElementById('myTune').pause()">Pause Music</button>
<button onclick="document.getElementById('myTune').pause(); document.getElementById('myTune').currentTime = 0;">Stop Music</button>

-추가 참고싸이트 http://crossxp.tistory.com/m/668


■ 소리재생 코딩

   Imports System.Media
   Dim wp As SoundPlayer = New SoundPlayer("http://ddoksori.codns.com:8080/WORKBOARD/GETFILE/%EC%9B%8C%ED%81%AC%EB%B3%B4%EB%93%9C/251110_%EC%9A%B0%EC%97%B0%ED%9E%88.wma")
   wp.PlaySync() 

■ 소리 사운드(sound) 재생 

- 비하인드 코드에서 사운드 재생 (audio 를 vidio 로바꾸면 비디오)
https://www.codeproject.com/Questions/369186/How-to-Play-audio-Video-Files-in-Asp-net
Protected Sub Button2_Click(sender As Object, e As System.EventArgs) Handles Button2.Click
        Dim myobj As String = ""

        myobj += "<audio width='462'  controls='controls' data-setup='{}'>"
        myobj += "<source src='bell/Film.mp3' type='audio/mp3' />"

        myobj += "Your browser does not support video"

        myobj += "</object>"
        myobj += "</audio>"

        Literal1.Text = myobj
    End Sub



*3가지 형태
<audio controls="" preload="" autoplay="">
  <source src="hiworkboard.wma" type="audio/mp3"> ==주의 타입을 mp3로..
</audio>
<audio controls="" preload="">
  <source src="http://kurien.tistory.com/attachment/cfile22.uf@27232840525C95EE1D1CD2.mp3" type="audio/mp3">
</audio>

<audio src="hiworkboard_eng.wma" controls="controls">
    <embed srd="hiworkboard.wma_eng">
</audio>


http://crossxp.tistory.com/668
http://kurien.tistory.com/74
http://biew.co.kr/6

- 임베드로 재생..핸펀안됨
<embed src="Bell/Film.mp3" loop="true" autorun="true" hidden="true"></embed>

- 초간단 자바스크립트 사운드플레이 핸펀안됨

<script>
function playSound(mysound) {
var audio = new Audio(mysound);
audio.play();
}
</script>

버튼안에...
ScriptManager.RegisterClientScriptBlock(Me, [GetType](), "OpenWindow", "javascript: playSound('./audio/notification.wav')", True)


■ 강제로 익스8 브라우저로 만들어주기 (http://blog.naver.com/PostView.nhn?blogId=qfwh&logNo=220178750687&parentCategoryNo=&categoryNo=&viewDate=&isShowPopularPosts=false&from=postView)

<meta http-equiv="X-UA-Compatible" content="IE=8" /> 
최신 버전으로...
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
 
■ 비디오재생  http://unikys.tistory.com/278
* <video> 태그
: 바로 예제를 보자.
<video controls
  src="http://media.w3.org/2010/05/bunny/movie.ogv">
Your user agent does not support the HTML5 Video element.
</video>
■ 비디오재생 비하인드에서 영상소스 보내기
Partial Class HELP_HelpMp4
    Inherits System.Web.UI.Page
    Public file_url As String = "http://acaboard.iptime.org:8080/w/help/WAV/help1.mp4"
End Class

<div style="text-align: center"> '가운데위치
<video width="80%" height="80%" controls="controls">'80% 화면크기
  <source src="<%= file_url %>" type="video/mp4" /> 
  <source src="<%= file_url %>" type="video/ogg" />
  Your browser does not support the video tag.
</video>
</div>
 
    


■ 테이블 화면 가운데 위치
    .box {
    width:300px;
    height:300px;
    background-color:#d9d9d9;
    position:fixed;
    margin-left:-150px; /* half of width */
    margin-top:-150px;  /* half of height */
    top:50%;
    left:50%;
}

■ 테이블안에<div>가운데정렬
    <div style="margin-left:auto;margin-right:auto; width:50% ">
         <table>..........
     </div> 

■ <div>가운데정렬</div>
    ## 소스 ##

<body]
    <div style=" font-size:smaller; position:absolute; background-color:Green; width:300px; height:200px; top:50%; left:50%; margin-left:-150px; margin-top:-100px;">
        ^^;; 정렬 어렵죠?<br />
        스타일 보시면 아시겠지만...<br />
        1.div박스의 크기지정(width:300px; height:200px;)<br />
        2.화면 가운데로 정렬(top:50%; left:50%;)<br />
          이렇게하면 div박스의 왼쪽 맨 윗점이 화면의 중간에 위치합니다.<br />
        3.그러므로 (margin-left:-150px(-width/2); margin-top:-100px(-height/2);)를<br />
          사용해서 화면 가운데로 옮기는 거죠. ^^<br />
    </div>
</body]
■ 페이지주소창고정시키기
    <frameset row="1*">
        <frame name="main" src="http://ddoksori.codns.com:8080/workboard/Default.aspx"></frame>  
    </frameset>

■ 이전페이지로이동
     Response.Write("<Script language='JavaScript'>history.back(); </script>") '자동잘됨(취소일경우자주사용)
	 (위의경우 어떤페이지로 이동중 에러가 발생하면 에러페이지(이상한모양으로 바뀜)로 진행후 바로 취소되어 에러페이지이동을 방지한다)

	 -링크로페이지이동(freetext페이지내)로 사용할경우
	 <a href="#" onClick="parent.close()">창닫기</a>  
     <a href="#" onClick="history.back()">이전페이지로</a>  
     <a href="#" onClick="history.forward()">앞 페이지로</a>  
     <a href="#" onClick='top.location="javascript:location.reload()"'>새로고침</a>

■(중요)-커맨드(command)버튼 이미지 삽입
<asp:Button ID="btnLogin" runat="server" Text="Login" Style="background-image:url('Image/1.png'); background-repeat:no-repeat"/>

■(중요)-커맨드(command)버튼
커맨드버튼에 onclick 이벤트 소스코드에 뒤로가기 이벤트 주기
<asp:Button ID="BtnExit0" runat="server" Text="나가기" Height="25px" 
                    onclientclick="history.back()" />

■(중요)이미지에 뒤로가기 이벤트주기 
속성(소스코드)에 onclientclick="history.back()


~/IMAGE/워크보드로그인바탕1.gif
     Response.Write("<Script language='JavaScript'>history.go(-1);; </script>")  '뒤로가기 -2로지정

■ 이전페이지로이동
    Dim PrevPage As String = String.Empty
    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        'If Not IsPostBack Then
        
		PrevPage = Request.UrlReferrer.ToString()
        'End If
    End Sub

   Protected Sub Btn_SEND_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Btn_SEND.Click
        Response.Redirect(PrevPage)
    End Sub


■ 포커스이동
    TxtCustom.Focus()
    


■ 다른페이지로이동 + 데이타값넘기기
http://kmj1107.tistory.com/entry/ASP-%EB%8B%A4%EB%A5%B8%ED%8E%98%EC%9D%B4%EC%A7%80%EB%A1%9C-%EC%9D%B4%EB%8F%99-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%84%98%EA%B8%B0%EA%B8%B0-ResponseRedirect

■ 값 nothing 으로 만들기
    Session("CUSTOM") = Nothing

■ 주소표시줄 아이콘 만들기 (http://songgmo.egloos.com/viewer/2955322)
   이젠 초기 페이지 index.htm이나 index.html 파일에서 
아이콘 파일을 읽을수 있도록 링크만 잡으면 됩니다. 
반드시 <head></head> 사이에 넣구요

<HEAD> 
<LINK REL="SHORTCUT ICON" HREF="http://내홈페이지/favicon.ico"> 
<TITLE>내 홈페이지</TITLE>
<script language="javascript"> 
<!--
function favor() { // 즐겨찾기 추가 스크립트입니다.
window.external.AddFavorite('http://내홈페이지/', 'CGI 와 JavaScript가 만났을 때=C.n.J');
}
//-->
</script>
</HEAD>

아래의 소스는 body 태그아래 적당한 위치에 삽입하면 됩니다.
<a href="javascript:favor()">즐겨찾기 추가</a> 

이제 [즐겨찾기 추가]를 선택하면 브라우저의 즐겨찾기에 자신의 홈페이지가 추가될 것입니다. 
즐겨찾기 누르신후 즐겨찾기에 있는 자신의 홈페이지를 클릭하면 파비콘(Favicon.ico)이 보일겁니다.

■ 페이지 에러날경우 특정 웹페이지로 바로가기 : http://www.codeproject.com/Articles/2345/Custom-Errors-in-ASP-NET
    <customErrors mode="RemoteOnly" defaultRedirect="ErrPage.aspx"/>

■ 문자구분하여 자르기
   Dim abc As String() = s2.Split(New Char() {"@"c})


■ 라벨컨트롤인스턴스생성
               Dim NewLbl1 As New Label()
                NewLbl1.Text = dr("요청내용")
                PlaceHolder1.Controls.Add(NewLbl1)

■ 팝업창띄우기(자바스크립트)
   1)  Response.Write("<script language = 'javascript'> window.open('popup.aspx', 'new', 'top=100px, left=100px, width=300px, height=300px') </script>")
     - fullscreen = 전체 창. (yes/no)(default : no)
     - location = 주소창이 활성화. (yes/no)(default : yes)
     - menubar = 메뉴바 visible. (yes/no)(default : yes)
     - titlebar = 타이틀바. (yes/no)(default : yes)
     - toolbar = 툴바. (yes/no)(default : yes)
     - resizable = 창 사이즈 변경. (yes/no)(default : yes)
     - scrollbars = 스크롤바. (yes/no)(default : yes)
     - width = 창 가로 크기
     - height = 창 세로 크기

   2) Dim url As String = "http://124.5.65.42:8080/gongbubang/STUDYROOM/Click/Click_EDUMOD.aspx?value=" & LblPath.Text & ""
        Dim sb As New StringBuilder()
        sb.Append("<script type = 'text/javascript'>")
        sb.Append("window.open('")
        sb.Append(url)
        sb.Append("');")
        sb.Append("</script>")
        ClientScript.RegisterStartupScript(Me.GetType(), _
                  "script", sb.ToString())


■  팝업장 차단여부

<script type="text/javascript">
          var objPopup = window.open("./information.aspx", "", "width=1000,height=1000");
          if (objPopup == null) {
              alert("차단된 팝업창을 허용해 주십시오.");
          }
          else {
              alert("팝업창이 이상없이 오픈되었습니다.");
          } 
       </script>



■  팝업창띄우기(VB.net)
       Dim url As String = "Popup.aspx"
       Dim s As String = "window.open('" & url + "', 'popup_window', 'width=300,height=100,left=100,top=100,resizable=yes');
       ClientScript.RegisterStartupScript(Me.GetType(), "script", s, True)

■  팝업창 닫기 http://rocabilly.tistory.com/67
      <a href="#" onclick="javascript:window.close()">close</a>


■ 비하인드코드에서 간단 팝업창 열기 닫기
Response.Write("<script>window.open ('SAU_INPUT.aspx','_blank','width=500, height=850, resizable=yes,left=524,top=268');</script>")

 Response.Write("<script>window.close();</script>")

소스코드에서는..
 <a href="#" onclick="javascript:window.close()" 
                    style="background-image: url('IMAGE/창닫기.png')"><strong><span class="style4">닫&nbsp; 
                기</span></strong></a>


■ 팝업창(이미지버튼클릭으로띄우기):http://happynuri.tistory.com/entry/popup-창-팝업해제-안하고-팝업-띄우기
   -Page_Load 이벤트에
   IBtnOK.Attributes("onclick") = "OpenWin()"
   -소스코드에 자바스크립트
   <script type="text/javascript">
           function OpenWin()
          {
          window.open("popup.aspx","chiwon","scrollvars=no, width= 500, height=500");
          }
    </script>
   -소스코드에 버튼
  <asp:ImageButton ID="IBtnOK" runat="server" ImageUrl="~/IMAGE/경광등(소).png" />




*****************************************************************************************************




■ 텍스트-박스에서-엔터-키-입력하면-버튼의-클릭이벤트-자동-실행
    '텍스트박스에서 엔터치면 버튼 클릭이벤트 작동
     txtTextbox.Attributes("onkeypress") = "if (event.keyCode==13){" + Page.GetPostBackEventReference(btnButton) + "; return false;}"

■ 마스터-페이지-동적으로-특정-컨트롤-접근 http://devman.tistory.com/entry/마스터-페이지-동적으로-특정-컨트롤-접근
   
    마스터페이지에 lblDisplay 라벨추가

    a.aspx - DirectCast(Master.FindControl("lblDisplay"), Label).Text = "메인"
    b.aspx - Dim lbl As Label = DirectCast(Master.FindControl("lblDisplay"), Label) 
                  lbl.Text = "소개"

■ aps.net 에서 Html 코드
    마스터 페이지를 사용할경우 Html 코드는 site.master 페이지에 적용
    마스터 페이지 사용안할경우는 자체 .aspx 페이지에 코딩

■ 데이타베이스 레코드 중복하여 여는방법
    Dim cmd As OleDbCommand = New OleDbCommand("select * from customer where HP = '" + TxtCustom1.Text + "'", cn)
                cn.Open()
                Dim dr As OleDbDataReader = cmd.ExecuteReader(CommandBehavior.CloseConnection)
                If dr.HasRows = True Then '참고(레코드갯수가 0 보다 크면
                    Response.Write("<script language = 'javascript'> alert('이미저장되어있는 게스트번호 입니다.'); history.back()  </script>")
                    ADS_Custom.SelectCommand = ("select * from customer where HP = '" + TxtCustom1.Text + "'")
                    GridView1.DataSourceID = "ADS_Custom"
                Else
                    Dim cmd1 As OleDbCommand = New OleDbCommand("select * from member where ID = '" + TxtCustom1.Text + "'", cn)
                    'cn.Open()
                    Dim dr1 As OleDbDataReader = cmd1.ExecuteReader(CommandBehavior.CloseConnection)
                    If dr1.HasRows = True Then '참고(레코드갯수가 0 보다 크면
                        Response.Write("<script language = 'javascript'> alert('사원 사번으로 저장되어있는 전화번호라 입력할 수 없습니다.'); history.back() </script>")
                        ADS_Custom.SelectCommand = ("select * from customer where HP = '" + TxtCustom1.Text + "'")
                        GridView1.DataSourceID = "ADS_Custom"
                    Else
                        ADS_Custom.InsertCommand = "INSERT INTO customer (ID,  이름, 거래처명, HP, email, 등록사원) VALUES ( '" + Session("USERID") + "', '" + TxtCustom.Text + "', '" + TxtCustom0.Text + "' , '" + Replace((TxtCustom1.Text.Trim()), "-", "") + "', '" + TxtCustom2.Text + "',  '" + Session("USERNAME") + "')"
                        ADS_Custom.Insert()
                    End If
                End If

■ 레코드 합,평균,
	SELECT COUNT(column-name)
	  FROM table-name

	The general SUM syntax is:
	SELECT SUM(column-name)
	  FROM table-name

	The general AVG syntax is:
	SELECT AVG(column-name)
	  FROM table-name

■레코드에 숫자1씩증가 또는 1씩감가하기(좋음)
        Dim cnTOK As OleDbConnection = New OleDbConnection("Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" + Server.MapPath("~/App_Data\office.mdb;"))
        Dim cmdTOK As OleDbCommand = New OleDbCommand("UPDATE RTinfo SET ALIMTLKcnt = ALIMTLKcnt-1 where RT_Name = '" + ViewState("getLTD") + "'", cnTOK)
        cnTOK.Open()
        cmdTOK.ExecuteNonQuery()
        cnTOK.Close()

■ 레코드갯수 반환 (가장간단) 기준사용할것
 cn = New OleDbConnection("Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" + Server.MapPath("./App_Data\" & Session("LTD") & ".mdb;"))
        cn.Open()
        '20160423회원수입력제한을 위하여 회원수 체크-------------------------
        Dim Allcnt As New OleDbCommand("select count (*) from member", cn)
        Dim count As Integer = CInt(Allcnt.ExecuteScalar())
        cn.Close()
        If count > 0 Then
            Response.Write("<script language = 'javascript'> alert('입력제한수가 초과 되었습니다.') </script>")
            Exit Sub
        End If
■ 레코드 처음으로 이동
Dim cmdFile2 As OleDbCommand = New OleDbCommand("select top 1 * from ORDERS where (요청사원사번 = '" + Session("USERID") + "' and 구분='" + RdoBtnLst.SelectedValue + "') order by SEQ desc", cn)

            'cn.Open()
            'dr = cmdFile2.ExecuteReader(CommandBehavior.CloseConnection)
            'dr.Read()

            'If dr.HasRows = True Then
            '    dr.Close()
            '    cn.Close()
            '    Call LoadTable()
            'Else

■ 데이타셋으로 레코드 컨트롤
http://www.webmadang.net/develop/develop.do?action=read&boardid=1002&page=1&seq=21

        Dim adapter As New OleDbDataAdapter
        Dim ds As New DataSet

        cn = New OleDbConnection("Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" + Server.MapPath("./App_Data\" & Session("LTD") & ".mdb;"))
        Dim myCmd As New OleDbCommand("select * from myMEMO where (ID = '" + Session("USERID") + "')", cn)
        adapter.SelectCommand = myCmd
        adapter.Fill(ds, "People")
        adapter.Dispose()
        myCmd.Dispose()
        Dim rcnt As Integer = ds.Tables(0).Rows.Count

        If rcnt = 0 Then
            cmd = New OleDbCommand("INSERT INTO myMEMO (ID,내용) values ('" + Session("USERID") + "'  , '" + TxtBoxMemo.Text + "')", cn)
            cn.Open()
            cmd.ExecuteNonQuery()
            cn.Close()
        Else
            cmd = New OleDbCommand("UPDATE myMEMO SET 내용 = '" + TxtBoxMemo.Text + "' where ID = '" + Session("USERID") + "'", cn)
            cn.Open()
            cmd.ExecuteNonQuery()
            cn.Close()
        End If
        cn.Close()
        Response.Write("<script language='JavaScript'>alert('메모가 추가 저장되었습니다.')</script>")


       방법2=============================
                Dim cmd4 As OleDbCommand = New OleDbCommand("SELECT * FROM [Notice]", Cn)
                Cn.Open()
                Dim dr4 As OleDbDataReader = cmd4.ExecuteReader(CommandBehavior.CloseConnection)
                If dr4.HasRows = True Then '참고(레코드갯수가 0 보다 크면
                  dr4.read()  <=== 해줘야 읽을수있다
       방법3=============================
                If GridView1.Rows.Count > 0 Then

■ 레코드(존재)갯수 반환2
    "select count ....?


■ 레코드 존재 여부
Dim cmd2 As OleDbCommand = New OleDbCommand("SELECT * FROM [ORDERS] where (요청사원사번 = '" + Session("USERID") + "')  and (공지 = 3) ORDER BY  wDATE DESC;", Cn)
            Cn.Open()
            Dim dr2 As OleDbDataReader = cmd2.ExecuteReader(CommandBehavior.CloseConnection)
            If dr2.HasRows = True Then
                LblAnswer.Text = "(답글도착)"
            End If






■ 디렉터리 와 파일 만들기 & 복사
   Dim fInfo1 As New FileInfo(Me.MapPath("빈DATA\" + "DATA.mdb")) 
   fInfo1.CopyTo(Me.MapPath("App_Data\" + TextBox1.Text + ".mdb"), False) - 파일복사
   File.CreateText((Me.MapPath("MsgBox\" + TextBox1.Text) - 파일만들기
   Directory.CreateDirectory(Me.MapPath("PIC\" + TextBox1.Text)) - 디렉터리만들기
              
■ 파일만들거나쓰기/ 파일쓰기
       Dim path As String = "c:\temp\MyTest.txt"
        If File.Exists(path) = False Then
            ' Create a file to write to.
            Dim sw As StreamWriter = File.CreateText(path)
            sw.WriteLine("Hello")
            sw.WriteLine("And")
            sw.WriteLine("Welcome")
            sw.Flush()
            sw.Close()
        End If


■  1. Server.MapPath

Server.MapPath(".") returns the current physical directory of the file (e.g. aspx) being executed
Server.MapPath("..") returns the parent directory
Server.MapPath("~") returns the physical path to the root of the application
Server.MapPath("/") returns the physical path to the root of the domain name (is not necessarily the same as the 




        
      



■  한글깨짐방지
   <!--한글깨짐방지-->
    <globalization requestEncoding="euc-kr" responseEncoding="euc-kr" fileEncoding="euc-kr" /> ==> 영어는정상이지만 한글은깨짐
    <globalization requestEncoding="UTF-8" responseEncoding="UTF-8" fileEncoding="UTF-8"/> ==> 영어,한글 다정상


또다른방법 http://www.hoons.net/Board/QAASPNET/Content/41513

최후방법 :기존텍스파일복사할것 이유모름

■ 자바스크립트 소스에 사용방법(정상작동)
   
   //vb
   //page_load 함수에 넣습니다.
   Me.uploadedfiles0.Attributes.Add("onchange", "fnChange();")
 
   //html/aspx
   //javascript 추가
  <script type="text/javascript">
         function fnChange() {
             alert("change");
             return;
         }
     </script>   

     하면 uploadedfiles0 에 체인지 이벤트가 발생하면 fnChange 함수가 실행됨

■ 자바스크립트 자동실행 되게  window.onload = function () 이용
   
   <script type="text/javascript">
        window.onload = function () {
            window.location.assign("https://www.w3schools.com")
        }
    </script>
    <script type="text/javascript">
      window.onload = function () { alert("ccc"); }
      $(document).ready(function () { alert("aaa"); });
	  $(document).ready(function () { alert("bbb"); });
    </script> 

■ 뒤로가기(페이지로드에..)
 Me.ImgBtn_Exit.OnClientClick = "javascript:window.history.go(-1);return false;"


■ 자바스크립트(뒤로이동)
   Response.Write("<script>alert('사용자가 많습니다 잠시 후 이용하세요');</script>");
  Response.Write("<script>history.back(-2)</script>");

■ 자바스크립트 (오른쪽마우스금지)<== 이방법은 구글 마우스잠금 푸는 유틸로뚫린다. 아래방법으로 보완가능함
aaa.js 파일을 만들어 않에 넣음
   document.oncontextmenu = function () { return false; }
   document.onselectstart = function () { return false; }
   document.ondragstart = function () { return false; }

 (실행) - master 에넣으면 안먹힘 각 소스코드에 넣을것
  <title></title>
   <%--<script src="../mouseban99.js" language="javascript" type="text/javascript" charset='euc-kr'></script>  --%>

 <title></title>
      <script src="../MouseLock.js" language="javascript" type="text/javascript" ></script>

■ 자바스크립트 (오른쪽마우스금지)<==구글유틸도막음
 <script type="text/javascript"  language="JavaScript">
<!--
       function click() {
           if ((event.button == 2) || (event.button == 3)) {
               alert('오른쪽 마우스는 사용할 수 없습니다.');
           }
       }
       document.onmousedown = click

       if (navigator.appName == "Netscape") {
           document.captureEvents(Event.MOUSEDOWN)
           document.onmousedown = checkClick

           function checkClick(ev) {
               if (ev.which != 1) {
                   alert('오른쪽 마우스는 사용할 수 없습니다.')
                   return false
               }
           }
       }
// -->
</script>

■ 코드에서 자바스크립트명령 연속해서 쓰기
    Response.Write("<script language = 'javascript'> alert('사번은 반드시 입력해야 됩니다.'); history.back()  </script>")
    위와같이 해주게 되면 메시지박스가 출력되고 바로 페이지를 원위치로 옮긴다.
■ 자바관련
    - 비하인드코드에서 자바스크립트사용 :
       Protected Sub Button2_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Button2.Click
         // <form> 태그 뒤에 include되는 자바스크립트 파일 포함    
           1. ClientScript.RegisterClientScriptInclude(GetType(Page), "script", MapPath("./mouseban.js"))
         // <form> 태그 뒤에 자바스크립트 포함
           2. ClientScript.RegisterClientScriptBlock(typeof(Page), "script1", "<script>test('test1');</script>")
         // </form> 태그 앞에 자바스크립트 포함
           3.ClientScript.RegisterStartupScript(typeof(Page), "script2", "<script>test('test2');</script>")
       End Sub
    
     [js 파일불러오는거 제대로되는것 http://msdn.microsoft.com/ko-kr/library/kx145dw2(v=vs.100).aspx]
 
       ' Define the name, type and url of the client script on the page.
        Dim csname As String = "ButtonClickScript"
        Dim csurl As String = "~/mouseban99.js"
        Dim cstype As Type = Me.GetType()

        ' Get a ClientScriptManager reference from the Page class.
        Dim cs As ClientScriptManager = Page.ClientScript

        ' Check to see if the include script is already registered.
        If (Not cs.IsClientScriptIncludeRegistered(cstype, csname)) Then
            cs.RegisterClientScriptInclude(cstype, csname, ResolveClientUrl(csurl))
        End If



    - 소스코드에서 사용 : (js코드불러오기)
      <head runat="server">
      <title></title>
      <script src="../mouseban99.js" language="javascript" type="text/javascript" charset='euc-kr'></script>
      </head>
       * 한글깨짐 방지 charset='euc-kr
         
          [소스보기 코드]
          ...
           <form name="form1" method="post" action="WebForm2.aspx" id="form1">
           <div>
             <input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwULLTE2MTY2ODcyMjlkZL22/OKqbu9X9AK4DAtdxYHrs6Rj" />
           </div>
           <script src="http://localhost/test.js" type="text/javascript"></script>
           <script>test('test1');</script>
    
    
            <script>test('test2');</script>
            </form>
            단.. 유념해야할 사항은 여는 form태그에 뒤에 생성되냐 닫는 form 태그 앞에 생성되냐에
            따라 정상적으로 실행되는 자바스크립트가 있을수도 있지만 html이 생성되지 않은 컨트롤에
            접근하는 코드가 존재하면 오류가 발생할 수도 있다.

■ 비하인드코드에서 자바스크립트사용 :
    Button1.OnClientClick = "CallPrint()"

■ 비하인드코드 버튼으로 자바스크립트js파일 불러오기
    <script type="text/javascript" src="AlimTok.js""></script>
   ScriptManager.RegisterClientScriptBlock(Me.Page, Me.[GetType](), Nothing, "ALIMTOK_to_Customer()", True)


■ 자바스크립트에서 asp.net 비하인드 코드 실행 ...http://darkangelus.tistory.com/60

<script type="text/javascript">
        function test() {
            <%= Page.GetPostBackEventReference(btnTest) %>;
        }
</script>
<input type="button" onclick="test();" value="test" />
<asp:Button ID="btnTest" runat="server" style="display:none;" onclick="btnTest_Click" />

protected void btnTest_Click(object sender, EventArgs e)
{
    ......
}



■ 자바스크립트에서 로컬 파일 실행

http://www.seobangnim.com/zbxe/33662008.04.08 11:05:21 (*.187.147.54) 9326
<script type="text/javascript">
    var objWSH = new ActiveXObject("WScript.Shell");
  // 노트패드 실행
    var retval = objWSH.Run("c:\WINDOWS\system32\notepad.exe",1,false);

 
  // 탐색기 실행
    //var retval = objWSH.Run("c:\WINDOWS\explorer.exe",1,false);
</script>


■ 비하인드코드에 자바스크립트 코딩
void Page_Load(object sender, EventArgs e) 
{ 
    SetFocus("textBox1"); 
} 
void SetFocus(String ctrlID 
{ 
    System.Text.StringBuilder sb = new System.Text.StringBuilder(); 
    sb.Append("<script>"); 
    sb.Append("document.getElementById('" + ctrlID + "').focus();"); 
    sb.Append("</script>"); 
    Page.RegisterStartupScript("FocusScript", sb.ToString()); 
}


If True Then
    Dim sb As System.Text.StringBuilder = New System.Text.StringBuilder()
    sb.Append("<script>")
    sb.Append("document.getElementById('" & ctrlID & "').focus();")
    sb.Append("</script>")
    Page.RegisterStartupScript("FocusScript", sb.ToString())
End If

■ 질문 메시지박스 [정상작동]********************************************************


-  Response.Write("<script language = 'javascript'>alert('샘플교재입니다. 010-5248-2870 으로 문의 바랍니다.')</script>")로 정상작동 안할때(참고주소:http://stackoverflow.com/questions/15196381/display-messagebox-in-asp-net )

 Dim script As String = "alert(""Hello!"");"
                        ScriptManager.RegisterStartupScript(Me, [GetType](), "ServerControlScript", script, True)


   [ HTML Markup] 부분
   <html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <script type = "text/javascript">
        function Confirm() {
            var confirm_value = document.createElement("INPUT");
            confirm_value.type = "hidden";
            confirm_value.name = "confirm_value";
            if (confirm("Do you want to save data?")) {
                confirm_value.value = "Yes";
            } else {
                confirm_value.value = "No";
            }
            document.forms[0].appendChild(confirm_value);
        }
    </script>
</head>
<body>
    <form id="form1" runat="server">
      <asp:Button ID="btnConfirm" runat="server" OnClick = "OnConfirm" Text = "Raise Confirm" OnClientClick = "Confirm()"/>
    </form>
</body>
</html>

[ 비하인드코드] 부분
   C#
public void OnConfirm(object sender, EventArgs e)
{
    string confirmValue = Request.Form["confirm_value"];
    if (confirmValue == "Yes")
    {
        this.Page.ClientScript.RegisterStartupScript(this.GetType(), "alert", "alert('You clicked YES!')", true);
    }
    else
    {
        this.Page.ClientScript.RegisterStartupScript(this.GetType(), "alert", "alert('You clicked NO!')", true);
    }
}
 
VB.Net
Protected Sub OnConfirm(sender As Object, e As EventArgs)
        Dim confirmValue As String = Request.Form("confirm_value")
        If confirmValue = "Yes" Then
            ClientScript.RegisterStartupScript(Me.[GetType](), "alert", "alert('You clicked YES!')", True)
        Else
            ClientScript.RegisterStartupScript(Me.[GetType](), "alert", "alert('You clicked NO!')", True)
        End If
End Sub

■버튼에 confirm 넣기
  Button1.Attributes("onclick") = "if(!confirm('do you love me ?')){ return alert('쥐소선택.');};{ return alert('찬성선택.');};" 

■ 메시지박스 삭제여부 묻기 (정상작동함: 워크보드에적용)
    - 소스코드에 작성
       <asp:ImageButton ID="ImgBtn_Delete" runat="server" ImageUrl="~/버튼/삭제.png" 
                    Visible="False" OnClientClick="return confirm('정말 삭제하시겠습니까?');" 
                    onclick="ImgBtn_Delete_Click" />
    - 비하인드코드에 작성
        Dim script As String = "<script>alert('확인을 클릭하셨네요!!');</script>"
        Page.ClientScript.RegisterClientScriptBlock(GetType(String), "confirm", script)

    - 닷넷코딩
      ClientScript.RegisterStartupScript(Me.[GetType](), "alert", "alert('보류 사유를 전달하지 않았습니다.')", True)

■ 자바스크립트사용한 메시지박스 묻기
    소스에는 자바형식코딩
    비하인드에는 Response.Write("<script language = 'javascript'> alert('회원이 아닙니다.') </script>")
   ((삭제여부묻기))
     Response.Write(
                 <script language="javascript">
                    cancel = confirm("삭제하시겠습니까?")
                    if (cancel == true) Response.write("삭제되었씁니다.")
                   Else : Response.write("취소되었씁니다.")
                 </script>)


    *소스에 코드사용 HTML 컨트롤을 놓고 더블클릭


	소스코드에서 메시지박스 띄우기
	<asp:ImageButton ID="ImgFile" runat="server"  ImageUrl="~/IMAGE/Book_Error.png" 
     onclientclick="javascript:alert('아래 보기에서 정답을 클릭하세요!');"/> 
    - 두번 연속 실행
	onclientclick="history.back();javascript:alert('수고하셨습니다. 답안을 정상적으로 선생님께 제출 하였습니다!');" />

■ 자바스크립트이용하여 사운드재생  2014년11월21일 http://www.aspsnippets.com/Articles/Play-WAV-sound-files-in-ASP.Net-using-JavaScript.aspx
   (크롬외에 다른브라우저에서 잘됨)  
 <html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
    <script type="text/javascript">
        var soundObject = null;
        function PlaySound() {
            if (soundObject != null) {
                document.body.removeChild(soundObject);
                soundObject.removed = true;
                soundObject = null;
            }
            soundObject = document.createElement("embed");
            soundObject.setAttribute("src", "sounds/sound.wav");
            soundObject.setAttribute("hidden", true);
            soundObject.setAttribute("autostart", true);
            document.body.appendChild(soundObject);
        }
    </script>
</head>
<body>
    <form id="form1" runat="server">
        <input type = "button" onclick = "PlaySound()" value = "Play Sound" />
    </form>
</body>
</html>

■ 사운드재생(서버에서만됨)
Dim s As System.Media.SoundPlayer = New System.Media.SoundPlayer()
        s.SoundLocation = Server.MapPath("~/STUDYROOM/디로그/" + LblPath.Text + "/" + "001.wav")
        s.PlaySync()
■ 비하인트코드에서 자바스크립트함수 실행 2014년11월21일 http://luckey.tistory.com/115
   ScriptManager.RegisterClientScriptBlock(Me.Page, Me.[GetType](), Nothing, "PlaySound()", True)
 *PlaySound() 는 소스코드에 코딩되어있는 자바함수명

■ asp.net 파일다운로드받는방법 (http://blog.daum.net/sobakcc/8436162)
   <a href ="javascript:void(window.open('page1.aspx?filename=http://ddoksori.codns.com:8080/WORKBOARD/DOC/매매계약서.hwp','preview','width=200,height=200,scrollbar=no,toolbars=no'));">다운로드</a>

■ 파일 및 폴더 복사,삭제 및 이동..
    http://msdn.microsoft.com/ko-kr/library/cc148994.aspx

■ 페이지 여백 주기    
    <style type="text/css">
          body{
	margin-left: 0px;
            width: 360px;
        </style>


■ 텍스트박스 투명하게
transparent
#BDE3F7
■ 경로설정 Server.MapPath("./doc/매매계약서.hwp")

   
■ TRIM(공백제거)
    var trimmedStringVar = myString.trim();

■ 파일업로드 다운로드
출처 :
http://hoons.kr/board.aspx?Name=QAASPNET&BoardIdx=16007&Page=1&Mode=2
 
업로드 로직
 
/// <summary>
/// 파일을 서버에 저장하는 함수
/// </summary>
/// <param name="fu">파일 업로드 객체</param>
/// <param name="upDir">파일이 저장될 서버상의 경로</param>
/// <returns></returns>
public string saveFile( FileUpload fu, string upDir )
{
　　//서버에 디렉토리가 존재하는 확인하고 디렉토리가 없다면 디렉토리 생성
　　DirectoryInfo dInfo = new DirectoryInfo(upDir);
　　if (!dInfo.Exists)
　　{
　　　　dInfo.Create();
　　}
 
　　 //새로 업로드 할 파일과 동일한 파일명이 서버에 존재 할 경우
　　//파일명에 언더바(_)와 함께 순서 번호를 붙여서 파일 중복을 피한다.
　　string fileName = fu.FileName; //클라이언트 측 파일 경로가 제거된 순수 파일명
　　string fileFullName = upDir + fileName; //업로드될 서버측 경로와 파일명
　　FileInfo fInfo = new FileInfo(fileFullName);
 
　　string newFileName = string.Empty; //파일 중복을 피하기위해 새로 생성된 파일명
 
　　//서버에 같은 이름의 파일이 존재 하는지 확인
　　if (fInfo.Exists)
　　{
　　　　//같은 이름의 파일이 있다면
　　　　int fIndex = 0; //파일 순서
　　　　string fExtension = fInfo.Extension; //파일의 확장자 추출
　　　　string fRealName = fileName.Replace(fExtension, ""); //파일명의 확장자 제거
　　　　//파일명이 중복되지 않을때까지 루프를 돌면서 검사
　　　　do
　　　　{
　　　　　　fIndex++;//파일 번호 증가
　　　　　　//새로운 파일 이름 (확장자 제거된 파일명 + _ + 순서번호 + 확장자)
　　　　　　newFileName = fRealName + "_" + fIndex.ToString() + fExtension;
　　　　　　//새로운 파일 이름으로 파일정보 생성
　　　　 　　fInfo = new FileInfo(upDir + newFileName);
　　　　} while (fInfo.Exists); //파일이 존재 한다면 다시 반복
 
　　　　fileFullName = upDir + newFileName; //서버측 업로드 경로 + 새로운 파일명

　　　　fu.PostedFile.SaveAs(fileFullName); //만들어진 경로와 파일명으로 파일을 서버측에 업로드
 
　　　　return newFileName; //새로 만들어진 파일명 만 반환
　　}
　　else
　　{
　　　　//같은 이름의 파일이 없다면
　　　　fu.PostedFile.SaveAs(fileFullName); //최초 정해진 경로와 파일명으로 서버측에 업로드
 
　　　　return fileName; //파일명 반환
　　}
}
 
다운로드 로직
 
/// <summary>
/// 파일 다운로드 하기
/// </summary>
/// <param name="fileName">다운로드할 파일명</param>
/// <param name="fileDir">파일이 위치한 서버측 경로</param>
protected void downFile( string fileName, string fileDir )
{
　　string downPath = fileDir + fileName;
 
　　if ( File.Exists( downPath ) )
　　{
　　　　Response.Clear();
 
　　　　Response.AddHeader("Content-Disposition", "attachment;filename="
　　　　　　　　　　　　　　　　　　　　　　　　　+ Server.UrlEncode( fileName ).Replace( "+", "%20" ) );
 
　　　　Response.ContentType  =  "application/octet-stream";
 
　　　　Response.TransmitFile( downPath );
               
                Response.End()
　　}
}
 
[출처] ASP.net 파일 업로드 다운로드 |작성자 라케시스

■ 파일싸이즈구하기 http://ndolson.com/1362
   FileInfo fInfo = new FileInfo(파일의 경로+파일명);
string strFileSize = GetFileSize(fInfo.Length);

private string GetFileSize(double byteCount)
        {
            string size = "0 Bytes";
            if (byteCount >= 1073741824.0)
                size = String.Format("{0:##.##}", byteCount / 1073741824.0) + " GB";
            else if (byteCount >= 1048576.0)
                size = String.Format("{0:##.##}", byteCount / 1048576.0) + " MB";
            else if (byteCount >= 1024.0)
                size = String.Format("{0:##.##}", byteCount / 1024.0) + " KB";
            else if (byteCount > 0 && byteCount < 1024.0)
                size = byteCount.ToString() + " Bytes";

            return size;
        }

참고사이트 : http://www.vcskicks.com/csharp_filesize.php

■ 파일크기
   'If FileUpload1.PostedFile.InputStream.Length > "40960" Then - 바이트단위
 
■ 자리수맞추기
    int aa = 3;
   str = string.format("{0:000}",aa);
   결과 = 003


 
■ 자리수콤마찍기 (금액표시) 원 \ 표시포함

LblTotalPrice.Text = "&#8361;" & String.Format("{0:n0}", TotalPie)


    int testNum = 1000;
    testNum  = "&#8361;" & String.Format("{0:n0}", testNum );

	string rtvCurrency = string.Format("{0:#,0}", intValue);
    
	1. int won = 123456890;

2. Console.WriteLine(string.Format("{0:n0}", won));

3. Console.WriteLine(string.Format("{0}", won.ToString("n0"))); ;

4. Console.WriteLine(string.Format("{0:#,##0}", won));

5. Console.WriteLine(string.Format("{0}", won.ToString("#,##0")));

6.

7. //결과

8. //123,456,890

9. //123,456,890

10. //123,456,890

11. //123,456,890



출처: http://lincat.me/147 [고기는 오직 굽기용]
	
■ asp.net 금액을 한글로 표시하기 http://blog.daum.net/powersoccer/12102634

■ 한글금액표시방법
[RE] 숫자 금액을 한글금액 표시방법?	김영환	평점: 10.0/10 (1명 참여)	조회: 4938
재귀 함수를 써도 되고 그냥 함수내에 루핑해도 되고~ 방법은 여러가지 인듯 하지만 저는 빨리 개발 해야한다는 핑계로 대충~ 쿨럭~
 
기왕이면 재귀함수로 깔끔하게 다시 개발 해보세요. ㅡㅡ;;
 
private string ConvertToCurrencyKr(int input)
    {
        ArrayList inputData = new ArrayList();
        string[] numberKeArray = { "", "", "이", "삼", "사", "오", "육", "칠", "팔", "구" };
        string[] currencyLocalKrArray = { "천", "백", "십", "" };
        string[] currencyKrArray = new string[] { "", "만", "억", "조", "경", "해" };
        string inputString = input.ToString();
        string returnString = string.Empty;
        // TODO 구획 나누기
        int explodeLen = (int)Math.Floor((double)inputString.Length / 4.0);
        // TDO 구획 처리 후 잔여갯수
        int surplusLen = inputString.Length - (4 * explodeLen);
        // TODO 배열에 구획구분된 데이터 담기
        if (surplusLen > 0) inputData.Add(inputString.Substring(0, surplusLen));
        for (int i = 0; i < explodeLen; i++)
            inputData.Add(inputString.Substring((i * 4) + surplusLen, 4));
        // TODO 0단위 부터 시작하기 위해 배열 역정렬
        inputData.Reverse();
        // TODO 한글 변환 시작
        for(int i=0; i < inputData.Count; i++)
        {
            string blockData = string.Empty;
            string currentData = inputData[i].ToString();
            for (int j = 0; j < currentData.Length; j++)
            {
                int data = Convert.ToInt32(currentData[j].ToString());
                if (data > 0)
                {
                    blockData += numberKeArray[Convert.ToInt32(currentData[j].ToString())];
                    blockData += currencyLocalKrArray[j];
                }
            }
            blockData += currencyKrArray[i];
            returnString = blockData + returnString;
        }
        return returnString;
    }

	       
■ 쿠키
    - Response.Cookies("PAGE").Value = 1
        Response.Cookies("PAGE").Expires = DateTime.Now.AddDays(-1) -> 이렇게 하면 페이지 로드(종료)시 쿠키값버림

     - http://www.mkexdev.net/Article/Content.aspx?parentCategoryID=1&categoryID=11&ID=246 -클라이언트 쿠키 사용여부 체크


■ 쿠키(cookies) - http://blog.danggun.net/1086 출처
1.쿠키 굽기쿠키쯤이야 쉽게 구울수 있습니다.
   Response.Cookies["Test"].Value = "요~"; 
   Response.Cookies["Test"].Expires = DateTime.Now.AddDays(1); 

   이렇게 쿠키굽는게 쉽다닁!(현실에서도 쉬우면 좋을텐데 말이죠-_-;)

   'Expires'로 쿠키의 수명을 지정할수 있습니다.
   쿠키의 수명을 지정하지 않으면 세션과 함께 바이바이~~

2.쿠키 읽기이렇게 쉽게 구운 쿠키는 쉽게 읽을수 있습니다.

   string sTemp = Response.Cookies["Test"].ToString(); 
   //위 코드로 읽어지지 않는다면 아래 코드로 시도해 본다. 
   string sTemp = Server.HtmlEncode(Response.Cookies["Test"].Value); 

3.쿠키 지우기필요가 없는 쿠키는 그때그때지우는것이 여러가지면에서 좋죠.
   보안이라던가...용량이라던가..
  직접 삭제할수는 없고 만료날짜를 오늘보다 이전으로 하여 삭제할수 있습니다.
  Response.Cookies["Test"].Expires = DateTime.Now.AddDays(-1); 

■ 모바일 사이트 접속하면 주소창 자동으로 없애는 스크립트
    <title></title>
<s-ript type="text/javas-ript" language = "javas-ript">
window.addEventListener('load', function() {
setTimeout(scrollTo, 0, 0, 1);
}, false);
</script>
그러나 안드로이드에서 오동작 하는 경우를 살펴본바 body 의 height가 디바이스 height 보다 작은 페이지의 경우 숨기기가 되지 않는다. 그래서 body의 height를 살짝 늘리는 코드와 scroll를 제어 하는 코드를 같이 넣었다.

결과는 대만족



반영 코드

// 주소창 없애기


window.addEventListener('load', function(){

    document.body.style.height = (document.documentElement.clientHeight + 5) + 'px';

    window.scrollTo(0, 1);

}, false);

■ 모바일에서 이미지 크기 조절하기: 큰 이미지 줄이기.
내가 가진 지식으로는 모바일에서 그림 크기를 조절하기가 참 만만치 않았다.
쿠키(cookie)를 이용해서 브라우저 너비(width)를 서버로 보냈다가 처리하는 방법을 써 보았지만 마땅치 않았다.

그런데.....

간단한 방법이 있었네...

div를 이용하면 그냥 해결됨....

위의 두 이미지는 아래와 같은 코드로 뿌린 것임. div에 style 처리하면 됨...

<div style="width:360px;">
<img width=100% src="FILES/066/jinsuk.977.Cheju_Horses.jpg">
</div>

<div style="width:50%">
<img width=100% src="FILES/066/jinsuk.977.Cheju_Horses.jpg">
</div>

360픽셀 이하의 작은 이미지는 div를 사용하지 않고, img에서는 width 속성을 없애버리면 됨


■ 모바일인지 PC인지구분하여 페이지표시 (http://detectmobilebrowsers.com/) - 사용자에이젼트감지
[asp.net]
Dim u As String = Request.ServerVariables("HTTP_USER_AGENT")
Dim b As New Regex("(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino", RegexOptions.IgnoreCase)
Dim v As New Regex("1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-", RegexOptions.IgnoreCase)
If b.IsMatch(u) Or v.IsMatch(Left(u, 4)) Then Response.Redirect("http://detectmobilebrowser.com/mobile")

(참고 타블릿) http://our.umbraco.org/forum/templating/templates-and-document-types/18616-detecting-mobile-and-tablets


■ 업데이트/ 삭제/ 저장 
   '=== 디자인모드에서 설정하는방법(그리드에 삭제버튼 생성할때) ===    
   ADSMYBOOK 컨트롤 선택하고 속성에서 
   * DeleteQuery = DELETE FROM MYBOOK WHERE ID = @ID 코딩후에 아래 이벤트에 처리
      Protected Sub GrdMYBOOK_RowDeleted(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewDeletedEventArgs) Handles GrdMYBOOK.RowDeleted
        ADSMYBOOK.SelectCommand = "SELECT * FROM [MYBOOK] where 회원번호 = '" + LblNo.Text + "' order by ID desc "
        GrdMYBOOK.DataSourceID = "ADSMYBOOK"
      End Sub
     
   * SelectQuery = SELECT * FROM [MYBOOK]


    '=== 비하인드코드에 직접 코딩하는방법 (삭제버튼 별도 생성할때) ====
            ADS_Custom.InsertCommand = "INSERT INTO customer (ID,  이름, 거래처명, HP, email, 등록사원) VALUES ( '" + Session("USERID") + "', '" + TxtCustom.Text + "', '" + TxtCustom0.Text + "' , '" + Replace((TxtCustom1.Text.Trim()), "-", "") + "', '" + TxtCustom2.Text + "',  '" + Session("USERNAME") + "')"
            ADS_Custom.Insert()
    
            ADSHAKSUB.UpdateCommand = "UPDATE MYBOOK SET 점수 = '30' WHERE (회원번호 = '" + lblSNO.Text + "') AND (BOOKNAME = '" + BOOKname + "')"
            ADSHAKSUB.Update()

           ADS_Custom.DeleteCommand = "DELETE FROM customer WHERE (HP = '" + TxtCustom1.Text + "') AND (이름 = '" + TxtCustom.Text + "') "
           ADS_Custom.Delete()

   '======= 컨트롤 사용없이 삭제 ===========
        cmd = New OleDbCommand("DELETE from ORDERS where SEQ = " + seq + "", cn)
        cn.Open()
        cmd.ExecuteNonQuery()
        cn.Close()
      --  저장 : cmd = New OleDbCommand("INSERT INTO ORDERS (wDATE, wTIME, 구분, 담당사원사번, 담당사원명, 요청사원사번, 요청사원명, 업무분류, 요청내용, 처리여부, 중요도, 첨부파일) values ('" + Date.Today + "', '" + TimeOfDay + "', '" + RdoBtnLst.SelectedValue + "', '" + S1 + "' , '" + S2 + "' ,'" + Session("USERID") + "' ,'" + Session("USERNAME") + "' , '" + TxtTitle.Text + "', '" + TxtDetailODR.Text + "', '대기중', '" + RadioButtonList.SelectedValue + "', '" + SAVFileNAME + "')", cn)
      -- 업데이트 : cmd = New OleDbCommand("UPDATE ORDERS SET 처리여부='처리완료', pDATE = '" + Now + "'  where SEQ = " + seq + "", cn")
           cmd.ExecuteNonQuery()
      
■ seq를 이용한 데이타삭제방법: ADS_Custom.DeleteCommand = "DELETE FROM customer WHERE SEQ = " + sSEQ + "" 

■ 레코드업데이트시 No value given for one or more required parameters 에러
    입력 변수에 문자는 '~' 를 붙혀준다
   예) Dim cmd As OleDbCommand = New OleDbCommand("UPDATE ORDERS SET 처리사유='" + TextBox1.Text + "' where SEQ = " + SEQ + "", cn)

■ 문자열검색
    A = "소스문자열".IndexOf("문자열")
■ 대소문자
    TxtBoxSN.Text.ToUpper

■ 특정문자열포함
   string sourceText = "my name is lemon";
   string compareText = "Lemon";
    if (sourceText.IndexOf(compareText, StringComparison.OrdinalIgnoreCase) >= 0)
       {
          Console.WriteLine("exists!");
        }
■ 배열변수선언 (http://ihelpers.x2soft.co.kr/programming/lec.php?CMD=print&IDX=126&source=overture)
   Dim jumsu As String() = New String(5) {} 

■ 핸드폰화면크기에맞춤 (http://tiger5net.egloos.com/5675737)
<meta name="viewport" content="width=device-width, height=device-height, user-scalable=no,initial-scale=2,maximum-scale=1.0,minimum-scale=1.0" />


<!-- 화면사이즈 -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" /> 

<!-- 홈 화면에 바로가기 만들었을 경우 주소 입력창 없애기 -->
<meta name="apple-mobile-web-app-capable" content="yes" />




1. viewport 란 무엇인가?http://aboooks.tistory.com/352

*20160316 참고
  이미지를 화면에 딱맞게 나오게 하려면 style="width: 100%"  해준다
 <div ><img alt=""  src="http://124.5.48.144:8080/w/HELP/image/workboard/Docu.png" style="width: 100%" /></div>

  maximum-scale=1 해주면 화면 크기 리사이징 안된다




스마프트폰은 기종별로 화면 크기가 다르다. 그렇다고 모든 단말기에 맞추어서 전용 버전을 개발해야 하는 것은 아니다. 화면 사이즈에 맞추어서 표시해주는 'ViewPort' 라는 기능을 이용하면 된다.

<meta> 태그로 ViewPort를 지정하면 자동으로 크기가 조절되는 기능이다.

 
2. viewport 사용법 ( <title></title> 윗쪽에코딩)

표시 화면의 크기, 확대/축소 허용, 초기 표시 배율을 <meta> 태그에서 지정 할 수 있다.
<meta name="viewport" content="속성1=값1, 속성2=값2,..." />
 
VIewPort 속성
 속성
기능 
 width 너비(픽셀)
 height 높이(픽셀) 
 initial-scale 초기 배율(기본 꽉 찬 화면) 
 minimum-scale 최소 배율(기본값: 0.25, 범위:0~10.0)
 maximum-scale 최대 배율(범위:0~10.0) 
 user-scalable 확대/축소 여부 (yes/no)

(네이버에사용된뷰포트)
<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0">

■ 웹페이지 크기를 모바일 장치에 맞게 자동 조절하기

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, target-densitydpi=medium-dpi" />
user-scalable=no : 사용자의 확대보기 허용 여부(no/yes)
initial-scale=1.0  : 페이지 로딩 시 확대비율
maximum-scale=1.0  : 최대 확대 비율
minimum-scale=1.0  : 최소 축소 비율
width=device-width : 플랫폼 가로 크기에 맞춤, 수치를 넣으면 그 수치에 맞게 맞춰짐.
target-densitydpi=medium-dpi : dpi([dots per inch])를 맞춤. 일반적으로 medium-dpi로 하는게 좋음. (device-dpi/low-dpi/medium-dpi/high-dpi)

<meta name="viewport" content="width=device-width, height=device-height, user-scalable=no,initial-scale=2,maximum-scale=1.0,minimum-scale=1.0" />


■ <!-- 화면깜빡임 방지 메타테그 아래두줄 -->
<meta http-equiv= "page-Enter" content="blendTrans(Duration=0.0)" />
<meta http-equiv= "page-Exit" content="blendTrans(Duration=0.0)" />

■ 자신의창닫기/페이지닫기
    Page_load() 에 아래 추가하면 끝~!!!
        if (!IsPostBack)
        {
            Button1.Attributes.Add("onclick", "window.close();");
        }
 

■ MapPath 와 Server.MapPath 의 차이점  
   MapPath = c:\inetpub\wwwroot\..으로 
   Server.MapPath = 

■ Server.MapPath(".") : C:\inetpub\wwwroot\GONGBUBANG\"
   Server.MapPath("\") : C:\inetpub\wwwroot\"
   
   예) Server.MapPath(".") & ("\IMAGE\" & Session("LTD")) = Server.MapPath("." & "\IMAGE\" & Session("LTD"))


■ 파일생성없이쓰기(파일이없으면 자동생성됨)
       Dim sw As StreamWriter = New StreamWriter(MapPath("~/DATA/login.txt"), True) => true 추가로씀 , false 덮어씀

        sw.WriteLine("로그인시간 : " & DateTime.Now & " : " & TxtNAME.Text, TRUE) '뒤에 TRUE 하면 추가입력
       (sw.WriteLine 하면 세로로 , sw.Write 하면 가로로 연결해서 씀)
        sw.Close()




■ 파일생성하고쓰기
       [로컬에생성]
        Dim PATH As String = "C:\\DlogErr\TEST1.TXT"
        Dim sw As StreamWriter = File.CreateText(PATH)

        sw.WriteLine("에러")
        sw.Close()
        [서버에생성]
        Dim sw As StreamWriter = File.CreateText(MapPath("~/DATA/test.txt"))

        sw.WriteLine("에러")
        sw.Close()

        *주의:폴더에서 쓰기 권한줄것

■ 텍스트파일읽어올때한글깨짐방지(잘됨)
    Dim sr As StreamReader = New StreamReader(MapPath("~/MsgBox/1로그온.txt"), Encoding.Default, True)
                Dim strEND As String = (sr.ReadToEnd)
                TxtDetailODR.Text = (strEND)
                sr.Close()
 
■ 파일읽기
          Dim sr As StreamReader = New StreamReader(MapPath("~/DATA/notice/" & TxtNAME.Text & ".txt"))
            Dim strEND As String = sr.ReadToEnd
            Label2.Text = strEND
            sr.Close()

			한글깨질경우
			Dim encode As Encoding = System.Text.Encoding.GetEncoding("ks_c_5601-1987")
            Dim sr As StreamReader = New StreamReader(MapPath("~/DELIVERY/" & ViewState("getLTD") & "\LOGIN.txt"), encode)

■ 폴더안의 파일갯수 가져오기
    imports system.io
	Dim count As Integer = 0
    For Each d As String In Directory.GetFiles(folderpath)

        If Path.GetExtension(d) = ".mdb" Then
            count += 1
        End If
    Next
    Return count


■ 폴더의 파일 목록 읽어오기
Dim di As New DirectoryInfo("C:/inetpub/wwwroot/GONGBUBANG_FILE/" + LblPath.Text + "/")
                For Each fi In di.GetFiles()
                    ListBox1.Items.Add(fi.Name)
                Next
           

■ 폴더의 파일 목록 배열로 특정파일만 읽어오기 http://lotionz.tistory.com/26
''***** 지정된 폴더에서 특정 이미지 파일만 찾아온다.
                'Dim DataFileNM As String()
                'Dim exts As String() = {".png", ".jpg", ".gif"}
                'DataFileNM = Directory.GetFiles("C:/inetpub/wwwroot/GONGBUBANG_FILE/" + LblPath.Text + "/", Label1.Text + ".*", SearchOption.TopDirectoryOnly).Where(Function(s) exts.Contains(Path.GetExtension(s), StringComparer.OrdinalIgnoreCase)).ToArray
              
                'Exit Sub
				------------------------------------------------------------------------------
				If DataFileNM.Length > 0 Then
                   ImgFile.ImageUrl = Session("strIP") + Mid(DataFileNM(0), 19)
				Else '마지막페이지에서 다시 첫페이지로 이동
					Label1.Text = String.Format("{0:000}", Val(Label1.Text) - 1)
				End If

				Dim DataFileNM As String()
                Dim exts As String() = {".gif", ".png", ".jpg", ".mp4"}

                DataFileNM = Directory.GetFiles(Server.MapPath("./IMAGE_MENU/"), SltMnu + ".*", SearchOption.TopDirectoryOnly).Where(Function(s) exts.Contains(Path.GetExtension(s), StringComparer.OrdinalIgnoreCase)).ToArray

                If DataFileNM.Length > 0 Then
                    ImgMenu.ImageUrl = "./IMAGE_MENU/" & Mid(DataFileNM(0), 34)
                    'Response.Write("<script langu age = 'javascript'>alert('" + Mid(DataFileNM(0), 34) + "' )</script>")
                Else
                    ImgMenu.ImageUrl = "./IMAGE/noimg.png"
                End If


■ 주민등록번호 체크 함수
'
Public Function Check_IDNO(sIDNO As String) As Boolean
  Dim Weight As String
  Dim Total As Byte
  Dim ChkDigit As Byte
  Dim ChkValue As Byte
  Dim dt As Byte
  Dim wt As Byte
  Dim i As Byte
 
  Check_IDNO = False
  If Len(sIDNO) <> 13 Then Exit Function
 
  ChkDigit = Val(Right(sIDNO, 1))
 
  Weight = "234567892345"  '체크값(가중치)
  Total = 0
  For i = 1 To 12
      dt = Val(Mid(sIDNO, i, 1))
      wt = Val(Mid(Weight, i, 1))
      Total = Total + (dt * wt)
  Next i
 
  ChkValue = 11 - (Total Mod 11)
 
  If ChkValue > 9 Then ChkValue = ChkValue Mod 10
  Check_IDNO = IIf(ChkValue = ChkDigit, True, False)
End Function




■ 헥사(HEX)코드변환

Here is the source code in C#
a) Convert String to Hex

         public static string ConvertStringToHex(String input, System.Text.Encoding encoding)
        {
             Byte[] stringBytes = encoding.GetBytes(input);
            StringBuilder sbBytes = new StringBuilder(stringBytes.Length * 2);
            foreach (byte b in stringBytes)
             {
                 sbBytes.AppendFormat("{0:X2}", b);
            }
            return sbBytes.ToString();
        }

        Public Shared Function ConvertStringToHex(input As [String], encoding As System.Text.Encoding) As String
	Dim stringBytes As [Byte]() = encoding.GetBytes(input)
	Dim sbBytes As New StringBuilder(stringBytes.Length * 2)
	For Each b As Byte In stringBytes
		sbBytes.AppendFormat("{0:X2}", b)
	Next
	Return sbBytes.ToString()
       End Function


b) Convert Hex to String
       *C#
         public static string ConvertHexToString(String hexInput, System.Text.Encoding encoding)
        {
             int numberChars = hexInput.Length;
            byte[] bytes = new byte[numberChars / 2];
             for (int i = 0; i < numberChars; i += 2)
            {
                bytes[i / 2] = Convert.ToByte(hexInput.Substring(i, 2), 16);
             }
             return encoding.GetString(bytes);
        }
       * VB
        Public Shared Function ConvertHexToString(hexInput As [String], encoding As System.Text.Encoding) As String
	Dim numberChars As Integer = hexInput.Length
	Dim bytes As Byte() = New Byte(numberChars \ 2 - 1) {}
	For i As Integer = 0 To numberChars - 1 Step 2
		bytes(i \ 2) = Convert.ToByte(hexInput.Substring(i, 2), 16)
	Next
	Return encoding.GetString(bytes)
       End Function

Sample usage code

   string testString = "MIKA@?&^";
   string hex = ConvertStringToHex(testString, System.Text.Encoding.Unicode);
   string normal = ConvertHexToString(hex, System.Text.Encoding.Unicode);
   Debug.Assert(testString.CompareTo(normal) == 0, "They are not identical");

For example, you use Encoding.Unicode for RC4 or Encoding.ASCII for simple text .

The sample code is in C# but can translated to VB.NET very easily, for example the sample usage code is:
   Dim testString As String = "MIKA@?&^"
   Dim hex As String = ConvertStringToHex(testString, System.Text.Encoding.Unicode)
   Dim normal As String = ConvertHexToString(hex, System.Text.Encoding.Unicode)
   Debug.Assert(testString.CompareTo(normal) == 0, "They are not identical")

For additional information check:
http://msdn.microsoft.com/en-us/library/bb311038.aspx
Convert String to Hex and Hex to String in .NET  (9208 Views)



■ 실행파일 실행 (http://sbrich.tistory.com/669 )
   System.Diagnostics.Process.Start("explorer.exe", "http://www.neyes.co.kr") - 
   System.Diagnostics.Process.Start("cmd.exe", "c:\\temp")

■ 날짜서식

http://msdn.microsoft.com/ko-kr/library/system.web.ui.webcontrols.boundfield.dataformatstring(v=vs.100).aspx

■ 화면캡쳐

Imports System.Configuration
Imports System.Data
Imports System.Linq
Imports System.Web
Imports System.Web.Security
Imports System.Web.UI
Imports System.Web.UI.HtmlControls
Imports System.Web.UI.WebControls
Imports System.Web.UI.WebControls.WebParts
Imports System.Xml.Linq
Imports System.Drawing.Imaging
Imports System.IO
Imports System.Drawing
Imports System.Windows.Forms


    Protected Sub Button1_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Button1.Click
        Dim bitmap As New Bitmap(Screen.PrimaryScreen.Bounds.Width, Screen.PrimaryScreen.Bounds.Height)
        Dim graphics__1 As Graphics = Graphics.FromImage(TryCast(bitmap, System.Drawing.Image))
        graphics__1.CopyFromScreen(25, 25, 25, 25, bitmap.Size)
        bitmap.Save("c:\test\screenshot1.bmp", ImageFormat.Bmp)
    End Sub

 '=== 아래참조해야 에러안남 =====================================================
Step 1: Go to "Solution Explorer"

Step 2: Right click on "Add reference"

Step 3: Search in the ".net" tab for the reference for "System.Windows.dll" Or "System.Windows.Forms.dll" (don't know which one is present there but I would prefer the later) and add it.

This should resolve your problem.
'==============================================================================


■ 파일전송크기 
   <httpRuntime maxRequestLength="40960"/>
   <!--최대전송파일크기 기본크기 4096KB -->

■ 엔터키로 버튼클릭 
TextBox1 박스에서 엔터키치면
page_load()페이지에 코딩  
TextBox1.Attributes("onkeypress") = "if (event.keyCode==13){" & Page.GetPostBackEventReference(Button2) & "; return false;}"

일부 컨트롤은 포커스를 받을 수 없습니다. 다음과 같은 컨트롤에 포커스를 설정할 수 있습니다.
Button, LinkButton 및 ImageButton 컨트롤
CheckBox 컨트롤
DropDownList 컨트롤
FileUpload 컨트롤
HyperLink 컨트롤
ListBox 컨트롤
RadioButton 컨트롤
TextBox 컨트롤


■  데이타 선택,삭제,수정,..방법 (소슼컨트롤 사용시 SEQ 는 그리드뷰에서 언비지블 되면 안됨)
    -비하인드코드 에서하는방법
      Protected Sub Button3_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Button3.Click
        ADS.DeleteCommand = "DELETE from SCHEDULE where (ID = '" + Session("USERID") + "') and (날짜 = #" + LblDATE.Text + "#)"
        ADS.Delete()
        ADS.SelectCommand = "SELECT * FROM SCHEDULE WHERE (ID = '" + Session("USERID") + "') and 처리 = '예정'  order by [날짜]"
        TxtBoxDetail.Text = ""
ADS_Custom.UpdateCommand = "UPDATE [customer] SET 이름 =  거래처명 = '" + TxtCustom0.Text + "', HP = '" + TxtCustom1.Text + "' , email = '" + TxtCustom2.Text + "' WHERE  (SEQ= " + GridView1.Rows(GridView1.SelectedIndex).Cells(6).Text + ") "
            ADS_Custom.Update()
    End Sub
  
 -소스컨트롤에서 하는방법
   반드시 프라이머리키 ID 설정후 소스컨트롤에 삭제 쿼리작성
 
   (*중요) 삭제후 반드시 작성 Protected Sub ADS_RowDeleted(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewDeletedEventArgs) Handles GrdPASS.RowDeleted
   

■ 쿠키생성삭제
- 쿠키 생성
HttpCookie cookie = new HttpCookie("userName"); // 쿠키 생성
DateTime now = DateTime.Now;
cookie.Value = loginControl.UserName; // 쿠키 값을 유저 아이디로 설정한다.
cookie.Expires = now.AddMinutes(15.0); // 쿠키 만료시간은 15분 후
Response.Cookies.Add(cookie);
this.Response.Write(cookie.Value);


- 쿠키 삭제
브라우저의 쿠키 만료 날짜를 과거로 설정한다.
if (Request.Cookies["UserSettings"] != null)
{
    HttpCookie myCookie = new HttpCookie("UserSettings");
    myCookie.Expires = DateTime.Now.AddDays(-1d);
    Response.Cookies.Add(myCookie);
}

출처: http://msdn2.microsoft.com/ko-kr/library/ms178195(VS.80).aspx


■  쿠키에저장(로그인시에0
    Response.Cookies("LOGUSER").Value = HttpUtility.UrlEncode(Session("USERID").ToString())
    Response.Cookies("LOGUSER").Expires = DateTime.Now.AddDays(7)

■  라이오리스트버튼 임의선택 (아래와같이 한개이상 해주어야함)
     RBtnScheduleView.Items(0).Selected = True
     RBtnScheduleView.Items(1).Selected = FALSE

■ 새로고침시 중복저장 방지
   저장다음에 Response.Redirect(Request.RawUrl)

■  오늘날짜 : DateTime.Today

■ 아이프레임 높이자동조절 (잘됨)
   https://m.blog.naver.com/PostView.nhn?blogId=sajacr&logNo=221021059931&proxyReferer=https%3A%2F%2Fwww.google.co.kr%2F
    
	 <style type="text/css">
        html,body {height:100%; margin-top: 0px;	margin-left: 0px; margin-right: 0px;}
     </style>
	 <iframe id="my_iframe" src="http://acaboard.iptime.org:8080/MFT/Default.aspx?GETKind=D&GETJUMUN=1인용민락점"  
        style="height: 100%; width: 100%; border: 0" >
     </iframe>  << 여기서 하이 100%

■ 아이프레임사용
<iframe frameborder="0" width="740px" height="720px" src="http://ddoksori.codns.com:8080/dlog_net/Image/%EB%94%94%EB%A1%9C%EA%B7%B8kr1.mp4" ></iframe>
-비하인드 코드에서 스크롤 없앰 FraMain.Attributes.Add("scrolling", "no")
- 높이 설정 iFrame1.Attributes.Add("height","100%");
- http://stackoverflow.com/questions/19195264/iframe-autoresizing-height-from-codebehind-in-c-sharp
■ iframe 비하인드코드에서사용
    <iframe src="~/DATA/PDF/H12a001.jpg"  height="100%" id="IFRA" runat ="server" ></iframe>
   runat ="server" 해주어야 비하인드 코드에서 사용가능
 IFRA.Attributes("src") = "http://www.디로그.kr/DATA/PDF/" + CellBOOK + ".jpg"

■ iframe javascript사용하여 url 불러오기
 <iframe src="Wizard.aspx" id="ifrmWizard"></iframe> 
$(document).ready(function () {
     $("#ifrmWizard") .attr("src","Wizard.aspx");
});

■ JQuery 사용하여 iframe 내부값 불러오기 http://aspdotnet.tistory.com/1090
   <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
   <script type='text/javascript'>
 function init() {
  var getval = $('#my_iframe').contents().find('#someID').html();
  alert(getval);
 }
</script>

iframe 내부 페이지
<div id="someID">Hello world!</div>



출처: http://aspdotnet.tistory.com/1090 [심재운 블로그]


■ 라디오(radio)버튼
   -추가
   LblPhone.Text = PhoneNo
            LblDeliveryTime.Text = VistTime
            Dim item As ListItem
            item = New ListItem("감사합니다. 포장주문하신 메뉴를 요청하신 시간에 포장해 놓겠습니다.", "sms1")
            RdoBtnLstMsg.Items.Add(item)
            item = New ListItem("죄송합니다. 포장주문하신 메뉴가 요청하신 시간 보다 약 분 늦을 예정입니다.", "sms2")
            RdoBtnLstMsg.Items.Add(item)
            item = New ListItem("죄송합니다. 포장주문하신 메뉴의 재료가 소진 되어 포장이 불가 합니다.", "sms3")
            RdoBtnLstMsg.Items.Add(item)


   -이름바꾸기
     RdoBtnLst.Items(1).Text = "업무일지1"
  
   -선택
     RdoBtnLst.Items(1).Selected = True
   -하나도 선택안됨
      If RadioButtonList1.SelectedIndex = -1 Then

   - 리스트 스페이스바로 자리옮기려면
      RepeatLayout 속성을 바꿔준다.
   - 선택
       If RBtnSndKnd.SelectedIndex = 0 Then
   - 테이블안에서 가운데 위치하게 하려면 
      소스내에서  <td align="center"> 해준다
	  <td align="left"> 하면왼쪽
   
   - 라디오 버튼과 나란히 글을 쓰려면.. 라디오버튼 RepeatLayout의 속성을 Flow 로 해준다.

   -  For i = 0 To RdoBtnLst.Items.Count - 1
                            If dr2("구분") = RdoBtnLst.Items(i).Value.ToString Then
                                RdoBtnLst.Items(i).Selected = True
                            End If
                        Next

■ 라디오버튼에 이미지 삽입
<asp:RadioButtonList ID="imagetest" runat="server">
         <asp:ListItem Text='<img src="Image1.jpg" alt="img1" />' Value="1" Selected="True" />
         <asp:ListItem Text='<img src="Image2.jpg" alt="img2" />' Value="2"></asp:ListItem>
</asp:RadioButtonList>

■ 페이지 요소 나열순서
    <html>
    <body>
    <form>
    <div>
    <table>
      
■ 파일 폴더 존재여부 더 간단
        Dim Mypath As String = Server.MapPath("." & "\IMAGE\" & Session("LTD"))
		If Directory.Exists(Mypath) = True Then
        Dim MyFile As String = Server.MapPath("." & "\IMAGE\" & Session("LTD") & "/slide_1.png")
        If File.Exists(MyFile) = True Then
		
		'폴더---
		Dim path As String = Server.MapPath("DELIVERY\" + getLTD + "\")
            If Directory.Exists(path) = False Then
                ' Create a file to write to.
                Directory.CreateDirectory(path)
            End If



■ 파일존재여부 
        Dim ExFile As String = "C:\inetpub\wwwroot\dlog\dlogavi\" & TextBox1.Text & ".mp4"
        Dim finfo As New FileInfo(ExFile)
        
            If finfo.Exists = True Then

■ 폴더존재여부 확인후 폴더 생성
 Dim path As String = "C:\inetpub\wwwroot\GONGBUBANG\IMAGE\" & (Session("LTD"))
        If Not Directory.Exists(path) Then
            Directory.CreateDirectory(path)
        End If



■ 특정폴더파일 가져오기
     Dim Di As System.IO.DirectoryInfo = New System.IO.DirectoryInfo(MapPath("~/study/") & SBJ) 'C:\inetpub\wwwroot\GICHULNOTE\study\공인중개사
       For Each d As System.IO.FileInfo In Di.GetFiles
            If Right(d.Name, 3) = "htm" Or Right(d.Name, 3) = "hwp" Then
                If Not IsPostBack Then
                    DDL.Items.Add(Replace(d.Name, Right(d.Name, 4), ""))
                End If
                HAKJANG = Right(d.Name, 4)
            End If
       Next

■ searchPattern은 와일드카드 심볼을 사용한다. 예를 들어 여러분이 C:\SomeDir 폴더의 텍스트 파일만 가져오고 싶다면 다음과 같이 하면 된다.
   string[] textFiles = Directory.GetFiles("C:\SomDir", "*.txt")

■ 파일카피
   Dim fInfo1 As New FileInfo(Me.MapPath("빈DATA\" + "DATA.mdb"))
   fInfo1.CopyTo(Me.MapPath("App_Data\" + TextBox1.Text + ".mdb"), False)
■ 파일수정
     '---- mdb 수정------
        Dim oldFile As String = Server.MapPath("App_Data\" + TextBox1.Text + ".mdb")
        Dim newFile As String = Server.MapPath("App_Data\" + TextBox2.Text + ".mdb")
        If System.IO.File.Exists(Server.MapPath("App_Data\" + TextBox1.Text + ".mdb")) Then
            System.IO.File.Move(oldFile, newFile)
        End If

■ 폴더생성
    Directory.CreateDirectory(Me.MapPath("PIC\" + TextBox1.Text))

■ 화면위치고정하여 다시읽기 제자리 위치
    MaintainScrollPositionOnPostback ="true" 를 <%@ Page...에 추가

■ 디버깅을 사용하지 않도록 구성  
    <compilation debug="false"





■ 자바스크립트호출
   //버튼클릭호출
    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
      BtnReg.Attributes("onClick") = "return Confirm_Reg();"
   end sub
   //버튼클릭함수
   Protected Sub BtnReg_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles BtnReg.Click
 
   End Sub
■ 비하인드코드에서 자바스크립트함수 호출하기
   소스코드에 "layer_open('layer2') 라는 자바스크립트 함수가 있는가정하에..
    소스코드에 있는 <%-- &nbsp;<a href="#" class="btn-example" onclick="layer_open('layer2');return true;"><asp:ImageButton ID="ImgBtn_Login" runat="server" ImageUrl="~/IMAGE/로그인.png" /></a>--%>  대신에 비하인드
코드에서 Me.Page.ClientScript.RegisterStartupScript(Me.[GetType](), "name", "layer_open('layer2');", True) 로 불러옴

■ 자바스크립트호출(중요 잘됨)
   폼로드에 코딩 ScriptManager.RegisterClientScriptBlock(Me.Page, Me.[GetType](), Nothing, "함수명()", True)
   
             

■ 파일다운로드함수
   private void File_Send(string filePath, string fileName)//전체파일경로, 다운로드 표시할 파일명)
   {
       //다운로드파일이름지정
      Response.AddHeader("Content-Disposition", "attachment; filename=" + fileName);
      //타입지정
      Response.ContenType = "mutilpart/form-data";
      //서버에 있는 파일 경로
      Response.WriteFile(filePath);
   }
   
■ 대소문자 지정

   String.ToUpper
문자열의 모든 문자를 대문자로 변환합니다.
String.ToLower
문자열의 모든 문자를 소문자로 변환합니다.

    dim EnterStr as string = textbox1.ToUpper() '대문자
    dim EnterStr as string = textbox1.ToLower() '소문자


■ 컨트롤 배열
    Dim Ans() As Label = New Label() {Label1, Label2, Label3, Label4, Label5, Label6, Label7, Label8, Label9, Label10, _
    Ans(Int(LblNo.Text) - 1).Text 
    



■ 메시지박스
    Response.Write("<script language = 'javascript'> alert('메시지') </script>")

   * 변수일때
      Response.Write("<script language = 'javascript'> alert('" + 메시지 + "') </script>")

     -C#
      <%
         '페이지에 출력
          Response.Write "ASP Sample"

         '변수에 입력
          strTemp = "Hello World"
         '메시지박스 출력
         response.write "<script language=""javascript"">alert('" + strTemp  + "');</script>" 
      %>



■ @의 갯수반환함
    UBound(Split(memNo, "@"))

 

■자동으로페이지이동
  <meta http-equiv="REFRESH" content="10; url=GoBack.aspx">

■ 일정시간후 자동으로 페이지 오픈
    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        Response.AppendHeader("refresh", "1;url=http://www.band.us/about")
    End Sub

■ 텍스트박스에서 엔터키를 누르면 버튼1 클릭되게
    Page_Load
      this.textbox1.attributes["onkeypress"] = "if(event.keycode == 13) {" + page.getpostbackeventreference(this.button1) + "; return false;}"; 
    End sub

■ASP.NET 웹 페이지간 값 전달
   ASP.NET에서 웹 페이지간에 값을 전달할 수 있는 방법은 5개 정도가 있다.

다른 웹 어플리케이션 또는 ASP.NET 웹페이지가 아닐때

- 쿼리 문자열(QueryString)
- HTTP POST 정보(HTTP POST Information)
동일한 ASP.NET 웹 어플리케이션에서만 가능

- 세션(Session State)
- 공용 속성값(Public Property Value)
- 컨트롤 정보(Control Information)


1) 쿼리 문자열(Using a Query String)
쿼리 문자열은 호출하는 웹 페이지의 URL에 키-값을 연결해서 전달하는 형태이다. 가장 쉬운 방법이지만 값이 URL에 보여지기 때문에 주의가 필요하다
1)소스 페이지에서 값 전달
URL의 끝에 ?와 &를 이용해 값을 전달
http://contoso.com/products.aspx?field1=value1&field2=value2

2)대상 페이지에서 값 받기
HttpRequest 객체의 QueryString property를 이용해 접근
string s = Request.QueryString["field1"];

2)POST 정보(Getting Post Information from the Source Page)
1)소스 페이지에서 값 전달
HTML 요소나 ASP.NET 서버 컨트롤을 포함하는 폼(form)요소에서 값을 전달

2)대상 페이지에서 값 받기
Form collection을 이용해서 값 읽기
void Page_Load(object sender, EventArgs e)
{
    System.Collections.Specialized.NameValueCollection postedValues = Request.Form;
    string nextKey;
    for(int i = 0; i < postedValues.AllKeys.Length; i++)
    {
        nextKey = postedValues.AllKeys[i];
        string value = postedValues[i];
        }
    }
}


3)세션(Using Session State)
1)소스 페이지에서 세션 상태에 키를 이용해 값을 저장
Session["field1"] = "value1";

2)대상 페이지에서 세션 상태로부터 값을 읽음
string field1 = (string)(Session["field1"]);

4)공용 속성 값(Getting Public Property Values from the Source Page)
1) 소스페이지에서 공용 속성을 작성
public string CurrentCity
{
    get
    {
        return textCity.Text;
    }
}


2)대상 페이지에서 소스페이지를 가르키는 @PreviousPageType 지시문 추가
<%@ PreviousPageType VirtualPath="~/SourcePage.aspx" %> 

3)대상 페이지에서 PreviousPage 객체의 property를 읽음
string currentCity = PreviousPage.CurrentCity;

5)컨트롤 정보(Getting Control Information from the Source Page in the Same Application)
대상 페이지에서 PreviousPage 속성을 이용해 참조를 가져와서 FindControl 메소드를 호출해 참조를 가져옴
if (Page.PreviousPage != null)
{
    TextBox SourceTextBox = (TextBox)Page.PreviousPage.FindControl("TextBox1");

    if (SourceTextBox != null)
    {
        Label1.Text = SourceTextBox.Text;
    }
}


[참조] How to: Pass Values Between ASP.NET Web Pages
           방법: ASP.NET 웹 페이지 간에 값 전달
           Ways to Pass Data Between Webforms!


출처: http://www.bboks.net/212 [bboks.net™ :: Life is SELF - Be the primary actor in your LIFE]


■ 값전달 받기
Get의 경우
http://www.hslee.net/xxxxx.aspx?test1=zzz&test2=kkk
이런식으로 뒤에 ?와 &로.. 들어온 Data값을 가져오는 방식이다..

ASP.net C#에서는 아래와 같이 가져올수 있다.
String test2 = Request.QueryString["test2"] //Get


Post의 경우
httpPost 를 사용하여.. url에 실어서 보내는것이 아닌 hidden값으로 처리해서 보내는 방식이다.
String test1 = Request.Form["test1"] //Post
  Label1.Text = Request.QueryString["txtData"];


Get/Post 구분없이
String test2 = Request["test2"] //Get  


출처: http://periar.tistory.com/entry/ASPnet-C-GetPost-값-가져오기 [Hslee]


■ ASP.NET 웹 페이지 간에 값전달 (★보낼때 공백 주의)
    *쿼리문자열 사용
    Response.Redirect(http://contoso.com/products.aspx?field1=value1)
    Response.Redirect(http://contoso.com/products.aspx?field1=value1&field2=value2) - 주위 : 두개이상값전달시 공백주의
    예)Response.Redirect("http://ddoksori.codns.com:8080/DANAL_GONGBUBANG/Web/Teledit/Ready.aspx?LTD=" + TxtLTD.Text + "&" + "USERID=" + TxtBoxID.Text)

	테스트로 입금받기 acaboard.iptime.org:8080/DANAL_GONGBUBANG/Web/Teledit/Ready.aspx


    Dim s As String
    s = Request.QueryString("field1")
    * 소스 페이지에서 POST 정보 가져오기
    * 세션상태사용
    * 소스페이지에서 공용 속성 값 가져오기
    * 같은 응용 프로그램의 소스 페이지에서 컨트롤 정보 가져오기
    s = Request.QueryString("field1")
    * 소스 페이지에서 POST 정보 가져오기
    * 세션상태사용
    * 소스페이지에서 공용 속성 값 가져오기
    * 같은 응용 프로그램의 소스 페이지에서 컨트롤 정보 가져오기


  - 숫자형 타입일경우
    
   Server.Transfer("Orders.aspx?Refly=  " + seq + " ")


    Dim Repy As String = Request.QueryString("Refly")
                If Repy <> "" Then
                    Dim cmdFile2 As OleDbCommand = New OleDbCommand("select * from ORDERS where SEQ= " + Repy + "", cn)
                    cn.Open()
                    dr = cmdFile2.ExecuteReader(CommandBehavior.CloseConnection)
                    dr.Read()
                    If dr.HasRows = True Then
                        TxtDetailODR.Text = dr("요청내용")
                    End If
                    dr.Close()
                    cn.Close()


■ ASP.NET 웹 페이지 간에 두개이상의값 전달
    DataNavigateUrlFields="회원번호,회원명" 
    DataNavigateUrlFormatString="MISSION_RPT.aspx?memNo={0}@{1}" 
    => 여기서 회원번호는 {0} , 회원명은 {1}
  
    [받는쪽]
    Dim memNo = Request.QueryString("memNo")
    Dim abc As String() = memNo.Split(New Char() {"@"c})
   ABC(0), ABC(1)...순으로 값이 들어간다.
 

■ 하이퍼링크추가시설정해야할값들
    DataNavigateUrlFields = 여기서지정한필드값이 아래의 seq값이 된다.
    DataNavigateUrlFormatString = Details.aspx?seq={0}
    DataTextFields = 실제필드명
    HeaderText = 표시될필드제목







■ [팁] ASP.NET GridView Currency 표현, 세자리마다 콤마 찍기(http://www.dotnetkorea.com/DotNetNote/BoardView?BoardName=Aspx&Num=338)
   DataFormatString="{0:#,###}" HtmlEncode="false"
   DataFormatString="{0:c}" HtmlEncode="false"


■  datset 을이용한 그리드 바인딩
            Dim SLTQRY As String = "select * from Customer  WHERE ID = '" + Session("USERID") + "'"
            Dim Adap As OleDbDataAdapter = New OleDbDataAdapter(SLTQRY, Cn1)
            Dim ds As DataSet = New DataSet()
            Adap.Fill(ds, "customer")
            GridView1.DataSource = ds 'ds.Tables("ORDERS")
            GridView1.DataBind()

■ DB바인딩 
Imports System.Data
Imports System.Data.OleDb    
Dim Cn As OleDbConnection = New OleDbConnection("Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & Server.MapPath("App_Data\member.mdb"))
Dim CMD As OleDbCommand = New OleDbCommand("select * from~,Cn)
Cn.Open()

Dim DR As OleDbDataReader = CMD.ExecuteReader(CommandBehavior.CloseConnection)
        Do While DR.Read
            memNo = DR("~")
        Loop
DR.Close()
Cn.Close()

■ 웹상에서 DB 상대경로로 연결하는 방법
    "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & Server.MapPath("App_Data\member.mdb"))
        
    (참고싸이트 ; http://www.ai-report.com/AIManual/html/AIManual03_05_02.html)
   [ASP / ASP.NET 사용환경] 
<OLE Connection>
1. Oracle
/MS Oracle/
$Conn = Server.CreateObject("ADODB.CONNECTION")
$Conn.Open("Provider=MSDAORA; Data Source=오라클TNS명; User ID=아이디; Password=패스워드")
/Oracle/
$Conn = Server.CreateObject("ADODB.CONNECTION")
$Conn.Open("Provider=OraOLEDB.Oracle; Data Source=오라클TNS명; User ID=아이디; Password=패스워드")

2. Mssql
$Conn = Server.CreateObject("ADODB.CONNECTION")
$Conn.Open("Provider=sqloledb; Data Source=DB서버IP및서버명,1433; Initial Catalog=DB명;User ID=아이디; Password=패스워드")

3. Access
/절대경로/
$Conn = Server.CreateObject("ADODB.Connection")
$Conn.Open("Provider=Microsoft.Jet.OLEDB.4.0;Data Source=d:\home\db.mdb")
/상대경로/
$Conn = Server.CreateObject("ADODB.Connection")
$Conn.Open("Provider=Microsoft.Jet.OLEDB.4.0;Data Source=") & Server.MapPath("../home/db.mdb")
/URL경로/
$Conn = Server.CreateObject("ADODB.Connection")
$Conn.Open("Provider=Microsoft.Jet.OLEDB.4.0;Data Source=http://서버IP주소/db.mdb")

4. Sybase
/Anywhere(ASA)/
$Conn = Server.CreateObject("ADODB.Connection")
$Conn.Open("Provider=ASAProv; Data source=ASA서버명")
/Enterprise(ASE)/
$Conn = Server.CreateObject("ADODB.Connection")
$Conn.Open("Provider=Sybase ASE OLE DB Provider; Data source=ASE서버명")
또는
$Conn = Server.CreateObject("ADODB.Connection")
$Conn.Open("Provider=Sybase.ASEOLEDBProvider; Srvr=ASE서버명,5000; Catalog=DB명; User Id=아이디; Password=패스워드")

 
사업자등록번호/주민번호 체크함수
' 사업자등록번호 체크 함수
'
Public Function Check_RegNo(sRegNo As String) As Boolean
  Dim ChkValue As Byte
  Dim iRegNo(1 To 10) As Byte
  Dim iWeight(1 To 9) As Byte
  Dim Total As Byte
  Dim i As Byte

  Check_RegNo = False
  If Len(sRegNo) <> 10 Then Exit Function
   
  '체크값(가중치)
  iWeight(1) = 1
  iWeight(2) = 3
  iWeight(3) = 7
  iWeight(4) = 1
  iWeight(5) = 3
  iWeight(6) = 7
  iWeight(7) = 1
  iWeight(8) = 3
  iWeight(9) = 5
 
  '사업자등록번호
  For i = 1 To 10
      iRegNo(i) = Val(Mid(sRegNo, i, 1))
  Next i

  Total = 0
  For i = 1 To 9
      Total = Total + (iWeight(i) * iRegNo(i))
  Next i
 
  Total = Total + ((iRegNo(9) * 5) / 10)
 
  ChkValue = Total Mod 10
 
  If ChkValue <> 0 Then ChkValue = 10 - ChkValue
 
  If ChkValue = iRegNo(10) Then
     Check_RegNo = True
  Else
     Check_RegNo = False
  End If
End Function
 
'===========================================================================================================

■ 다날(DANAL)테스트 acaboard.iptime.org:8080/DANAL_GONGBUBANG/Web/Teledit/Ready.aspx

■ 프로덕션 환경에 웹 사이트를 배포하기 전에 web config 파일에서 디버깅을 사용하지 않도록 구성해야 합니다.



**************** 디 자 인 *********************

■ 스타일바꾸기--------------
   1). 뒷배경전체바꾸기 
       /* DEFAULTS
        body   => 바디만적용
       {
        background: #cccc99;/*#b6b7bc;  백그라운드색깔
        background-image: url('../image/000.jpg'); 백그라운드이미지
		width:980px;
       
	   html {width: 88px;} => 헤더까지적용

	    .page {width: 980px;} 

★ ***************** 에러모음 ********************

■ 에러모음페이지 http://hansimee79.blog.me/50108711675

■ 쓰레드가중단되었습니다.
   try
      response.redirect("main.aspx", false); 

■  INSERT 가 안되면9asp.net error operation must use an updateable query) 
     폴더에 USERS 에 쓰기가능에 체크

■  드롭다운리스트 - 빈칸만들고 데이타와 바인딩 되지 않을때
     소스상에서 ... AppendDataBoundItems = False

■  session 값 잃을경우-----------------------
원인1:인터넷 옵션- 개인정보 - 고급 에서 자동으로쿠키처리안함에 체크가 안되어있어서
해결 :web.config에 <sessionState cookieless="true"/>  '세션을 쿠키로 저장하지 않음

세션에대한 정보 : http://blog.danggun.net/1111

세션이 시작되거나 끝날때는 Global.asax에서 알수 있습니다.
(참고 : [ASP.Net] ASP.Net의 Main은 어디 있을까? (Global.asax파일))

?세션값 가저오기 
void Session_Start(object sender, EventArgs e) 
{    
 // 새 세션이 시작할 때 실행되는 코드입니다. 
}   

void Session_End(object sender, EventArgs e) 
{    
 // 세션이 끝날 때 실행되는 코드입니다.      
// 참고: Session_End 이벤트는 Web.config 파일에서 sessionstate 모드가     
// InProc로 설정되어 있는 경우에만 발생합니다. 세션 모드가 StateServer 또는 SQLServer로      
// 설정되어 있는 경우에는 이 이벤트가 발생하지 않습니다. 
} 

■ 세션변수 해제하가
sessionState timeout="30"


■  PageIndexChanging 안될때
     load 에서 postback 으로 다시읽는것 막을것
■  업데이트안될때
     [] () 빼고 숫자도 "" 씌워줄것


■  익스플로러11 에서는 레이아웃이 깨진다..해결방법은 asp.net 4.5 설치 (http://www.orcsweb.com/blog/terri/installing-asp-net-4-5-on-windows-server-20082008-r2-and-iis-77-5/) 참고
     다운받아놨
***********************web.config**********************
■  시간이지나면 자동으로 로그아웃설정
     <configuration>
<system.web>
<sessionState
timeout="60" />
</system.web>
</configuration>

Note: If you have increase ASP.NET Session timeout then you have to increase application idle timeout from Application pool, if Session timeout is greater then Application pool idle timeout then Session will be expire because Application is recycled before session timeout. 
? 
아래 빨간색 글씨가 중요하다. 즉, 아무리 Web.config에서 Session timeout시간 설정을 
길게 해줘도 IIS의 Application Pool idle timeout 시간이 더 작게 설정되어 있으면 그  
시간의 영향으로 web.config의 설정은 아무런 소용이 없게 된다. 꼭 기억하시길...!!? 

[설정방법]: http://blog.naver.com/zumerfolg/220133054117 싸이트참고
iis(인터넷 정보 서버스) 관리자
쿠키설정
시간 제한(분)(O):
20 => 바꿔준다
■ 윈도우10 바탕화면 아이콘
    개인설정 >테마
■ 윈도우2008
    윈도우 원격데스크톱 클립보드 복사 안되는경우 (rdpclip.exe) - Annotation
6. 작업관리자 창에서 "rdpclip.exe"를 선택한 후 프로세스 끝내기를 눌러 해당 프로세스를 종료합니다.

7. 그 후 5번에서 파일 위치를 열어둔 폴더에서 rdpclip.exe를 실행합니다.

■ 윈도우2008 아이콘추가
   1. 휴지통 외에 자주쓰는 내컴퓨터, 네트워크 들을 보이게 하려면 서버관리자-기능-데스크톱 경험

을 추가해 주어야 한다. 추가가 완료되면 서버가 리부팅 된다. 



출처: https://kjhfull.tistory.com/entry/Wind2008R2BATANG [HONG'S BLOG]

출처: http://annotations.tistory.com/45 [Annotation]

■유투브
https://m.blog.naver.com/PostView.nhn?blogId=dyna1021&logNo=220764990754&proxyReferer=https%3A%2F%2Fwww.google.com%2F
  유투브 자동재생 소스 변경하기 : ?amp;autoplay=1
  종료후 다른화면 안나오게 : ?rel=0

  amp;vq=hd720    -> 해상도 720
amp;showinfo=0  -> 동영상 제목을 표시 안 함
amp;autoplay=1   -> 자동재생
amp;loop=1          -> 반복재생

*------ (네이버)블로그 iframe에서 보이게 하려면 ----------
<iframe width ="100%" height ="360px" src="https://m.blog.naver.com/ruyi777/220678398814"></iframe> 

<object data="주소" type="text/html" title="제목"> 
         <a href="https://m.blog.naver.com/ruyi777/220678398814">블로그 전체화면 보기</a> 
    </object> 



*------ 핸드폰에서 음성안나오는경우 ----------
와이파이꺼지면..



*-----------외부에서 에러내용 보려면
<system.web>
    <customErrors mode="Off"/> 추가


*session 값 잃을경우-----------------------
원인1:인터넷 옵션에서 자동으로쿠키처리안함에 체크가 안되어있어서
해결 : <sessionState cookieless="true"/>

*페이지간에 값전달 방법
http://msdn.microsoft.com/ko-kr/library/6c3yckfw(v=vs.100).aspx 참조


*------------ 에러(Error)내용 -------------*
Server Error in '/' Application.
--------------------------------------------------------------------------------

Configuration Error 
Description: An error occurred during the processing of a configuration file required to service this request. Please review the specific error details below and modify your configuration file appropriately. 

Parser Error Message: It is an error to use a section registered as allowDefinition='MachineToApplication' beyond application level.  This error can be caused by a virtual directory not being configured as an application in IIS.

Source Error: 


Line 30: 			</buildProviders>
Line 31: 		</compilation>
Line 32: 		<authentication mode="Forms">
Line 33: 			<forms loginUrl="~/Account/Login.aspx" timeout="2880"/>
Line 34: 		</authentication>
 
*----------(서버에서 해당폴더 응용프로그램으로 변환)------------*

* 쿼리 저장할때 문자열에서 'Double' 형식으로 변환할 수 없습니다. 
  Dim Usecnt As Integer = Convert.ToInt16(LblUseSms.Text) + 1
  cmd = New OleDbCommand("UPDATE sms SET Usecnt = '" + Usecnt.ToString() + "' where UseMonth = '" + DateTime.Now.ToString("yyyyMM") + "'", cn)

  디비의 필드는 숫자형식이다.
  변수는 숫자형식으로 한다 Usecnt 
  쿼리에 저장시에는 Usecnt = '" + Usecnt.ToString() + "'




*----------에러내용-------------*
자식 요청 'XXXXXX?aspx'에 대한 경로가 잘못되었습니다. 가상 경로여야 합니다.

server.transfer 로이동할때는 가상경로이어야하므로 response.redirect 로 바꿔준다.

*----------에러내용-------------*
*The 'Microsoft.Jet.OLEDB.4.0' provider is not registered on the local machine.
 - IIS(인터넷 정보 서비스)관리자 -> 해당 싸이트클릭 -> 고급설정(응용프로그램풀:asp.net4.0 -서택)
   응용프로그램풀 -> asp.net4.0 선택 -> 고급설정 -> 32비트응용프로그램사용(TRUE로설정)

*----------에러내용-------------*
오전 10:39 2016-01-10
DB에 update 할때 double 어쩌구 에러
db에는필드는 수자형주고 코딩에는 변수 string 한후
Dim smsCmd1 As OleDbCommand = New OleDbCommand("UPDATE SMS SET Usecnt ='" + useNo + "'", cn)
하면 업데이트됨

**----------에러내용-------------*
자바에서 Response.Write("<script language = 'javascript'> alert('" + (restSMS) + "') </script>") 할경우
restSMS 변수를 inteager로 주면 아래와같은 에러가 난다 string으로줘야한다.
"<script language = 'javascript'>" 문자열에서 'Double' 형식으로 변환할 수 없습니다.
 
**----------에러내용-------------*
'=' 연산자가 'DBNull' 형식 및 "" 문자열에 대해 정의되지 않았습니다.
디비값이 널일경우다.
  If dr("PIC") = "" Then
  를
  If IsDBNull(dr("PIC")) = True Then
  로 바꿔준다

  *------------ 에러(Error)내용 -------------*
smtp 서버에 보안 연결이 필요하거나 클라이언트가 인증되지 않았습니다 5.5.1.. 메세지 이유로 이메일 전송 에러
--------------------------------------------------------------------------------
http://blog.naver.com/PostView.nhn?blogId=lsh00124&logNo=220533056400

구글은 최신 보안 표준을 사용하지 않는 앱이나 기기에서 이뤄지는 로그인 시도를 차단할 수 있고 이러한 앱이나 기기는 해킹에 더 취약하기 때문에 계정 보안을 강화하는 점 때문에 에러가 났다.
Gamil을 로그인 한 후에 https://www.google.com/settings/security/lesssecureapps
설정페이지에서 보안 수준이 낮은 앱의 액세스를 "사용"으로 바꾼다

암호를 정확이 입력할것 암호가 틀려도 위같은 에러가 남

*-------------- 에러(Error)내용 --------------*
라디오버튼 클릭시 2번 로딩되는 문제

소스코드에서 onselectedindexchanged="RdoBtnLstAnswer_SelectedIndexChanged" 를 삭제

*-------------- 에러(Error)내용 --------------*
이미열린파일
이미사용중인디비 aready use db
해당디비가 들어있는 폴더의 users에 쓰기권한을 준다

*-------------- 에러(Error)내용 --------------*
윈도우 원격데스크톱 클립보드 복사 안되는경우 (rdpclip.exe)
rdpclip.exe 재실행
출처: http://annotations.tistory.com/45 [Annotation]

*-------------- 에러(Error)내용 --------------*
윈도우10 원격데스크톱 연결안될때
https://blog.naver.com/sagessely/221272610839
5/8일 릴리즈된 windows 10 보안 업데이트(kb4103727)를 받으시면 원격 연결 실행 시 위와 같은 오류가 발생하며 연결이 안됩니다. 
[출처] Windows10 원격 연결 인증 오류|작성자 sagessely

윈도우10 자동업데이트 안되게
윈도우시작 옆 검색에 서비스 > windows update > 사용안함

*----------- 모바일에서 사운드재생안될때 -------------
1.도메인이 상대경로일때는 안나온다
   acaboard.iptime.org....로 되야 사운드 실행됨

*-------------- 에러(Error)내용 --------------*
정의되지않음오류
Server Error in '/MFT' Application.
Unspecified error
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 

Exception Details: System.Data.OleDb.OleDbException: Unspecified error

Source Error: 


Line 165:        Dim cn As OleDbConnection = New OleDbConnection("Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" + Server.MapPath("../App_Data/office.mdb"))
Line 166:        Dim cmd As OleDbCommand = New OleDbCommand("select distinct ADD from RTQRY where (DSP <> 0)", cn)
Line 167:        cn.Open() ==> 여기서 오류
Line 168:        Dim dr As OleDbDataReader = cmd.ExecuteReader(CommandBehavior.CloseConnection)
Line 169:

Source File: C:\inetpub\wwwroot\MFT\GoodFood\Default.aspx.vb    Line: 167 

Stack Trace: 

==> 엑세스디비 복구해볼것
==> mdb; 에서 ; 제거해본다
==> 확실한 오류의 원인은 디비를 타이머로 열때이다 닫히지 않은 디비를 다시 반복해서 열때 나오는 오류임

■ 각종버전확인
   iis : 컴퓨터\HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\InetStp
   framework : 컴퓨터\HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\NET Framework Setup\NDP\v4\Full